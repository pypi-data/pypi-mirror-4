
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Events &mdash; circuits v2.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="circuits v2.0.0 documentation" href="../index.html" />
    <link rel="up" title="The circuits Framework" href="index.html" />
    <link rel="next" title="Handlers" href="handlers.html" />
    <link rel="prev" title="Components" href="components.html" />
 
<script type="text/javascript" src="../templatebuiltins.js"></script>
<script type="text/javascript">
(function($) {
    if (!django_template_builtins) {
       // templatebuiltins.js missing, do nothing.
       return;
    }
    $(document).ready(function() {
        // Hyperlink Django template tags and filters
        var base = "../ref/templates/builtins.html";
        if (base == "#") {
            // Special case for builtins.html itself
            base = "";
        }
        // Tags are keywords, class '.k'
        $("div.highlight\\-html\\+django span.k").each(function(i, elem) {
             var tagname = $(elem).text();
             if ($.inArray(tagname, django_template_builtins.ttags) != -1) {
                 var fragment = tagname.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + tagname + "</a>");
             }
        });
        // Filters are functions, class '.nf'
        $("div.highlight\\-html\\+django span.nf").each(function(i, elem) {
             var filtername = $(elem).text();
             if ($.inArray(filtername, django_template_builtins.tfilters) != -1) {
                 var fragment = filtername.replace(/_/, '-');
                 $(elem).html("<a href='" + base + "#" + fragment + "'>" + filtername + "</a>");
             }
        });
    });
})(jQuery);
</script>

  </head>
  <body>

    <div class="document">
  <div id="custom-doc" class="yui-t6">
    <div id="hd">
      <h1><a href="../index.html">circuits v2.0.0 documentation</a></h1>
      <div id="global-nav">
        <a title="Home page" href="../index.html">Home</a>  |
        <a title="Global index" href="../genindex.html">Index</a>  |
        <a title="Module index" href="../py-modindex.html">Modules</a>
      </div>
      <div class="nav">
    &laquo; <a href="components.html" title="Components">previous</a> 
     |
    <a href="index.html" title="The circuits Framework" accesskey="U">up</a>
   |
    <a href="handlers.html" title="Handlers">next</a> &raquo;</div>
    </div>
    
    <div id="bd">
      <div id="yui-main">
        <div class="yui-b">
          <div class="yui-g" id="man-events">
            
  <div class="section" id="events">
<h1>Events<a class="headerlink" href="#events" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-usage">
<h2>Basic usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<p>Events are objects that are fired by the circuits framework implicitly
(like the <a class="reference internal" href="../api/circuits_core_events.html#circuits.core.events.Started" title="circuits.core.events.Started"><tt class="xref py py-class docutils literal"><span class="pre">Started</span></tt></a> event used in the tutorial)
or explicitly by components while handling some other event. Once fired,
events are dispatched to the components that are interested in these events,
i.e. that have registered themselves as handlers for these events.</p>
<p>Events are usually fired on one or more channels, allowing components
to gather in &#8220;interest groups&#8221;. This is especially useful if you want to
reuse basic components such as a TCP server. A TCP server component
fires a <tt class="docutils literal"><span class="pre">Read</span></tt> event for every package of data that it receives. If we
hadn&#8217;t the channels, it would be very difficult to separate the data from
two different TCP connections. But using the channels, we can put one TCP
server and all components interested in its events on one channel, and
another TCP server and the components interested in this other TCP server&#8217;s
events on another channel. Components are associated with a channel by
setting their <tt class="docutils literal"><span class="pre">channel</span></tt> attribute (see API description for
<a class="reference internal" href="../api/circuits_core_components.html#circuits.core.components.Component" title="circuits.core.components.Component"><tt class="xref py py-class docutils literal"><span class="pre">Component</span></tt></a>).</p>
<p>Besides having a name, events carry additional arbitrary information.
This information is passed as arguments or keyword arguments to the
constructor. It is then delivered to the handler function that must have
exactly the same number of arguments and keyword arguments. Of course,
as is usual in Python, you can also pass additional information by setting
attributes of the event object, though this usage pattern is discouraged
for events.</p>
</div>
<div class="section" id="events-as-result-collectors">
<h2>Events as result collectors<a class="headerlink" href="#events-as-result-collectors" title="Permalink to this headline">¶</a></h2>
<p>Apart from delivering information to handlers, event objects may also collect
information. If a handler returns something that is not <tt class="xref docutils literal"><span class="pre">None</span></tt>, it is
stored in the event&#8217;s <tt class="docutils literal"><span class="pre">value</span></tt> attribute. If a second (or any subsequent)
handler invocation also returns a value, the values are stored as a list.
Note that the value attribute is of type <a class="reference internal" href="../api/circuits_core_values.html#circuits.core.values.Value" title="circuits.core.values.Value"><tt class="xref py py-class docutils literal"><span class="pre">Value</span></tt></a> and you
must access its property <tt class="docutils literal"><span class="pre">value</span></tt> to access the data stored
(<tt class="docutils literal"><span class="pre">collected_information</span> <span class="pre">=</span> <span class="pre">event.value.value</span></tt>).</p>
<p>The collected information can be accessed by handlers in order to find out
about any return values from the previously invoked handlers. More useful
though, is the possibility to access the information after all handlers
have been invoked. After all handlers have run successfully (i.e. no
handler has thrown an error) circuits may generate an event that indicates
the successful handling. This event has the name of the event
just handled with &#8220;Success&#8221; appended. So if the event is called <tt class="docutils literal"><span class="pre">Identify</span></tt>
then the success event is called <tt class="docutils literal"><span class="pre">IdentifySuccess</span></tt>. Success events aren&#8217;t
delivered by default. If you want successful handling to be indicated
for an event, you have to set the optional attribute <tt class="docutils literal"><span class="pre">success</span></tt> of this
event to <tt class="xref docutils literal"><span class="pre">True</span></tt>.</p>
<p>The handler for a success event must be defined with two arguments. When
invoked, the first argument is the event just having been handled
successfully and the second argument is (as a convenience) what has been
collected in <tt class="docutils literal"><span class="pre">event.value.value</span></tt> (note that the first argument may not
be called <tt class="docutils literal"><span class="pre">event</span></tt>, for an explanation of this restriction as well as
for an explanation why the method is called <tt class="docutils literal"><span class="pre">identify_success</span></tt>
see the section on handlers).</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span class="c">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">circuits</span> <span class="kn">import</span> <span class="n">Component</span><span class="p">,</span> <span class="n">Event</span>
<span class="kn">from</span> <span class="nn">circuits.core.debugger</span> <span class="kn">import</span> <span class="n">Debugger</span>

<span class="k">class</span> <span class="nc">Identify</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Identify Event&quot;&quot;&quot;</span>
    <span class="n">success</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">class</span> <span class="nc">Pound</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Pound</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>

        <span class="n">Debugger</span><span class="p">()</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">Bob</span><span class="p">()</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">Fred</span><span class="p">()</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">started</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fire</span><span class="p">(</span><span class="n">Identify</span><span class="p">())</span>
        
    <span class="k">def</span> <span class="nf">identify_success</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">[</span><span class="n">result</span><span class="p">]</span>
        <span class="k">print</span> <span class="s">&quot;In pound:&quot;</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">result</span><span class="p">:</span>
            <span class="k">print</span> <span class="n">name</span>

<span class="k">class</span> <span class="nc">Dog</span><span class="p">(</span><span class="n">Component</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">identify</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">__name__</span>

<span class="k">class</span> <span class="nc">Bob</span><span class="p">(</span><span class="n">Dog</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Bob&quot;&quot;&quot;</span>

<span class="k">class</span> <span class="nc">Fred</span><span class="p">(</span><span class="n">Dog</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fred&quot;&quot;&quot;</span>

<span class="n">Pound</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p><a class="reference download internal" href="../_downloads/handler_returns.py"><tt class="xref download docutils literal"><span class="pre">Download</span> <span class="pre">handler_returns.py</span></tt></a></p>
</div>
<div class="section" id="advanced-usage">
<h2>Advanced usage<a class="headerlink" href="#advanced-usage" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it may be necessary to take some action when all state changes
triggered by an event are in effect. In this case it is not sufficient
to wait for the completion of all handlers for this particular event.
Rather, we also have to wait until all events that have been fired by
those handlers have been processed (and again wait for the events fired by
those events&#8217; handlers, and so on). To support this scenario, circuits
can fire a <tt class="docutils literal"><span class="pre">Complete</span></tt> event. The usage is similar to the previously
described success event. Details can be found in the API description of
<a class="reference internal" href="../api/circuits_core_events.html#circuits.core.events.Event" title="circuits.core.events.Event"><tt class="xref py py-class docutils literal"><span class="pre">circuits.core.events.Event</span></tt></a>.</p>
</div>
</div>


          </div>         
        </div>
      </div>
      
        
          <div class="yui-b" id="sidebar">
            
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Events</a><ul>
<li><a class="reference internal" href="#basic-usage">Basic usage</a></li>
<li><a class="reference internal" href="#events-as-result-collectors">Events as result collectors</a></li>
<li><a class="reference internal" href="#advanced-usage">Advanced usage</a></li>
</ul>
</li>
</ul>

  <h3>Browse</h3>
  <ul>
    
      <li>Prev: <a href="components.html">Components</a></li>
    
    
      <li>Next: <a href="handlers.html">Handlers</a></li>
    
  </ul>
  <h3>You are here:</h3>
  <ul>
      <li>
        <a href="../index.html">circuits v2.0.0 documentation</a>
        
          <ul><li><a href="index.html">The circuits Framework</a>
        
        <ul><li>Events</li></ul>
        </li></ul>
      </li>
  </ul>  

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/man/events.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
          </div> 
        
      
    </div>
    
    <div id="ft">
      <div class="nav">
    &laquo; <a href="components.html" title="Components">previous</a> 
     |
    <a href="index.html" title="The circuits Framework" accesskey="U">up</a>
   |
    <a href="handlers.html" title="Handlers">next</a> &raquo;</div>
    </div>
  </div>

      <div class="clearer"></div>
    </div>
  </body>
</html>