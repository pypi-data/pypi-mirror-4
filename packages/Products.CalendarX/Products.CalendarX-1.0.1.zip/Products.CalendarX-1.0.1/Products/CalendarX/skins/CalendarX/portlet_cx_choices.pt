<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      i18n:domain="plone">

<body tal:define="Iterator python:modules['Products.CMFPlone'].IndexIterator;
                  tabindex python:Iterator()">

<!-- The CalendarX Choices portlet box -->

<div metal:define-macro="portlet"
     tal:omit-tag=""
     tal:define="MODIFIED string:mod 0.5.1 use CXsheetlist;
                 viewname string:${request/PUBLISHED/title_or_id};
                 CXsheetlist python:here.getCXSheetlist();
                 Dict python:here.getDictCommon(viewname, CXsheetlist);
                 std modules/Products.PythonScripts.standard;
                 mstring modules/string;
                 url_quote nocall: std/url_quote;
                 count nocall: mstring/count;
                 isAnon python:container.portal_membership.isAnonymousUser();">


    <div class="portlet"
         tal:condition="python: 1"
         id="portlet-cx-users">

        <h5 i18n:translate="cx_choices">Calendar Choices</h5>

        <div class="portletBody">

            <div class="portletContent odd">
                <form action="urlThis"
                      name="cx_users"
                      method="get"
                      tal:attributes="action string:${Dict/urlThis}">


                    <span tal:define="COMMENT string: Contents of this portlet;
                                      COMMENT string: 1. hidden tags for currentDate;
                                      COMMENT string: 2. macro for Add New Event link;
                                      COMMENT string: 3. macro for subject categories (very long div);
                                      COMMENT string: 3b. (includes hidden tag for xsub if subject categories are NOT shown);
                                      COMMENT string: 4. macro for Show Personal Events;
                                      COMMENT string: 4b. (includes hidden tag for xmy if Show Personal Events is NOT shown);
                                      COMMENT string: 5. macro for Users selection;
                                      COMMENT string: 5b. (includes hidden tag for xcrt if Users selection is NOT shown);
                                      COMMENT string: 6. input code for REFRESH button
                                      COMMENT string: 
                                      COMMENT string: Feel free to rearrange the order of the macros.
                                      " />

                    <input tal:attributes="type string:hidden; 
                                           name string:currentDate; 
                                           value python:url_quote(Dict['currentDate'].Date());"
                           tal:condition="nothing" /> 


<metal:block metal:use-macro="python:here.getCXMacro('portletFieldAddNewEvent')"/>


<metal:block metal:use-macro="python:here.getCXMacro('portletFieldCategoryPicker')"/>


<metal:block metal:use-macro="python:here.getCXMacro('portletFieldPersonalEvents')"/>


<metal:block metal:use-macro="python:here.getCXMacro('portletFieldUserPicker')"/>



                    <div class="formControls">
                        <input class="context"
                               type="submit"
                               value="Refresh"
                               alt="Refresh View"
                               tal:attributes="tabindex tabindex/next"
                               accesskey="accesskeys-login"
                               i18n:attributes="value alt"
                               />
                    </div>
                </form>
            </div>


        </div>

    </div>

</div>

</body>

</html>


