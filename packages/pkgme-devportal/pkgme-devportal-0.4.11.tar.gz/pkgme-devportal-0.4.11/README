
See LICENSE for copyright details.

Package dependencies
====================

 * bzr
 * python-dev
 * postgresql
 * postgresql-server-dev-9.1


== Building the environment ==

Install the above package and then run:
 "make"
to get the environment setup


== Testing ==

Run "make test" or "make acceptance".

To run specific tests you can specify the target via the parameter
TEST_TARGET, e.g.:
$ make test TEST_TARGET=test_database.TestDatabaseConfiguration


Configuration File
==================

Behaviour can be controlled by a config file at

  $HOME/.config/pkgme-binary/conf

Currently one section is supported for configuring database access.
This can either be sqlite or postgres.

You can override the location of this configuration file by setting the
environment variable ``PKGME_DEVPORTAL_CONFIG_FILE``.

Postgres
--------

The file should look something like::

  [database]
  db_type = postgres
  host = <db host>
  port = <db port>
  username = <db username>
  password = <db password>
  db_name = <db name>

You will need to create the tables yourself, you can use the
``db/postgres_schema.sql`` file for this::

  sudo -u postgres psql -f db/postgres_schema.sql


Contents File (apt-file)
------------------------
Running in this mode is useful for running locally. It will download the
archives "Contents-%(architecture)s" file on demand and build a local
version of that to map from soname to pkgname.

You can run pkgme locally using:
 $ cd /path/to/binary/thing/you/want/packaged
 $ echo '{ "package_name" : "mypkg", "description" : "some description" }' > devportal-metadata.json
 $ PYTHONPATH=/path/to/pkgme:/path/to/pkgme-devport \
   PKGME_BACKEND_PATHS=/path/to/pkgme-devportal/devportalbinary/backends/ \
   pkgme


Acceptance tests
================

There is an acceptance test suite that is not run as part of the
unit tests. You can run these tests with:

 $ make acceptance

