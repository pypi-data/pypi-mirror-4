#!python
"""Create a directory (ContainerNode) in the VOSpace repositotry"""


import vos
import time
import optparse, os, sys, logging

usage="""
	vmv vos:/root/node vos:/root/newNode   -- move node to newNode, if newNode is a container then moving node into newNode
"""


parser=optparse.OptionParser(usage)
parser.add_option("-v","--verbose",action="store_true")
parser.add_option("-d","--debug",action="store_true")
parser.add_option("--certfile",help="location of your CADC security certificate file",default=os.path.join(os.getenv("HOME","."),".ssl/cadcproxy.pem"))

(opt,args)=parser.parse_args()


if opt.verbose:
    logging.basicConfig(level=logging.INFO,format="vmv: %(message)s")
elif opt.debug:
    logging.basicConfig(level=logging.DEBUG,format="vmv: %(module)s.%(funcName)s %(message)s")
else:
    logging.basicConfig(level=logging.ERROR,format="vmv: %(message)s")



try:
    client=vos.Client(certFile=opt.certfile)
except Exception as e:
    logging.error("Conneciton failed:  %s" %  (str(e)))
    sys.exit(e.errno)

source=args[0]
dest = args[1]

try:
    client.move(source,dest)
except Exception as e:
    logging.error(str(e))
    #logging.error("Cannot move %s to %s: %s" % (source, dest, (str(e))))
    sys.exit(-1)
