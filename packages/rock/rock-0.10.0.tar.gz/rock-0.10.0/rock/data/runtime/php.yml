env:
  PATH: "${ROCK_PATH}/bin:${ROCK_PATH}/vendor/bin:${PATH}"
  ROCK_COMPOSER_INSTALL: "install"
  ROCK_COMPOSER_INSTALL_DEPLOYMENT: "--verbose --no-ansi --no-interaction install"

build: |

  if [[ -f ./composer.json ]]; then
    composer.phar ${ROCK_COMPOSER_INSTALL}
  else
    warn 'no "composer.json" file found'
  fi

build_deployment: |

  if [[ ! -f ./composer.lock ]]; then
    die 'no "composer.lock" file found'
  fi

  composer.phar ${ROCK_COMPOSER_INSTALL_DEPLOYMENT}

test: |

  php -c "${ROCK_PATH}" ./vendor/bin/phpunit

clean: |

  if [[ -d ./vendor ]]; then
    rm -fr ./vendor
  fi
