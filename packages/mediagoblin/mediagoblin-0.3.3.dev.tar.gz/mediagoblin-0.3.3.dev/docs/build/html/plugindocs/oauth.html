

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>OAuth plugin &mdash; GNU MediaGoblin 0.3.2.dev documentation</title>
    
    <link rel="stylesheet" href="../_static/mg.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.3.2.dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="GNU MediaGoblin 0.3.2.dev documentation" href="../index.html" />
    <link rel="next" title="Foreword" href="../pluginwriter/foreward.html" />
    <link rel="prev" title="sampleplugin" href="sampleplugin.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../pluginwriter/foreward.html" title="Foreword"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="sampleplugin.html" title="sampleplugin"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">GNU MediaGoblin 0.3.2.dev documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="oauth-plugin">
<h1>OAuth plugin<a class="headerlink" href="#oauth-plugin" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">In its current state. This plugin has received no security audit.
Development has been entirely focused on Making It Work(TM). Use this
plugin with caution.</p>
</div>
<p>The OAuth plugin enables third party web applications to authenticate as one or
more GNU MediaGoblin users in a safe way in order retrieve, create and update
content stored on the GNU MediaGoblin instance.</p>
<p>The OAuth plugin is based on the <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25">oauth v2.25 draft</a> and is pointing by using
the <tt class="docutils literal"><span class="pre">oauthlib.oauth2.draft25.WebApplicationClient</span></tt> from <a class="reference external" href="http://pypi.python.org/pypi/oauthlib">oauthlib</a> to a
mediagoblin instance and building the OAuth 2 provider logic around the client.</p>
<p>There are surely some aspects of the OAuth v2.25 draft that haven&#8217;t made it
into this plugin due to the technique used to develop it.</p>
<div class="section" id="set-up-the-oauth-plugin">
<h2>Set up the OAuth plugin<a class="headerlink" href="#set-up-the-oauth-plugin" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Add the following to your MediaGoblin .ini file in the <tt class="docutils literal"><span class="pre">[plugins]</span></tt> section:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">[[</span><span class="n">mediagoblin</span><span class="o">.</span><span class="n">plugins</span><span class="o">.</span><span class="n">oauth</span><span class="p">]]</span>
</pre></div>
</div>
</li>
<li><p class="first">Run:</p>
<div class="highlight-python"><pre>gmg dbupdate</pre>
</div>
<p>in order to create and apply migrations to any database tables that the
plugin requires.</p>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This only enables the OAuth plugin. To be able to let clients fetch data
from the MediaGoblin instance you should also enable the API plugin or some
other plugin that supports authenticating with OAuth credentials.</p>
</div>
</div>
<div class="section" id="authenticate-against-gnu-mediagoblin">
<h2>Authenticate against GNU MediaGoblin<a class="headerlink" href="#authenticate-against-gnu-mediagoblin" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As mentioned in <a class="reference internal" href="#capabilities">capabilities</a> GNU MediaGoblin currently only supports the
<a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-4.1">Authorization Code Grant</a> procedure for obtaining an OAuth access token.</p>
</div>
<div class="section" id="authorization-code-grant">
<h3>Authorization Code Grant<a class="headerlink" href="#authorization-code-grant" title="Permalink to this headline">¶</a></h3>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As mentioned in <a class="reference internal" href="#incapabilities">incapabilities</a> GNU MediaGoblin currently does not
support <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-2">client registration</a></p>
</div>
<p>The <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-4.1">authorization code grant</a> works in the following way:</p>
<p><cite>Definitions</cite></p>
<blockquote>
<div><dl class="docutils">
<dt>Authorization server</dt>
<dd>The GNU MediaGoblin instance</dd>
<dt>Resource server</dt>
<dd>Also the GNU MediaGoblin instance ;)</dd>
<dt>Client</dt>
<dd>The web application intended to use the data</dd>
<dt>Redirect uri</dt>
<dd>An URI pointing to a page controlled by the <em>client</em></dd>
<dt>Resource owner</dt>
<dd>The GNU MediaGoblin user who&#8217;s resources the client requests access to</dd>
<dt>User agent</dt>
<dd>Commonly the GNU MediaGoblin user&#8217;s web browser</dd>
<dt>Authorization code</dt>
<dd>An intermediate token that is exchanged for an <em>access token</em></dd>
<dt>Access token</dt>
<dd>A secret token that the <em>client</em> uses to authenticate itself agains the
<em>resource server</em> as a specific <em>resource owner</em>.</dd>
</dl>
</div></blockquote>
<div class="section" id="brief-description-of-the-procedure">
<h4>Brief description of the procedure<a class="headerlink" href="#brief-description-of-the-procedure" title="Permalink to this headline">¶</a></h4>
<ol class="arabic simple">
<li>The <em>client</em> requests an <em>authorization code</em> from the <em>authorization
server</em> by redirecting the <em>user agent</em> to the <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-3.1">Authorization Endpoint</a>.
Which parameters should be included in the redirect are covered later in
this document.</li>
<li>The <em>authorization server</em> authenticates the <em>resource owner</em> and redirects
the <em>user agent</em> back to the <em>redirect uri</em> (covered later in this
document).</li>
<li>The <em>client</em> receives the request from the <em>user agent</em>, attached is the
<em>authorization code</em>.</li>
<li>The <em>client</em> requests an <em>access token</em> from the <em>authorization server</em></li>
<li>?????</li>
<li>Profit!</li>
</ol>
</div>
<div class="section" id="detailed-description-of-the-procedure">
<h4>Detailed description of the procedure<a class="headerlink" href="#detailed-description-of-the-procedure" title="Permalink to this headline">¶</a></h4>
<p>TBD, in the meantime here is a proof-of-concept GNU MediaGoblin client:</p>
<p><a class="reference external" href="https://github.com/jwandborg/omgmg/">https://github.com/jwandborg/omgmg/</a></p>
<p>and here are some detailed descriptions from other OAuth 2
providers:</p>
<ul class="simple">
<li><a class="reference external" href="https://developers.google.com/accounts/docs/OAuth2WebServer">https://developers.google.com/accounts/docs/OAuth2WebServer</a></li>
<li><a class="reference external" href="https://developers.facebook.com/docs/authentication/server-side/">https://developers.facebook.com/docs/authentication/server-side/</a></li>
</ul>
<p>and if you&#8217;re unsure about anything, there&#8217;s the <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25">OAuth v2.25 draft</a>, the <a class="reference external" href="http://gitorious.org/mediagoblin/mediagoblin/trees/master/mediagoblin/plugins/oauth">OAuth plugin
source code</a>
and the <a class="reference external" href="http://mediagoblin.org/pages/join.html#irc">#mediagoblin IRC channel</a>.</p>
</div>
</div>
</div>
<div class="section" id="capabilities">
<h2>Capabilities<a class="headerlink" href="#capabilities" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-3.1">Authorization endpoint</a> - Located at <tt class="docutils literal"><span class="pre">/oauth/authorize</span></tt></li>
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-3.2">Token endpoint</a> - Located at <tt class="docutils literal"><span class="pre">/oauth/access_token</span></tt></li>
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-4.1">Authorization Code Grant</a></li>
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-2">Client Registration</a></li>
</ul>
</div>
<div class="section" id="incapabilities">
<h2>Incapabilities<a class="headerlink" href="#incapabilities" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Only <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-08">bearer tokens</a> are issued.</li>
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-4.2">Implicit Grant</a></li>
<li><a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-3.2">Force TLS for token endpoint</a> - This one is up the the siteadmin</li>
<li>Authorization <a class="reference external" href="http://tools.ietf.org/html/draft-ietf-oauth-v2-25#section-3.3">scope</a> and <cite>state</cite></li>
<li>...</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo_docs.png" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">OAuth plugin</a><ul>
<li><a class="reference internal" href="#set-up-the-oauth-plugin">Set up the OAuth plugin</a></li>
<li><a class="reference internal" href="#authenticate-against-gnu-mediagoblin">Authenticate against GNU MediaGoblin</a><ul>
<li><a class="reference internal" href="#authorization-code-grant">Authorization Code Grant</a><ul>
<li><a class="reference internal" href="#brief-description-of-the-procedure">Brief description of the procedure</a></li>
<li><a class="reference internal" href="#detailed-description-of-the-procedure">Detailed description of the procedure</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#capabilities">Capabilities</a></li>
<li><a class="reference internal" href="#incapabilities">Incapabilities</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="sampleplugin.html"
                        title="previous chapter">sampleplugin</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../pluginwriter/foreward.html"
                        title="next chapter">Foreword</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/plugindocs/oauth.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../pluginwriter/foreward.html" title="Foreword"
             >next</a> |</li>
        <li class="right" >
          <a href="sampleplugin.html" title="sampleplugin"
             >previous</a> |</li>
        <li><a href="../index.html">GNU MediaGoblin 0.3.2.dev documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
    <div>

MediaGoblin documentation released into the public domain via <a href="http://creativecommons.org/publicdomain/zero/1.0/">CC0</a>.

    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
    </div>
  </body>
</html>