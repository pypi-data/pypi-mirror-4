%% LaTeX Preamble - Common packages

\documentclass[11pt]{article}

\usepackage[latin1]{inputenc} % Any characters can be typed directly from the keyboard, eg Ã©Ã§Ã±
\usepackage{textcomp} % provide lots of new symbols
\usepackage{graphicx}  % Add graphics capabilities
%\usepackage{epstopdf} % to include .eps graphics files with pdfLaTeX
\usepackage{flafter}  % Don't place floats before their definition
%\usepackage{topcapt}   % Define \topcation for placing captions above tables (not in gwTeX)
\usepackage{natbib} % use author/date bibliographic citations

\usepackage{amsmath,amssymb}  % Better maths support & more symbols
\usepackage{bm}  % Define \bm{} to use bold math fonts
\usepackage{mathrsfs}

\usepackage[pdftex,bookmarks,colorlinks,breaklinks]{hyperref}  % PDF hyperlinks, with coloured links
%\definecolor{dullmagenta}{rgb}{0.4,0,0.4}   % #660066
%\definecolor{darkblue}{rgb}{0,0,0.4}
%\hypersetup{linkcolor=red,citecolor=blue,filecolor=dullmagenta,urlcolor=darkblue} % coloured links
%\hypersetup{linkcolor=black,citecolor=black,filecolor=black,urlcolor=black} % black links, for printed output

\usepackage{memhfixc}  % remove conflict between the memoir class & hyperref
% \usepackage[activate]{pdfcprot}  % Turn on margin kerning (not in gwTeX)
\usepackage{pdfsync}  % enable tex source and pdf output syncronicity

\usepackage{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{a4paper}                   % ... or a4paper or a5paper or ... 
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}

\title{Alignement global d'une séquence d'acide nucléique guidé par une proteine}
\author{Eric Coissac}
%\date{}                                           % Activate to display a given date or no date

\begin{document}
\maketitle

\section{Cas d'un alignement avec une fonction de gap affine}

\subsection{Notation}

On veut aligner une séquence nucléique N sur une séquence protéique P de manière
à identifier les points de décalage du cadre de lecture (FrameShift F).

Soit $l_{P} = |P|$ et $l_{N}=|N|$.

Soit C une séquence nucléique inconnu correspondant à la traduction reverse de P, donc $l_{C} = 3 \; l_{P}$.
 
Les symboles de toutes ces séquences sont numéroté à partir de 1.

On définie $\psi$ comme l'indice d'un nucléotide de la séquence P à l'intérieur de son codon.
$\psi \in \{0,1,2\}$ et $\psi_{i} = (i-1) \bmod 3$.

On note $\mathscr{C}(i,\psi)$ ou $\mathscr{C}_{i,\psi}$ le codon contenant le nucléotide $N_{i}$ en sa position $\psi$.
Le début du codon doit être potentiellement reconstruit par backracking dans la matrice déjà calculée. La fin du codon 
est constitué des positions suivant éventuellement la position $N_{i}$.


\subsection{Liste des operations}

On fait la différence entre un Gap qui correspond à une brèche de longueur multiple de 3 et un Frameshift qui correspond
à une brèche de longueur non multiple de 3.


\begin{itemize}
\item \textbf{Pairing}    ($M_{0}$)
\item \textbf{OpenGap}    ($O_{G}$)
\item \textbf{ExtendGap}    ($E_{G}$)
\item \textbf{OpenFrameshift}    ($O_{F}$)
\item \textbf{ExtendFrameshift}    ($E_{F}$)
\end{itemize}

\subsection{Fonction de reconstruction du codon}

\subsection{Fonction de match d'un codon et d'un acide aminé}

\begin{figure}[htbp]
\begin{center}
\includegraphics[scale=0.6]{matrix.pdf}
\caption{default}
\label{default}
\end{center}
\end{figure}



\begin{equation}
S_{i,j \;| \; \psi_j=0} = \max \left\{ 
	\begin{aligned}
	& \text{\textit{Match in phase}} \\
	S_{i-1,j-1} & + \mathcal{S}(\mathscr{C}(N_i,N_{i+1},N_{i+2}),\mathscr{C}(P_j,P_{j+1},P_{j+2})/3  \\
	\\
    & \text{\textit{Frame shift by insertion}} \\
	S_{i-2,j-1} & + \mathcal{S}(\mathscr{C}(N_i,N_{i+1},N_{i+2}),\mathscr{C}(P_j,P_{j+1},P_{j+2})/3  + F_{+1}  \\
	S_{i-3,j-1} & + \mathcal{S}(\mathscr{C}(N_i,N_{i+1},N_{i+2}),\mathscr{C}(P_j,P_{j+1},P_{j+2})/3  + F_{+2}  \\
	\\
    & \text{\textit{Frame shift by deletion}} \\
	\\
	\end{aligned}
\right .
\end{equation}


\end{document}  