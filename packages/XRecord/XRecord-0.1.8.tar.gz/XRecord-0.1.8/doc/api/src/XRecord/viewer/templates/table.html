<%inherit file="layout.html"/>

<h1>Columns in table `<b>${data.name}</b>` (<i>${data.info.TABLE_TYPE}</i>)</h1>
<ol>
<%
columns =  [ c for c in data.columns() ] 
columns.sort( lambda x,y : x.ORDINAL_POSITION.__cmp__(y.ORDINAL_POSITION))
%>
   % for c in columns:
   <li><b>${c.COLUMN_NAME}</b> : <i>${c.COLUMN_TYPE}</i> </li>
   % endfor
</ol>

<h1>Primary key</h1>

% if len(data.pk) > 0:
  This table's primary key is <b>${",".join(data.pk)}</b>
  % if data.auto_index:
  (<i>autoindex</i>)
  % endif
  .
% else:
  No primary key.
% endif

<h1>Foreign keys</h1>

% if len(data.fk) > 0:
   <ul>
    % for k,v in data.fk.items(): 
      <li> Column <b>${v.COLUMN_NAME}</b> references column <b>${v.REFERENCED_COLUMN_NAME}</b> in table <b><a href="${url_for('table', tablename=v.REFERENCED_TABLE_NAME)}">${v.REFERENCED_TABLE_NAME}</a></b> </li>
    % endfor
   </ul>
% else:
   No foreign keys.
% endif

<h1>Referencing tables</h1>
% if len(data.children) > 0:
   <ul>
    % for k,v in data.children.items(): 
      <li> Table <b><a href="${url_for('table', tablename=v.TABLE_NAME)}">${v.TABLE_NAME}</a></b> (<i>${v.COLUMN_NAME}</i>) references <b>${v.REFERENCED_TABLE_NAME}</b> (<i>${v.REFERENCED_COLUMN_NAME}</i>)</li>
    % endfor
   </ul>
% else:
   No referencing tables.
% endif

<h1>Many-to-many relationships</h1>
% if len(data.mtm) > 0:
   <ul>
    % for k,v in data.mtm.items(): 
      <li> Many-to-many relationship with <b><a href="${url_for('table', tablename=v['to'])}">${v['to']}</a></b>  via table 
      <b><a href="${url_for('table', tablename=v['via'])}">${v['via']}</a></b> (<i>${v['via'] + "." + v['via_to_column']}</i> -&gt; <i>${v['to'] + "." + v['to_column']}</i>), 
      (<i>${v['via'] + "." + v['via_my_column']}</i> -&gt; <i>${data.name + "." + v['my_column']}</i>) </li>
    % endfor
   </ul>
% else:
   No many-to-many relationships.
% endif
<br/><br/>
<h2>&raquo;<a href="${url_for('data', tablename=data.name)}">Look at some data from `${data.name}`</a></h2>
