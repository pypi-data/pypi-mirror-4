(function(e){e.fn.ajaxlinks=function(t){var n={load_to:"#content",load_from:null,loader:"<span>Loading...</span>",callback:null,use_sammy:false,prefix:"",smooth_height:true,goto_top:false,fix_forms:true,add_scripts:false,ajaxify_content:false,base_url:"/"};var r=e.extend(n,t);r.links=this;var i="";var s=function(t){if(r.goto_top){window.scrollTo(0,0)}var n={};if(typeof e.sammy=="function"&&r.use_sammy==true){var s=t.split("|");for(var u=0,a=s.length;u<a;u++){var f=s[u].split("=");if(f.length>2){var l=f[1];for(u=2;u<f.length;u++){var l=[l,"=",f[u]].join("")}n[f[0]]=l}else{n[f[0]]=f[1]}}}else{n.path=t}var c=function(e){var t=new Array;while(e.indexOf("<script")>-1||e.indexOf("</script")>-1){var n=e.indexOf("<script");var r=e.indexOf(">",n);var i=e.indexOf("</script",n);var s=e.indexOf(">",i);t.push(e.substring(r+1,i));e=e.substring(0,n)+e.substring(s+1)}return t};var h=function(i,s,u){e(r.load_to).addClass("ajax-loaded");if(r.smooth_height){d.height("auto")}var a=e(this).html();if(r.load_from&&i){if(e(this).find(r.load_from).length>0){a=e(this).find(r.load_from).html();d.html(a)}else{a=i;d.html(a)}}if(r.fix_forms){e('[action="."]').attr("action",t.replace("path=",""))}if(r.add_scripts){var l=new Array,h=i,p=function(e){setTimeout([e,"();"].join(""),100)},v=function(e,t){if(e===t){return true}if(e.length!=t.length){return false}for(key in e){if(e[key]!==t[key]){return false}}return true},m=function(e){f=new Array;for(C=0;C<e.length;C++){if(!g(f,e[C])){f.length+=1;f[f.length-1]=e[C]}}return f},g=function(e,t){for(j=0;j<e.length;j++){if(v(e[j],t)){return true}}return false};while(h.indexOf("<script ")>-1&&h.indexOf("></script>")>-1){var y=h.indexOf("<script ");var b=h.indexOf("</script>",y);if(h.substring(y,b).indexOf("src=")>-1){var w=h.indexOf("src=",y)+5;var E=h.substring(w-1,w);var S=h.indexOf(E,w);var x=h.substring(w,S);if(h.substring(y,b).indexOf("data-callback=")>-1){var T=h.indexOf("data-callback=",y)+15;var E=h.substring(T-1,T);var N=h.indexOf(E,T);var x=[x,h.substring(T,N)]}l.push(x)}h=h.substring(0,y)+h.substring(b+9)}m(l);for(var C=0,k=l.length;C<k;C++){if(typeof l[C]!="string"){var L=l[C][0];var A=l[C][1]}else{var L=l[C];var A=false}if(e(['head script[src*="',L,'"]'].join("")).length==0){e.ajax({url:L,dataType:"script",cache:true,async:false})}else if(A){p(A)}}}if(r.ajaxify_content){o(e(r.load_to).find("a").filter(":not('.no-al a, a.no-al')"))}if(r.callback){var O=r.links.filter('[href*="'+t+'"]');var l=c(i);r.callback(a,O,n,l)}};i=n.path;var p=r.load_from?[n.path,r.load_from].join(" "):n.path,d=e(r.load_to);if(r.smooth_height){d.height(d.height())}d.html(e(r.loader)).load(p,h)};var o=function(t){var n=function(e){return!(e.indexOf(location.href.replace("http://","").replace("https://","").split("/")[0])>-1)};if(r.use_sammy){t.each(function(t,i){var s=e(i).attr("href");if(s!=undefined&&s.indexOf("#!")==-1&&!n(e(i)[0].href)){e(i).attr("href",[r.base_url,r.prefix,"#!path=",s].join(""))}})}else{t.each(function(t,r){if(!n(e(r)[0].href)){e(r).data("al","true");e(r).bind("click",function(){s(e(this).attr("href"));return false})}})}};if(typeof e.sammy=="function"&&r.use_sammy==true){if(e.sammy.apps==undefined){var u=e.sammy(function(){this.get(/\#!(.*)/,function(e){s(window.location.href.split("#!")[1])})});e(function(){u.run()})}o(this)}else{o(this)}}})(jQuery)