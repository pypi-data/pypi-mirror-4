'\" t
.\"     Title: barman
.\"    Author: [see the "AUTHORS" section]
.\" Generator: DocBook XSL Stylesheets v1.76.1 <http://docbook.sf.net/>
.\"      Date: 08/31/2012
.\"    Manual: \ \&
.\"    Source: \ \&
.\"  Language: English
.\"
.TH "BARMAN" "5" "08/31/2012" "\ \&" "\ \&"
.\" -----------------------------------------------------------------
.\" * Define some portability stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
barman \- backup and recovery manager for PostgreSQL
.SH "CONFIGURATION FILE LOCATIONS"
.sp
The system\-level Barman configuration file is located at
.sp
.if n \{\
.RS 4
.\}
.nf
/etc/barman\&.conf
.fi
.if n \{\
.RE
.\}
.sp
and is overridden on a per\-user level by
.sp
.if n \{\
.RS 4
.\}
.nf
$HOME/\&.barman\&.conf
.fi
.if n \{\
.RE
.\}
.SH "CONFIGURATION FILE SYNTAX"
.sp
The Barman configuration file is a plain ini file\&. There is a general section called [barman] and a section [servername] for each server you want to backup\&. Rows starting with ; are comments\&.
.SH "PARAMETERS"
.PP
\fBactive\fR
.RS 4
Ignored\&.
.RE
.PP
\fBdescription\fR
.RS 4
A human readable description of a server\&.
.RE
.PP
\fBssh_command\fR
.RS 4
Command used by Barman to login to the Postgres server via ssh\&.
.RE
.PP
\fBconninfo\fR
.RS 4
Connection string used by Barman to connect to the Postgres server\&.
.RE
.PP
\fBbasebackups_directory\fR
.RS 4
Directory where base backups will be placed\&.
.RE
.PP
\fBwals_directory\fR
.RS 4
Directory which contains WAL files\&.
.RE
.PP
\fBincoming_wals_directory\fR
.RS 4
Directory where incoming WAL files are archived into\&.
.RE
.PP
\fBlock_file\fR
.RS 4
Lock file for a backup in progress\&.
.RE
.PP
\fBcompression_filter\fR
.RS 4
Compression algorithm applied to WAL files\&.
.RE
.PP
\fBdecompression_filter\fR
.RS 4
Decompression algorithm applied to compressed WAL files; this must match the compression algorithm\&.
.RE
.PP
\fBpre_backup_script\fR
.RS 4
Hook script launched before a base backup\&.
.RE
.PP
\fBpost_backup_script\fR
.RS 4
Hook script launched after a base backup\&.
.RE
.PP
\fBretention_policy\fR
.RS 4
Policy for retention of old backups\&. This is not implemented yet\&.
.RE
.PP
\fBwal_retention_policy\fR
.RS 4
Policy for retention of old WAL files\&. This is not implemented yet\&.
.RE
.SH "HOOK SCRIPTS"
.sp
The script definition is passed to a shell and can return any exit code\&.
.sp
The shell environment will contain the following variables:
.PP
BARMAN_BACKUP_DIR
.RS 4
backup destination directory
.RE
.PP
BARMAN_BACKUP_ID
.RS 4
ID of the backup
.RE
.PP
BARMAN_CONFIGURATION
.RS 4
configuration file used by barman
.RE
.PP
BARMAN_ERROR
.RS 4
error message, if any (only for the
\fIpost\fR
phase)
.RE
.PP
BARMAN_PHASE
.RS 4

\fIpre\fR
or
\fIpost\fR
.RE
.PP
BARMAN_PREVIOUS_ID
.RS 4
ID of the previous backup (if present)
.RE
.PP
BARMAN_SERVER
.RS 4
name of the server
.RE
.PP
BARMAN_STATUS
.RS 4
status of the backup
.RE
.sp
No check is performed on the exit code of the script\&. The result will be simply written in the log file\&.
.SH "EXAMPLE"
.sp
Example of the configuration file:
.sp
.if n \{\
.RS 4
.\}
.nf
[barman]
; Main directory
barman_home = /srv/barman

; Log location
log_file = %(barman_home)s/log/barman\&.log

; Default compression level: none, bzip2, gz
compression = gzip

; Pre/post backup hook scripts
pre_backup_script = env | grep ^BARMAN
post_backup_script = env | grep ^BARMAN

; \*(Aqmain\*(Aq PostgreSQL Server configuration
[main]
; Human readable description
description =  "Main PostgreSQL Database"

; SSH options
ssh_command = ssh postgres@pg

; PostgreSQL connection string
conninfo = host=pg user=postgres
.fi
.if n \{\
.RE
.\}
.SH "AUTHORS"
.sp
In alphabetical order:
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Carlo Ascani <carlo\&.ascani@2ndquadrant\&.it>
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Gabriele Bartolini <gabriele\&.bartolini@2ndquadrant\&.it>
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
Marco Nenciarini <marco\&.nenciarini@2ndquadrant\&.it>
.RE
.SH "RESOURCES"
.sp
Homepage: http://www\&.pgbarman\&.org
.SH "COPYING"
.sp
Barman is the exclusive property of 2ndQuadrant Italia and its code is distributed under GNU General Public License v3\&.
.sp
Copyright \(co 2011\-2012, 2ndQuadrant Italia (Devise\&.IT S\&.r\&.l\&.) \- http://www\&.2ndQuadrant\&.it/\&.
