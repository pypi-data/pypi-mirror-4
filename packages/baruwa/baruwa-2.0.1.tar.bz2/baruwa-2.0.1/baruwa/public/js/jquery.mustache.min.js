(function(b){var a=function(){var c={};var d=function(){};d.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true},context:{},render:function(h,g,f,i){if(!i){this.context=g;this.buffer=[]}if(!this.includes("",h)){if(i){return h}else{this.send(h);return}}h=this.render_pragmas(h);var e=this.render_section(h,g,f);if(e===false){e=this.render_tags(h,g,f,i)}if(i){return e}else{this.sendLines(e)}},send:function(e){if(e!==""){this.buffer.push(e)}},sendLines:function(g){if(g){var e=g.split("\n");for(var f=0;f<e.length;f++){this.send(e[f])}}},render_pragmas:function(e){if(!this.includes("%",e)){return e}var g=this;var f=this.getCachedRegex("render_pragmas",function(i,h){return new RegExp(i+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+h,"g")});return e.replace(f,function(j,h,i){if(!g.pragmas_implemented[h]){throw ({message:"This implementation of mustache doesn't understand the '"+h+"' pragma"})}g.pragmas[h]={};if(i){var k=i.split("=");g.pragmas[h][k[0]]=k[1]}return""})},render_partial:function(e,g,f){e=this.trim(e);if(!f||f[e]===undefined){throw ({message:"unknown_partial '"+e+"'"})}if(typeof(g[e])!="object"){return this.render(f[e],g,f,true)}return this.render(f[e],g[e],f,true)},render_section:function(g,f,e){if(!this.includes("#",g)&&!this.includes("^",g)){return false}var i=this;var h=this.getCachedRegex("render_section",function(k,j){return new RegExp("^([\\s\\S]*?)"+k+"(\\^|\\#)\\s*(.+)\\s*"+j+"\n*([\\s\\S]*?)"+k+"\\/\\s*\\3\\s*"+j+"\\s*([\\s\\S]*)$","g")});return g.replace(h,function(m,q,p,l,n,k){var s=q?i.render_tags(q,f,e,true):"",o=k?i.render(k,f,e,true):"",j,r=i.find(l,f);if(p==="^"){if(!r||i.is_array(r)&&r.length===0){j=i.render(n,f,e,true)}else{j=""}}else{if(p==="#"){if(i.is_array(r)){j=i.map(r,function(t){return i.render(n,i.create_context(t),e,true)}).join("")}else{if(i.is_object(r)){j=i.render(n,i.create_context(r),e,true)}else{if(typeof r==="function"){j=r.call(f,n,function(t){return i.render(t,f,e,true)})}else{if(r){j=i.render(n,f,e,true)}else{j=""}}}}}}return s+j+o})},render_tags:function(n,e,g,j){var h=this;var m=function(){return h.getCachedRegex("render_tags",function(p,i){return new RegExp(p+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+i+"+","g")})};var k=m();var l=function(q,i,p){switch(i){case"!":return"";case"=":h.set_delimiters(p);k=m();return"";case">":return h.render_partial(p,e,g);case"{":return h.find(p,e);default:return h.escape(h.find(p,e))}};var o=n.split("\n");for(var f=0;f<o.length;f++){o[f]=o[f].replace(k,l,this);if(!j){this.send(o[f])}}if(j){return o.join("\n")}},set_delimiters:function(f){var e=f.split(" ");this.otag=this.escape_regex(e[0]);this.ctag=this.escape_regex(e[1])},escape_regex:function(f){if(!arguments.callee.sRE){var e=["/",".","*","+","?","|","(",")","[","]","{","}","\\"];arguments.callee.sRE=new RegExp("(\\"+e.join("|\\")+")","g")}return f.replace(arguments.callee.sRE,"\\$1")},find:function(g,h){g=this.trim(g);function f(j){return j===false||j===0||j}var i;if(g.match(/([a-z_]+)\./ig)){var e=this.walk_context(g,h);if(f(e)){i=e}}else{if(f(h[g])){i=h[g]}else{if(f(this.context[g])){i=this.context[g]}}}if(typeof i==="function"){return i.apply(h)}if(i!==undefined){return i}return""},walk_context:function(e,f){var i=e.split(".");var h=(f[i[0]]!=undefined)?f:this.context;var g=h[i.shift()];while(g!=undefined&&i.length>0){h=g;g=g[i.shift()]}if(typeof g==="function"){return g.apply(h)}return g},includes:function(f,e){return e.indexOf(this.otag+f)!=-1},escape:function(e){e=String(e===null?"":e);return e.replace(/&(?!\w+;)|["'<>\\]/g,function(f){switch(f){case"&":return"&amp;";case'"':return"&quot;";case"'":return"&#39;";case"<":return"&lt;";case">":return"&gt;";default:return f}})},create_context:function(f){if(this.is_object(f)){return f}else{var g=".";if(this.pragmas["IMPLICIT-ITERATOR"]){g=this.pragmas["IMPLICIT-ITERATOR"].iterator}var e={};e[g]=f;return e}},is_object:function(e){return e&&typeof e=="object"},is_array:function(e){return Object.prototype.toString.call(e)==="[object Array]"},trim:function(e){return e.replace(/^\s*|\s*$/g,"")},map:function(j,g){if(typeof j.map=="function"){return j.map(g)}else{var h=[];var e=j.length;for(var f=0;f<e;f++){h.push(g(j[f]))}return h}},getCachedRegex:function(f,i){var h=c[this.otag];if(!h){h=c[this.otag]={}}var e=h[this.ctag];if(!e){e=h[this.ctag]={}}var g=e[f];if(!g){g=e[f]=i(this.otag,this.ctag)}return g}};return({name:"mustache.js",version:"0.4.0-dev",to_html:function(g,e,f,i){var h=new d();if(i){h.send=i}h.render(g,e||{},f);if(!i){return h.buffer.join("\n")}}})}();b.mustache=function(e,c,d){return a.to_html(e,c,d)}})(jQuery);