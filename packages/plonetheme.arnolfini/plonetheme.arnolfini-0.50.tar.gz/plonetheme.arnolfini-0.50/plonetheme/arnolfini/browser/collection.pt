<dl class="portlet portletCollection"
    i18n:domain="plone"
    tal:define="collection_url view/collection_url;
                collection python:view.collection();
                collection_name python: collection is not None and collection.Title or '';
                plone_view context/@@plone;
                toLocalizedTime nocall:plone_view/toLocalizedTime;
                viewActions here/portal_properties/site_properties/typesUseViewActionInListings|python:();
                getIcon nocall:plone_view/getIcon;">
    
    <dt class="portletHeader">
        <span class="portletTopLeft"></span>
	<span class="downArrow">&darr; </span>
        <a tal:attributes="href collection_url" tal:omit-tag="not:view/data/show_more">
            <span tal:content="view/data/header" />
        </a>
        <span class="portletTopRight"></span>
    </dt>
   
    <tal:events tal:repeat="item view/results">
    <dd class="portletItem"
        tal:define="oddrow repeat/item/odd;
			              useView    python:item.portal_type in viewActions;
				            itemUrl    python:useView and item.getURL() + '/view' or item.getURL();
                    item_icon python:getIcon(item);"

        tal:attributes="class python:oddrow and 'portletItem even' or 'portletItem odd'">
        
	<a class="imagelink" tal:condition="item/hasMedia" href="" tal:attributes="href string:${item/getURL}/view;">
	    <tal:image replace="structure python:view.getLeadMediaTag(item, scale='mini')"></tal:image>
	</a>
	
	<a href="" tal:attributes="href string:${item/getURL}/view; title item/Description" class="relatedTitle" tal:content="item/Title"></a>

	<div id="eventBooking" tal:condition="python: item.portal_type == 'Event' or item.portal_type == 'Media Event'">  
	    <p class="dates" tal:replace="structure python: view.getFormattedEventDate(item.getObject())">
		  Thursday 14 February 2013, 7.30 to 9.30pm
	    </p> 
	    <p class="booking" tal:condition="python: item.getObject().getBooking() and not view.isEventPast(item.getObject())">
		  <span class="price" tal:condition="python: item.getObject().getPrice() != ''" tal:content="python: item.getObject().getPrice()">Free</span> <span class="arrow" tal:condition="python: item.getObject().getLink() != ''">&rarr;</span> <a href="" class="bookLink" tal:condition="python: item.getObject().getLink() != ''" tal:attributes="href python:view.getEventBookingLink(item.getObject())">Book</a>
	    </p>
	</div>

	<div class="visualClear"></div>
		
    </dd>
    </tal:events>
    
    <dd class="portletFooter" tal:condition="view/data/show_more">
        <span class="portletBottomLeft"></span>
        <span>
        <a tal:attributes="href collection_url" i18n:translate="more_url">
             More&hellip;
             </a>
        </span>
        <span class="portletBottomRight"></span>
    </dd>
</dl>