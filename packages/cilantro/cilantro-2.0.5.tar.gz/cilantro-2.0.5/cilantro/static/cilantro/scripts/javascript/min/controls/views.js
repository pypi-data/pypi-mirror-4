var __hasProp={}.hasOwnProperty,__extends=function(e,t){function r(){this.constructor=e}for(var n in t)__hasProp.call(t,n)&&(e[n]=t[n]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};define(["jquery","underscore","backbone","serrano","./utils"],function(e,t,n,r,i){var s,o,u,a;return o="input,select,textarea",s=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t.prototype.options={managed:!1,idSelector:"[name=id],[data-id]",valueSelector:"[name=value],[data-value]",operatorSelector:"[name=operator],[data-operator]",nullsSelector:"[name=nulls],[data-nulls]",idAttr:"data-id",valueAttr:"data-value",operatorAttr:"data-operator",nullsAttr:"data-nulls"},t.prototype.events={"keyup input":"change","change select":"change","click input[type=radio],input[type=checkbox]":"change"},t.prototype.initialize=function(){return t.__super__.initialize.apply(this,arguments),this.idSelector=this.options.idSelector,this.valueSelector=this.options.valueSelector,this.operatorSelector=this.options.operatorSelector,this.nullsSelector=this.options.nullsSelector,this.idAttr=this.options.idAttr,this.valueAttr=this.options.valueAttr,this.operatorAttr=this.options.operatorAttr,this.nullsAttr=this.options.nullsAttr},t.prototype._templateData=function(){throw new Error("Not implemented")},t.prototype._renderTemplate=function(){if(this.template)return this.setElement(this.template(this._templateData()))},t.prototype._resetReferences=function(){return this.$id=this.$el.is(this.idSelector)?this.$el:this.$(this.idSelector),this.$operator=this.$el.is(this.operatorSelector)?this.$el:this.$(this.operatorSelector),this.$value=this.$el.is(this.valueSelector)?this.$el:this.$(this.valueSelector),this.$nulls=this.$el.is(this.nullsSelector)?this.$el:this.$(this.nullsSelector)},t.prototype._deferenceNode=function(e){var t;if((t=this._nodeCache[e])!=null)return delete this._nodeCache[e],this.node.cid===id&&delete this.node,t},t.prototype.render=function(){return this._renderTemplate(),this._resetReferences(),this.$el},t.prototype.cleanId=function(e){return parseInt(e)},t.prototype.cleanOperator=function(e){return i.coerceValue(e,"string")},t.prototype.cleanValue=function(e){return i.coerceValue(e,this.options.type)},t.prototype.cleanNulls=function(e){return i.coerceValue(e,"boolean")},t.prototype.getId=function(){var e;return this.options.id?this.options.id:(this.$id.is(o)?e=i.getInputValue(this.$id):e=this.$id.attr(this.idAttr),this.cleanId(e))},t.prototype.getOperator=function(){var e;return this.$operator.is(o)?e=i.getInputValue(this.$operator):e=this.$operator.attr(this.operatorAttr),this.cleanOperator(e)},t.prototype.getValue=function(){var e,t;return this.$value.is(o)?t=i.getInputValue(this.$value):t=this.$value.attr(this.valueAttr),e=this.cleanValue(t),i.validateValue||this.trigger("error","Invalid value for type",type,t),e},t.prototype.getNulls=function(){var e,t;return this.$nulls.is(o)?t=i.getInputValue(this.$nulls):t=this.$nulls.attr(this.nullsAttr),e=this.cleanNulls(t),i.validateValue||this.trigger("error","Invalid value for type",type,value),e},t.prototype.setId=function(e){if(this.options.id)return;this.$id.is(o)?i.setInputValue(this.$id,e):this.$id.attr(this.idAttr,e)},t.prototype.setOperator=function(e){this.$operator.is(o)?i.setInputValue(this.$operator,e):this.$operator.attr(this.operatorAttr,e)},t.prototype.setValue=function(e){this.$value.is(o)?i.setInputValue(this.$value,e):this.$value.attr(this.valueAttr,e)},t.prototype.setNulls=function(e){e=Boolean(e),this.$nulls.is(o)?i.setInputValue(this.$nulls,e):this.$nulls.attr(this.nullsAttr,e)},t.prototype.change=function(e){return this.trigger("change",this,this.get())},t.prototype.add=function(){var e;return this.node=e=new r.DataContextNode(this.get()),this._nodeCache[e.cid]=e,this.options.managed||(this.$add.hide(),this.$update.show()),this.trigger("add",this,e)},t.prototype.update=function(){return this.node.set(this.get()),this.trigger("update",this,this.node)},t.prototype.remove=function(e){var t;return t=this._deferenceNode(e),!this.options.managed&&!this.node&&(this.$update.hide(),this.$add.show()),this.trigger("remove",this,t)},t.prototype.get=function(){return{id:this.getId(),operator:this.getOperator(),value:this.getValue(),"null":this.getNulls()}},t.prototype.set=function(e){return e==null&&(e={}),this.setId(e.id),this.setValue(e.value),this.setOperator(e.operator),this.setNulls(e["null"])},t.prototype.reset=function(){return this.set()},t}(n.View),u=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return __extends(n,e),n.prototype.template=t.template('            <div class=field-control-view>                <div class=control-group>                    <h4 class=control-label>{{ label }}                        <small class=units>({{ units }})</small>                    </h4>                    <p class=help-block>{{ help }}</p>                    <div class="controls controls-row">                        <select class=span6 name=operator></select>                        <input class=span6 type=text name=value>                    </div>                </div>                <div class=control-group>                    <div class=controls>                        <label class="checkbox muted">                            <input type=checkbox name=nulls value=>                            Include NULL or empty string values                        </label>                    </div>                </div>            </div>        '),n.prototype._templateData=function(){return{label:this.model.get("alt_name")||this.model.get("name"),units:this.model.get("plural_unit"),help:this.model.get("description")}},n.prototype.render=function(){return n.__super__.render.apply(this,arguments),this.model.get("plural_unit")||this.$(".units").hide(),this.model.get("description")||this.$(".description").hide(),this.options.label||this.$(".control-label").hide(),this._renderOperators(),this._renderValues(),this.$el},n.prototype._renderOperators=function(){var e,t,n,r,i,s,o,u,a;e=this.$("[name=operator]"),u=r=this.model.get("operators");for(t=s=0,o=u.length;s<o;t=++s)a=u[t],n=a[0],i=a[1],e.append('<option value="'+n+'">'+i+"</option>");if(t<2)return e.hide(),this.$("[name-value]").removeClass("span6").addClass("span12")},n.prototype._renderValues=function(){},n}(s),a=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return __extends(t,e),t}(u),{BaseControlView:s,FieldControlView:u,RangeControlView:a}});