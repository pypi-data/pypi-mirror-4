
# commands for testing rsd

## Computing orthologs for one or more combinations of divergence and evalue thresholds

# testing that one --de option works.
cd ~/tmp && rsd_search -v --de 0.2 1e-20 -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o ./Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa_0.2_1e-20.orthologs.txt

# testing that default --de option works
cd ~/tmp && rsd_search -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o ./Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.default.orthologs.txt

# testing that multiple --de options work
cd ~/tmp && rsd_search -v --de 0.2 1e-20 --de 0.8 1e-5 -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o ./Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.two_and_eight.orthologs.txt

# testing that non-unique --de options get turned into unique ones correctly.
cd ~/tmp && rsd_search -v --de 0.2 1e-20 --de 0.8 1e-5 --de .8 .00001 -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o ./Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.two_and_eight.non-unique.orthologs.txt

# test output format 1
cd ~/tmp && rsd_search -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o ./Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.default.1.orthologs.txt --outfmt 1

# test output format 2
cd ~/tmp && rsd_search -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o ./Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.default.2.orthologs.txt --outfmt 2

# test output format 3
cd ~/tmp && rsd_search -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o ./Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.default.2.orthologs.txt --outfmt 3



## Computing blast hits with rsd_blast

# test computing forward hits
cd ~/tmp && rsd_blast -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -f q_s.hits

# test computing reverse hits
cd ~/tmp && rsd_blast -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    --reverse-hits s_q.hits

# test computing hits with --no-format
cd ~/tmp && rsd_format -v -g examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa -d .
cd ~/tmp && rsd_format -v -g examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa -d .
cd ~/tmp && rsd_blast -v -q Mycoplasma_genitalium.aa \
    --subject-genome=Mycobacterium_leprae.aa \
    -f q_s.hits --reverse-hits s_q.hits \
    --no-format

# test computing hits for a specified evalue
cd ~/tmp && rsd_blast -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -f q_s.hits -e 1e-20

# test rsd using no computed hits
cd ~/tmp && rsd_search -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.default.orthologs.txt

# test rsd using forward hits
cd ~/tmp && rsd_search -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.default.orthologs.txt \
    -f q_s.hits

# test rsd using reverse hits
cd ~/tmp && rsd_search -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.default.orthologs.txt \
    -r s_q.hits

# test rsd using forward and reverse hits
cd ~/tmp && rsd_search -v -q examples/genomes/Mycoplasma_genitalium.aa/Mycoplasma_genitalium.aa \
    --subject-genome=examples/genomes/Mycobacterium_leprae.aa/Mycobacterium_leprae.aa \
    -o Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.default.orthologs.txt \
    --forward-hits q_s.hits --reverse-hits s_q.hits --no-format

# test rsd using already formatted genomes and large evalues.  Note, blasting takes a long time w/ evalue=1e4
cd ~/tmp && rsd_search -v -q Mycoplasma_genitalium.aa \
    --subject-genome=Mycobacterium_leprae.aa \
    -o Mycoplasma_genitalium.aa_Mycobacterium_leprae.aa.big_evalues.orthologs.txt \
    --no-format --de .5 1 --de .5 100 --de .5 10000

