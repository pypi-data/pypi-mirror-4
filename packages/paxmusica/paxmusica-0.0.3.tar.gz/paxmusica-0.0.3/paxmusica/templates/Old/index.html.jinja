<html>

<meta http-equiv="content-type"
content="text/html; charset=UTF-8" />
<link rel="stylesheet" type="text/css" href="/static/main.css">
<link rel="shortcut icon" href="/static/favicon.png" />
<title>Pax Musica - Peace on playlist</title>

<body>

    <h1>

            {% if user %}
                <div id="logged_in">
                <a href="/">
            {% else %}
                <div id="not_logged_in">
                <a href="/">
            {% endif %}Pax Musica - Peace on playlist!
                </div>
        </a>
    </h1>

    <div id="userwelcome">
        {% if user %}
            Welcome {{ user }}<br>
            <form action="/logout/"
                  method="POST"
            >

                <button>Logout</button>

            </form>

        {% else %}

            <form action="/login/"
                  method="POST"
            >


            <table>
                <tr>
                    <td>Name:</td>
                    <td><input name="username"></td>
                </tr>

                <tr>
                    <td>Password:</td>
                    <td><input name="password" type="password"></td>
                </tr>
                <tr>
                    <td><button>Login</button></td>
                </tr>

            </table>


            </form>
    {% endif %}

    </div>

<img id="logo" src="/static/logo.png" width="200">

<div id="left">

    {% if musicdir.songs() %}

        <form
            action="/add/"
            method="POST"
        >

        <table>

            <tr>
                <td><h2>{{ musicdir.name() }} by {{ musicdir.songs()[0].get_artist_tag() }}</h2></td>
                <td></td>
            </tr>



            {% for song in musicdir.songs() %}
                <tr>


                    <td>{{ song.get_track_tag() }}. {{ song.get_title_tag() }}</td>

                        {% if user %}
                            <td>
                                <button name="chosen" value="{{ song.path }}">Add to playlist</button>
                            </td>
                        {% endif %}


                </tr>
            {% endfor %}

        </table>

        </form>

    {% endif %}

{% if musicdir.children() %}
    <h2>
        {% if musicdir.name() %}
            {{ musicdir.name() }}
        {% else %}
            Artists
        {% endif %}
    </h2>

	    {% for folder in musicdir.children() %}
            {% if first != folder.name() | firstcharfilter %}
                <div id="{{ folder.name() | firstcharfilter }}"></div>
            {% endif %}
            {% set first = folder.name() | firstcharfilter %}
            <a href="{{ url_for('index', path_to_music=folder.path) }}">{{ folder.name() }}</a><br>

	    {% endfor %}
    <br>

{% endif %}

<a href="{{ url_for('index', path_to_music=musicdir.parent().path) }}">One folder up</a>



<br>

</div>

<div id="right">

    {% if first_entry %}
        <p>
            <h2>Now playing:</h2>
            {% if first_entry.get_artist_tag_for_playlist() %}
                {{ first_entry.get_artist_tag_for_playlist() }} - {{ first_entry.get_title_tag_for_playlist() }}
            {% else %}
                Currently no music is playing!<br>Choose some songs and turn up the volume!
            {% endif %}
        </p>

    {% endif %}

    {% if remaining_list %}

    <p>
        <h2>Next on playlist:</h2>
	    {% for song in remaining_list %}
		    {{ song.get_artist_tag_for_playlist() }} - {{ song.get_title_tag_for_playlist() }}<br>
	    {% endfor %}
    </p>

    {% endif %}
</div>

<div id="charnav">
    <ul>

        {% for char in musicdir.initials() %}
            <li><a href="#{{ char }}">{{ char }}</a></li>
        {% endfor %}

    </ul>
</div>


    </body>
</html>
