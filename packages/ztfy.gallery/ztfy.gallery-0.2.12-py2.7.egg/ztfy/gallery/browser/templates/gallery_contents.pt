<div class="form" tal:define="title view/title | context/i18n:title | nothing" i18n:domain="ztfy.gallery">
	<h1 tal:condition="title"><span class="light">::</span>&nbsp;&nbsp;<span tal:content="title" i18n:translate="" />&nbsp;&nbsp;<span class="light">::</span></h1>
	<fieldset class="gallery">
		<legend tal:condition="view/legend | nothing" tal:content="view/legend" i18n:translate="" />
		<fieldset tal:define="hasIndex view/hasIndex">
			<legend i18n:translate="">Gallery index</legend>
			<div tal:condition="hasIndex">
				<div class="help"
					 tal:define="length python:len(view.index.values)"
					 i18n:translate="">This gallery contains an index with <tal:var i18n:name="length" tal:content="length" /> entries.</div>
				<a tal:attributes="href string:javascript:$$.ZTFY.dialog.open('${view/index/@@absolute_url}/@@contents.html')"
				   i18n:translate="">See index contents</a>
			</div>
			<div tal:condition="not:hasIndex">
				<div class="help" i18n:translate="">This gallery has no index.</div>
			</div>
		</fieldset>
		<div class="clearer"><!-- IE bugfix --></div>
		<tal:loop repeat="image context/++gallery++/values">
			<div class="image_wrapper">
				<tal:var replace="structure image/@@diapo.html" />
				<div class="toolbox">
					<div class="title" tal:content="image/image_id" />
					<div class="actions">
						<div class="checker">
							<input type="checkbox" name="selected:list" tal:attributes="value image/zope:name" />
						</div>
						<tal:loop repeat="adapter python:view.getImagesExtensions(image)">
							<a tal:attributes="href adapter/url;
											   title adapter/title;
											   class adapter/klass;" i18n:attributes="title">
								<img tal:attributes="src adapter/icon; alt adapter/title;" i18n:attributes="alt" />
							</a>
						</tal:loop>
					</div>
				</div>
			</div>
		</tal:loop>
		<div tal:condition="not:view/rows">
			<div class="help" i18n:translate="">This container is empty.</div>
		</div>
	</fieldset>
	<script type="text/javascript">
		// <![CDATA[
		if (typeof($) != 'undefined') {
			$(document).ready(function() {
				$('FIELDSET.gallery').sortable($.ZBlog.gallery.sort_options);
			});
			if ($.fn.fancybox) {
				$(document).ready(function() {
					$('DIV.img_wrapper IMG.thumbnail').parents('A').fancybox({
						type: 'image',
						titleShow: false,
						hideOnContentClick: true
					});
				});
			}
		}
		// ]]>
	</script>
</div>