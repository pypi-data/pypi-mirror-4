

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Module: pysyncml.agents &mdash; pysyncml 0.1 documentation</title>
    
    <link rel="stylesheet" href="../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/theme_extras.js"></script>
    <link rel="top" title="pysyncml 0.1 documentation" href="../../index.html" />
    <link rel="next" title="Module: pysyncml.change.merger" href="../change/merger.html" />
    <link rel="prev" title="Matching, Merging, and Conflict Resolution" href="../merging.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../../index.html">
          <span>pysyncml 0.1 documentation</span></a></h1>
        <h2 class="heading"><span>Module: pysyncml.agents</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="../merging.html">Matching, Merging, and Conflict Resolution</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="../change/merger.html">Module: pysyncml.change.merger</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="module-pysyncml.agents.base">
<span id="module-pysyncml-agents"></span><h1>Module: pysyncml.agents<a class="headerlink" href="#module-pysyncml.agents.base" title="Permalink to this headline">¶</a></h1>
<p>This module defines the abstract interface <a class="reference internal" href="#pysyncml.agents.base.Agent" title="pysyncml.agents.base.Agent"><tt class="xref py py-class docutils literal"><span class="pre">pysyncml.Agent</span></tt></a>, the base class for all pysyncml
synchronization agents.</p>
<dl class="class">
<dt id="pysyncml.agents.base.Agent">
<em class="property">class </em><tt class="descclassname">pysyncml.agents.base.</tt><tt class="descname">Agent</tt><big>(</big><em>contentTypes=None</em>, <em>hierarchicalSync=False</em>, <em>*args</em>, <em>**kw</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent" title="Permalink to this definition">¶</a></dt>
<dd><p>The <tt class="docutils literal"><span class="pre">Agent</span></tt> interface is how the pysyncml Adapter interacts with
the actual objects being synchronized.  The data is expected to be
stored by the calling framework, and pysyncml manages the protocol
for synchronization. This API defines the core required methods that
need to be implemented (<a class="reference internal" href="#pysyncml.agents.base.Agent.addItem" title="pysyncml.agents.base.Agent.addItem"><tt class="xref py py-meth docutils literal"><span class="pre">addItem()</span></tt></a>, <a class="reference internal" href="#pysyncml.agents.base.Agent.getItem" title="pysyncml.agents.base.Agent.getItem"><tt class="xref py py-meth docutils literal"><span class="pre">getItem()</span></tt></a>,
<a class="reference internal" href="#pysyncml.agents.base.Agent.replaceItem" title="pysyncml.agents.base.Agent.replaceItem"><tt class="xref py py-meth docutils literal"><span class="pre">replaceItem()</span></tt></a>, <a class="reference internal" href="#pysyncml.agents.base.Agent.deleteItem" title="pysyncml.agents.base.Agent.deleteItem"><tt class="xref py py-meth docutils literal"><span class="pre">deleteItem()</span></tt></a>, <a class="reference internal" href="#pysyncml.agents.base.Agent.getAllItems" title="pysyncml.agents.base.Agent.getAllItems"><tt class="xref py py-meth docutils literal"><span class="pre">getAllItems()</span></tt></a>,
<a class="reference internal" href="#pysyncml.agents.base.Agent.loadItem" title="pysyncml.agents.base.Agent.loadItem"><tt class="xref py py-meth docutils literal"><span class="pre">loadItem()</span></tt></a>, <a class="reference internal" href="#pysyncml.agents.base.Agent.dumpItem" title="pysyncml.agents.base.Agent.dumpItem"><tt class="xref py py-meth docutils literal"><span class="pre">dumpItem()</span></tt></a>), as well as several optional
methods that can be implemented for optimization purposes.</p>
<p>Hierarchical Item Support</p>
<p>To enable hierarchical item support for an Agent, set the attribute
(or constructor parameter) <cite>hierarchicalSync</cite> to true. This will
then cause pysyncml to process parent/child relationships. Note,
however, that pysyncml does NOT enforce any kind of integrity
checking. Specifically, pysyncml:</p>
<ul class="simple">
<li>does NOT enforce a single parentless (i.e. root) item.</li>
<li>does NOT enforce that children are deleted before their
parents.</li>
<li>does NOT detect or resolve orphaned children.</li>
</ul>
<p>These are all circumstances that are handled differently based on
what kind of parent/child relationship exists, and is therefore
outside of the scope of pysyncml to enforce.</p>
<dl class="method">
<dt id="pysyncml.agents.base.Agent.addItem">
<tt class="descname">addItem</tt><big>(</big><em>item</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.addItem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.addItem" title="Permalink to this definition">¶</a></dt>
<dd><p>The specified <cite>item</cite>, which will have been created via a prior
<tt class="docutils literal"><span class="pre">loadItem()</span></tt>, is added to the local datastore. This method
returns either a new <a class="reference internal" href="../items/index.html#pysyncml.items.base.Item" title="pysyncml.items.base.Item"><tt class="xref py py-class docutils literal"><span class="pre">pysyncml.Item</span></tt></a> instance or the same <cite>item</cite> that was
passed &#8212; in either case, the returned item <strong>MUST</strong> have a valid
<a class="reference internal" href="../items/index.html#pysyncml.items.base.Item.id" title="pysyncml.items.base.Item.id"><tt class="xref py py-attr docutils literal"><span class="pre">pysyncml.Item.id</span></tt></a> attribute.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.deleteAllItems">
<tt class="descname">deleteAllItems</tt><big>(</big><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.deleteAllItems"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.deleteAllItems" title="Permalink to this definition">¶</a></dt>
<dd><p>[OPTIONAL] Deletes all items stored by this Agent. The default
implementation simply iterates over <a class="reference internal" href="#pysyncml.agents.base.Agent.getAllItems" title="pysyncml.agents.base.Agent.getAllItems"><tt class="xref py py-meth docutils literal"><span class="pre">getAllItems()</span></tt></a> and
deletes them one at a time.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.deleteItem">
<tt class="descname">deleteItem</tt><big>(</big><em>itemID</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.deleteItem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.deleteItem" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes the local datastore item with ID <cite>itemID</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.dumpItem">
<tt class="descname">dumpItem</tt><big>(</big><em>item</em>, <em>stream</em>, <em>contentType=None</em>, <em>version=None</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.dumpItem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.dumpItem" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the specified <cite>item</cite> to serialized form (such that it can
transported over the wire) and writes it to the provided file-like
<cite>stream</cite> object. For agents that support multiple content-types,
the desired <cite>contentType</cite> and <cite>version</cite> will be specified as a
parameter. If <cite>contentType</cite> and <cite>version</cite> are None, appropriate
default values should be used. For agents that concurrently use
multiple content-types, the return value may be a two-element
tuple of (contentType, version), thus overriding or enhancing the
provided values.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.dumpsItem">
<tt class="descname">dumpsItem</tt><big>(</big><em>item</em>, <em>contentType=None</em>, <em>version=None</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.dumpsItem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.dumpsItem" title="Permalink to this definition">¶</a></dt>
<dd><p>[OPTIONAL] Identical to <tt class="xref py py-meth docutils literal"><span class="pre">dump()</span></tt>, except the serialized form
is returned as a string representation. As documented in
<tt class="xref py py-meth docutils literal"><span class="pre">dump()</span></tt>, the return value can optionally be a three-element
tuple of (contentType, version, data) if the provided content-type
should be overridden or enhanced. The default implementation just
wraps <tt class="xref py py-meth docutils literal"><span class="pre">dump()</span></tt>.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.getAllItems">
<tt class="descname">getAllItems</tt><big>(</big><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.getAllItems"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.getAllItems" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an iterable of all the items stored in the local datastore.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.getItem">
<tt class="descname">getItem</tt><big>(</big><em>itemID</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.getItem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.getItem" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <a class="reference internal" href="../items/index.html#pysyncml.items.base.Item" title="pysyncml.items.base.Item"><tt class="xref py py-class docutils literal"><span class="pre">pysyncml.Item</span></tt></a>
instance associated with the specified <cite>itemID</cite>, which may or may
not have been converted to a string.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.loadItem">
<tt class="descname">loadItem</tt><big>(</big><em>stream</em>, <em>contentType=None</em>, <em>version=None</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.loadItem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.loadItem" title="Permalink to this definition">¶</a></dt>
<dd><p>Reverses the effects of the <a class="reference internal" href="#pysyncml.agents.base.Agent.dumpItem" title="pysyncml.agents.base.Agent.dumpItem"><tt class="xref py py-meth docutils literal"><span class="pre">dumpItem()</span></tt></a> method, and returns
the de-serialized Item from the file-like source <cite>stream</cite>.</p>
<p>Note: <cite>version</cite> will typically be <tt class="docutils literal"><span class="pre">None</span></tt>, so it should either be
auto-determined, or not used. This is an issue in the SyncML
protocol, and is only here for symmetry with <a class="reference internal" href="#pysyncml.agents.base.Agent.dumpItem" title="pysyncml.agents.base.Agent.dumpItem"><tt class="xref py py-meth docutils literal"><span class="pre">dumpItem()</span></tt></a>
and as &#8220;future-proofing&#8221;.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.loadsItem">
<tt class="descname">loadsItem</tt><big>(</big><em>data</em>, <em>contentType=None</em>, <em>version=None</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.loadsItem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.loadsItem" title="Permalink to this definition">¶</a></dt>
<dd><p>[OPTIONAL] Identical to <a class="reference internal" href="#pysyncml.agents.base.Agent.loadItem" title="pysyncml.agents.base.Agent.loadItem"><tt class="xref py py-meth docutils literal"><span class="pre">loadItem()</span></tt></a>, except the serialized
form is provided as a string representation in <cite>data</cite> instead of
as a stream. The default implementation just wraps
<a class="reference internal" href="#pysyncml.agents.base.Agent.loadItem" title="pysyncml.agents.base.Agent.loadItem"><tt class="xref py py-meth docutils literal"><span class="pre">loadItem()</span></tt></a>.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.matchItem">
<tt class="descname">matchItem</tt><big>(</big><em>item</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.matchItem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.matchItem" title="Permalink to this definition">¶</a></dt>
<dd><p>[OPTIONAL] Attempts to find the specified item and returns an item
that describes the same object although it&#8217;s specific properties
may be different. For example, a contact whose name is an
identical match, but whose telephone number has changed would
return the matched item. <tt class="docutils literal"><span class="pre">None</span></tt> should be returned if no match
is found, otherwise the item that <cite>item</cite> matched should be
returned.</p>
<p>This is used primarily when a slow-sync is invoked and objects
that exist in both peers should not be replicated.</p>
<p>Note that <strong>NO</strong> merging of the items&#8217; properties should be done;
that will be initiated via a separate call to <a class="reference internal" href="#pysyncml.agents.base.Agent.mergeItems" title="pysyncml.agents.base.Agent.mergeItems"><tt class="xref py py-meth docutils literal"><span class="pre">mergeItems()</span></tt></a>.</p>
<p>This method by default will iterate over all items (by calling
<a class="reference internal" href="#pysyncml.agents.base.Agent.getAllItems" title="pysyncml.agents.base.Agent.getAllItems"><tt class="xref py py-meth docutils literal"><span class="pre">getAllItems()</span></tt></a>) and compare them using <tt class="docutils literal"><span class="pre">cmp()</span></tt>. This means
that if the items managed by this agent implement the <tt class="docutils literal"><span class="pre">__eq__</span></tt>
or <tt class="docutils literal"><span class="pre">__cmp__</span></tt> methods, then matching items will be detected and
returned. Otherwise, any items that exist in both peers will be
duplicated on slow-sync.</p>
<p>Sub-classes <em>should</em> implement a more efficient method of finding
matching items.</p>
<p>See <a class="reference internal" href="../merging.html"><em>Matching, Merging, and Conflict Resolution</em></a> for details.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.mergeItems">
<tt class="descname">mergeItems</tt><big>(</big><em>localItem</em>, <em>remoteItem</em>, <em>changeSpec</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.mergeItems"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.mergeItems" title="Permalink to this definition">¶</a></dt>
<dd><p>[OPTIONAL] Merges the properties of <cite>remoteItem</cite>, which is an item
provided by a remote peer during a synchronization, into the
<cite>localItem</cite>, which is an item retrieved from this agent either via
<a class="reference internal" href="#pysyncml.agents.base.Agent.getItem" title="pysyncml.agents.base.Agent.getItem"><tt class="xref py py-meth docutils literal"><span class="pre">getItem()</span></tt></a> or <a class="reference internal" href="#pysyncml.agents.base.Agent.matchItem" title="pysyncml.agents.base.Agent.matchItem"><tt class="xref py py-meth docutils literal"><span class="pre">matchItem()</span></tt></a>. <cite>changeSpec</cite> will represent
the changes applied to <cite>localItem</cite> since <cite>remoteItem</cite> was last
synchronized, or will be <tt class="docutils literal"><span class="pre">None</span></tt> when called as a result of a
slow-sync <a class="reference internal" href="#pysyncml.agents.base.Agent.matchItem" title="pysyncml.agents.base.Agent.matchItem"><tt class="xref py py-meth docutils literal"><span class="pre">matchItem()</span></tt></a> call.</p>
<p>This method should return a new change-spec (see
<a class="reference internal" href="#pysyncml.agents.base.Agent.replaceItem" title="pysyncml.agents.base.Agent.replaceItem"><tt class="xref py py-meth docutils literal"><span class="pre">replaceItem()</span></tt></a> for details) that represents the changes
applied to <cite>localItem</cite> from <cite>remoteItem</cite>.</p>
<p>If the items cannot be merged, then a <cite>pysyncml.ConflictError</cite>
should be raised with more descriptive information on what failed
during the merge &#8212; in which case pysyncml will revert to the
conflict resolution policy defined by <cite>store.conflictPolicy</cite> or
<cite>adapter.conflictPolicy</cite>.</p>
<p>IMPORTANT: if the merge fails, <cite>localItem</cite> and <cite>remoteItem</cite> must
stay untouched by this call; most importantly, if the merge fails
with a ConflictError, then <cite>remoteItem</cite> must be in the identical
state as when it entered the call.</p>
<p>This method by default raises a ConflictError, which means that if
any changes are made to the same item simultaneously by two
different peers, they will result in a conflict and will not be
auto-mergeable.</p>
<p>See <a class="reference internal" href="../merging.html"><em>Matching, Merging, and Conflict Resolution</em></a> for details.</p>
</dd></dl>

<dl class="method">
<dt id="pysyncml.agents.base.Agent.replaceItem">
<tt class="descname">replaceItem</tt><big>(</big><em>item</em>, <em>reportChanges</em><big>)</big><a class="reference internal" href="../../_modules/pysyncml/agents/base.html#Agent.replaceItem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pysyncml.agents.base.Agent.replaceItem" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the local datastore item with ID <cite>item.id</cite> to the value
provided as <cite>item</cite>, which will have been created via a prior
<tt class="docutils literal"><span class="pre">loadItem()</span></tt>.</p>
<p>If <cite>reportChanges</cite> is True, then the return value will be used to
track the changes that were applied. If <cite>reportChanges</cite> is True but
<tt class="docutils literal"><span class="pre">None</span></tt> is returned, then change tracking will be disabled for
this change, which will cascade to any past or future changes that
have not yet been synchronized. The return value must be a string
(or an object that supports coercion via <tt class="docutils literal"><span class="pre">str()</span></tt>). If multiple
changes accumulate for an object, they will be concatenated, in
order, and delimited via a semicolon (&#8221;;&#8221;). See <a class="reference internal" href="../merging.html"><em>Matching, Merging, and Conflict Resolution</em></a>
for details.</p>
</dd></dl>

</dd></dl>

<div class="section" id="standard-agent-implementations">
<h2>Standard Agent Implementations<a class="headerlink" href="#standard-agent-implementations" title="Permalink to this headline">¶</a></h2>
<p>TODO: documentation on available standard Agent implementations coming soon...</p>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="../merging.html">Matching, Merging, and Conflict Resolution</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="../change/merger.html">Module: pysyncml.change.merger</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012-2012, UberDev, No Rights Reserved.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>