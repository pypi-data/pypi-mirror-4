<div class="form" tal:define="title view/title | context/i18n:title | nothing" i18n:domain="ztfy.thesaurus">
	<h1 tal:condition="title"><span class="light">::</span>&nbsp;&nbsp;<span tal:content="title" i18n:translate="" />&nbsp;&nbsp;<span class="light">::</span></h1>
	<fieldset tal:define="extracts view/extracts">
		<legend tal:condition="view/legend | nothing" tal:content="view/legend" i18n:translate="" />
		<fieldset class="half" tal:condition="extracts">
			<legend i18n:translate="">Thesaurus extracts</legend>
			<div class="extract" tal:repeat="extract extracts/values">
				<tal:var define="can_manage extract/permission:ztfy.ManageThesaurusExtract">
					<span tal:condition="not:can_manage" class="square readonly"
						  style="border: none; width: 16px; background: transparent url('/--static--/ztfy.thesaurus/img/locked.gif') scroll no-repeat 50% 50%;"
						  title="This extract can't be modified" i18n:attributes="title"></span>
					<span tal:condition="can_manage" class="square" style="border: none; width: 16px;"></span>
					<span class="square showhide" tal:attributes="style string:border: none;; width: 16px;; background: transparent url('/--static--/ztfy.thesaurus/img/visible.gif') scroll no-repeat 50% 50%;;;
																  ztfy_extract extract/zope:name;
																  ztfy_color extract/color;
																  ztfy_enabled can_manage;"
						  title="Show or hide terms of this extract" i18n:attributes="title"></span>
					<span class="square color" tal:attributes="style string:background-color: #${extract/color};"></span>
				</tal:var>
				&nbsp;<a class="label" title="Display extract terms tree" i18n:attributes="title">
					<img src="/--static--/ztfy.thesaurus/img/loupe.gif" tal:attributes="onclick string:$.ZTFY.dialog.open('${extract/@@absolute_url}/@@terms.html');" />
				</a>
				<tal:var content="extract/name" />
				<div class="clearer"></div>
			</div>
		</fieldset><br />
		<div class="half tree"
			 tal:attributes="ztfy_base context/@@absolute_url">
			<div class="required-info"></div>
			<tal:loop repeat="node view/tree">
				<div>
					<img src="/--static--/ztfy.thesaurus/img/plus.png" class="plminus" tal:condition="node/hasChildren"
						 tal:attributes="onclick string:$$.ZTFY.thesaurus.tree.expand(this);"/><img
						 src="/--static--/ztfy.thesaurus/img/lline.png" class="plminus" tal:condition="not:node/hasChildren" /><a
						 tal:attributes="class string:label ${node/cssClass}" tal:content="node/label" onclick="$.ZTFY.thesaurus.tree.openTerm(this); return false;" />
					<img class="extension"
						 tal:repeat="ext node/context/queryExtensions"
						 tal:attributes="src ext/icon;
										 title ext/label;
										 onclick string:$.ZTFY.dialog.open('${node/context/@@absolute_url}/${ext/target_view}');;"
						 i18n:attributes="title" />
					<tal:if condition="extracts">
						<tal:loop repeat="extract python:reversed(list(extracts.keys()))">
							<tal:if condition="python:extract in node.context.extracts">
								<span class="used square" tal:attributes="title python:extracts[extract].name;
																		  ztfy_extract extract;
																		  style python:'background-color: #%s;;' % extracts[extract].color;"></span>
							</tal:if>
							<tal:if condition="python:extract not in node.context.extracts">
								<span class="square" tal:attributes="title python:extracts[extract].name;
																	 ztfy_extract extract;"
									  style="background-color: white;"></span>
							</tal:if> 
						</tal:loop>
					</tal:if>
					<div class="subnodes"></div>
				</div>
			</tal:loop>
		</div>
		<script type="text/javascript">
			$(document).ready(function() {
				$('DIV.extract SPAN.showhide').click(function() {
					$.ZTFY.thesaurus.tree.showHideExtract(this);
				});
				$('DIV.tree SPAN.square').click(function() {
					$.ZTFY.thesaurus.tree.switchExtract(this);
				});
			});
		</script>
	</fieldset>
</div>