#!/usr/bin/env python3
import argparse
import os
from os import path
import sys

import nib

if __name__ == '__main__':
    parser = argparse.ArgumentParser(description='Get more information at http://github.com/jreese/nib')
    parser.add_argument('-V', '--version',
                        action='version',
                        version='%(prog)s ' + nib.version)
    parser.add_argument('-d', '--debug',
                        dest='debug',
                        action='store_true',
                        default=False,
                        help='debug output')
    parser.add_argument('-c', '--config',
                        dest='config',
                        metavar='FILE',
                        action='store',
                        default=None,
                        help='site configuration file (default is config.nib)')

    options = parser.parse_args()

    try:
        nib.Build(nib.Config(options.config)).run()
        print('Done')

    except Exception as e:
        if (options.debug):
            raise

        sys.stderr.write('Error: {}\n'.format(e))
        sys.exit(1)
