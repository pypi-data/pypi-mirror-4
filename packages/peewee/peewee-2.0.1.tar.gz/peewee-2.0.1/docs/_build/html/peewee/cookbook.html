
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Peewee Cookbook &mdash; peewee 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="peewee 1.0.0 documentation" href="../index.html" />
    <link rel="next" title="Example app" href="example.html" />
    <link rel="prev" title="Installing peewee" href="installation.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="example.html" title="Example app"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installing peewee"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">peewee 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="peewee-cookbook">
<span id="cookbook"></span><h1>Peewee Cookbook<a class="headerlink" href="#peewee-cookbook" title="Permalink to this headline">¶</a></h1>
<p>Below are outlined some of the ways to perform typical database-related tasks
with peewee.</p>
<p>Examples will use the following models:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">peewee</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">peewee</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">creator</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>


<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">peewee</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">blog</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">ForeignKeyField</span><span class="p">(</span><span class="n">Blog</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>
    <span class="n">body</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>
    <span class="n">pub_date</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">DateTimeField</span><span class="p">()</span>
    <span class="n">published</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">BooleanField</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="database-and-connection-recipes">
<h2>Database and Connection Recipes<a class="headerlink" href="#database-and-connection-recipes" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-a-database-connection-and-tables">
<h3>Creating a database connection and tables<a class="headerlink" href="#creating-a-database-connection-and-tables" title="Permalink to this headline">¶</a></h3>
<p>While it is not necessary to explicitly connect to the database before using it,
managing connections explicitly is a good practice.  This way if the connection
fails, the exception can be caught during the &#8220;connect&#8221; step, rather than some
arbitrary time later when a query is executed.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">database</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;stats.db&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">database</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
<p>To use this database with your models, specify it in an inner &#8220;Meta&#8221; class:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">some_field</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">database</span>
</pre></div>
</div>
<p>It is possible to use multiple databases (provided that you don&#8217;t try and mix
models from each):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">custom_db</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;custom.db&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">CustomModel</span><span class="p">(</span><span class="n">peewee</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">whatev</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">database</span> <span class="o">=</span> <span class="n">custom_db</span>
<span class="gp">...</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">custom_db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CustomModel</span><span class="o">.</span><span class="n">create_table</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Best practice:</strong> define a base model class that points at the database object
you wish to use, and then all your models will extend it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">custom_db</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;custom.db&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">CustomModel</span><span class="p">(</span><span class="n">peewee</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">custom_db</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">CustomModel</span><span class="p">):</span>
    <span class="n">creator</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">TextField</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Entry</span><span class="p">(</span><span class="n">CustomModel</span><span class="p">):</span>
    <span class="c"># etc, etc</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Remember to specify a database in a model class (or its parent class),
otherwise peewee will fall back to a default sqlite database named &#8220;peewee.db&#8221;.</p>
</div>
</div>
<div class="section" id="using-with-postgresql">
<h3>Using with Postgresql<a class="headerlink" href="#using-with-postgresql" title="Permalink to this headline">¶</a></h3>
<p>Point models at an instance of <a class="reference internal" href="database.html#PostgresqlDatabase" title="PostgresqlDatabase"><tt class="xref py py-class docutils literal"><span class="pre">PostgresqlDatabase</span></tt></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">psql_db</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">PostgresqlDatabase</span><span class="p">(</span><span class="s">&#39;my_database&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s">&#39;code&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">PostgresqlModel</span><span class="p">(</span><span class="n">peewee</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A base model that will use our Postgresql database&quot;&quot;&quot;</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">psql_db</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">PostgresqlModel</span><span class="p">):</span>
    <span class="n">creator</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>
    <span class="c"># etc, etc</span>
</pre></div>
</div>
</div>
<div class="section" id="using-with-mysql">
<h3>Using with MySQL<a class="headerlink" href="#using-with-mysql" title="Permalink to this headline">¶</a></h3>
<p>Point models at an instance of <a class="reference internal" href="database.html#MySQLDatabase" title="MySQLDatabase"><tt class="xref py py-class docutils literal"><span class="pre">MySQLDatabase</span></tt></a>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">mysql_db</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">MySQLDatabase</span><span class="p">(</span><span class="s">&#39;my_database&#39;</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="s">&#39;code&#39;</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">MySQLModel</span><span class="p">(</span><span class="n">peewee</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A base model that will use our MySQL database&quot;&quot;&quot;</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">mysql_db</span>

<span class="k">class</span> <span class="nc">Blog</span><span class="p">(</span><span class="n">MySQLModel</span><span class="p">):</span>
    <span class="n">creator</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">CharField</span><span class="p">()</span>
    <span class="c"># etc, etc</span>


<span class="c"># when you&#39;re ready to start querying, remember to connect</span>
<span class="n">mysql_db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="multi-threaded-applications">
<h3>Multi-threaded applications<a class="headerlink" href="#multi-threaded-applications" title="Permalink to this headline">¶</a></h3>
<p>Some database engines may not allow a connection to be shared across threads, notably
sqlite.  If you would like peewee to maintain a single connection per-thread,
instantiate your database with <tt class="docutils literal"><span class="pre">threadlocals=True</span></tt> (<em>recommended</em>):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">concurrent_db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;stats.db&#39;</span><span class="p">,</span> <span class="n">threadlocals</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The above implementation stores connection state in a thread local and will only
use that connection for a given thread.  Pysqlite can share a connection across
threads, so if you would prefer to reuse a connection in multiple threads:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">native_concurrent_db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;stats.db&#39;</span><span class="p">,</span> <span class="n">check_same_thread</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="deferring-initialization">
<span id="id1"></span><h3>Deferring initialization<a class="headerlink" href="#deferring-initialization" title="Permalink to this headline">¶</a></h3>
<p>Sometimes the database information is not known until run-time, when it might
be loaded from a configuration file/etc.  In this case, you can &#8220;defer&#8221; the initialization
of the database by passing in <tt class="docutils literal"><span class="pre">None</span></tt> as the database_name.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">deferred_db</span> <span class="o">=</span> <span class="n">peewee</span><span class="o">.</span><span class="n">SqliteDatabase</span><span class="p">(</span><span class="bp">None</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">SomeModel</span><span class="p">(</span><span class="n">peewee</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">database</span> <span class="o">=</span> <span class="n">deferred_db</span>
</pre></div>
</div>
<p>If you try to connect or issue any queries while your database is uninitialized
you will get an exception:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">deferred_db</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="go">Exception: Error, database not properly initialized before opening connection</span>
</pre></div>
</div>
<p>To initialize your database, you simply call the <tt class="docutils literal"><span class="pre">init</span></tt> method with the database_name
and any additional kwargs:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">database_name</span> <span class="o">=</span> <span class="nb">raw_input</span><span class="p">(</span><span class="s">&#39;What is the name of the db? &#39;</span><span class="p">)</span>
<span class="n">deferred_db</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">database_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-reading-updating-and-deleting">
<h2>Creating, Reading, Updating and Deleting<a class="headerlink" href="#creating-reading-updating-and-deleting" title="Permalink to this headline">¶</a></h2>
<div class="section" id="creating-a-new-record">
<h3>Creating a new record<a class="headerlink" href="#creating-a-new-record" title="Permalink to this headline">¶</a></h3>
<p>You can use the <a class="reference internal" href="models.html#Model.create" title="Model.create"><tt class="xref py py-meth docutils literal"><span class="pre">Model.create()</span></tt></a> method on the model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">creator</span><span class="o">=</span><span class="s">&#39;Charlie&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;My Blog&#39;</span><span class="p">)</span>
<span class="go">&lt;__main__.Blog object at 0x2529350&gt;</span>
</pre></div>
</div>
<p>This will <tt class="docutils literal"><span class="pre">INSERT</span></tt> a new row into the database.  The primary key will automatically
be retrieved and stored on the model instance.</p>
<p>Alternatively, you can build up a model instance programmatically and then
save it:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span><span class="o">.</span><span class="n">creator</span> <span class="o">=</span> <span class="s">&#39;Chuck&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&#39;Another blog&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span><span class="o">.</span><span class="n">id</span>
<span class="go">2</span>
</pre></div>
</div>
<p>See also <a class="reference internal" href="models.html#Model.save" title="Model.save"><tt class="xref py py-meth docutils literal"><span class="pre">Model.save()</span></tt></a>, <a class="reference internal" href="models.html#Model.insert" title="Model.insert"><tt class="xref py py-meth docutils literal"><span class="pre">Model.insert()</span></tt></a> and <a class="reference internal" href="querying.html#InsertQuery" title="InsertQuery"><tt class="xref py py-class docutils literal"><span class="pre">InsertQuery</span></tt></a></p>
</div>
<div class="section" id="updating-existing-records">
<h3>Updating existing records<a class="headerlink" href="#updating-existing-records" title="Permalink to this headline">¶</a></h3>
<p>Once a model instance has a primary key, any attempt to re-save it will result
in an <tt class="docutils literal"><span class="pre">UPDATE</span></tt> rather than another <tt class="docutils literal"><span class="pre">INSERT</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span><span class="o">.</span><span class="n">id</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span><span class="o">.</span><span class="n">id</span>
<span class="go">2</span>
</pre></div>
</div>
<p>If you want to update multiple records, issue an <tt class="docutils literal"><span class="pre">UPDATE</span></tt> query.  The following
example will update all <tt class="docutils literal"><span class="pre">Entry</span></tt> objects, marking them as &#8220;published&#8221;, if their
pub_date is less than today&#8217;s date.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">update_query</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">published</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pub_date__lt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">update_query</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="go">4 # &lt;--- number of rows updated</span>
</pre></div>
</div>
<p>For more information, see the documentation on <a class="reference internal" href="querying.html#UpdateQuery" title="UpdateQuery"><tt class="xref py py-class docutils literal"><span class="pre">UpdateQuery</span></tt></a>.</p>
</div>
<div class="section" id="deleting-a-record">
<h3>Deleting a record<a class="headerlink" href="#deleting-a-record" title="Permalink to this headline">¶</a></h3>
<p>To delete a single model instance, you can use the <a class="reference internal" href="models.html#Model.delete_instance" title="Model.delete_instance"><tt class="xref py py-meth docutils literal"><span class="pre">Model.delete_instance()</span></tt></a>
shortcut:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">blog</span><span class="o">.</span><span class="n">delete_instance</span><span class="p">()</span>
<span class="go">1 # &lt;--- number of rows deleted</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">BlogDoesNotExist: instance matching query does not exist:</span>
<span class="go">SQL: SELECT &quot;id&quot;, &quot;creator&quot;, &quot;name&quot; FROM &quot;blog&quot; WHERE &quot;id&quot; = ? LIMIT 1</span>
<span class="go">PARAMS: [1]</span>
</pre></div>
</div>
<p>To delete an arbitrary group of records, you can issue a <tt class="docutils literal"><span class="pre">DELETE</span></tt> query.  The
following will delete all <tt class="docutils literal"><span class="pre">Entry</span></tt> objects that are a year old.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">delete_query</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pub_date__lt</span><span class="o">=</span><span class="n">one_year_ago</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">delete_query</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="go">7 # &lt;--- number of entries deleted</span>
</pre></div>
</div>
<p>For more information, see the documentation on <a class="reference internal" href="querying.html#DeleteQuery" title="DeleteQuery"><tt class="xref py py-class docutils literal"><span class="pre">DeleteQuery</span></tt></a>.</p>
</div>
<div class="section" id="selecting-a-single-record">
<h3>Selecting a single record<a class="headerlink" href="#selecting-a-single-record" title="Permalink to this headline">¶</a></h3>
<p>You can use the <a class="reference internal" href="models.html#Model.get" title="Model.get"><tt class="xref py py-meth docutils literal"><span class="pre">Model.get()</span></tt></a> method to retrieve a single instance matching
the given query (passed in as a mix of <tt class="xref py py-class docutils literal"><span class="pre">Q</span></tt> objects and keyword arguments).</p>
<p>This method is a shortcut that calls <a class="reference internal" href="models.html#Model.select" title="Model.select"><tt class="xref py py-meth docutils literal"><span class="pre">Model.select()</span></tt></a> with the given query,
but limits the result set to 1.  Additionally, if no model matches the given query,
a <tt class="docutils literal"><span class="pre">DoesNotExist</span></tt> exception will be raised.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">&lt;__main__.Blog object at 0x25294d0&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">name</span>
<span class="go">u&#39;My Blog&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">creator</span><span class="o">=</span><span class="s">&#39;Chuck&#39;</span><span class="p">)</span>
<span class="go">&lt;__main__.Blog object at 0x2529410&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Blog</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="go">BlogDoesNotExist: instance matching query does not exist:</span>
<span class="go">SQL: SELECT &quot;id&quot;, &quot;creator&quot;, &quot;name&quot; FROM &quot;blog&quot; WHERE &quot;id&quot; = ? LIMIT 1</span>
<span class="go">PARAMS: [1000]</span>
</pre></div>
</div>
<p>For more information see notes on <a class="reference internal" href="querying.html#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a> and <a class="reference internal" href="querying.html#querying"><em>Querying API</em></a> in general.</p>
</div>
<div class="section" id="selecting-multiple-records">
<h3>Selecting multiple records<a class="headerlink" href="#selecting-multiple-records" title="Permalink to this headline">¶</a></h3>
<p>To simply get all instances in a table, call the <a class="reference internal" href="models.html#Model.select" title="Model.select"><tt class="xref py py-meth docutils literal"><span class="pre">Model.select()</span></tt></a> method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">blog</span> <span class="ow">in</span> <span class="n">Blog</span><span class="o">.</span><span class="n">select</span><span class="p">():</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">blog</span><span class="o">.</span><span class="n">name</span>
<span class="gp">...</span>
<span class="go">My Blog</span>
<span class="go">Another blog</span>
</pre></div>
</div>
<p>When you iterate over a <a class="reference internal" href="querying.html#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a>, it will automatically execute
it and start returning results from the database cursor.  Subsequent iterations
of the same query will not hit the database as the results are cached.</p>
<p>Another useful note is that you can retrieve instances related by <a class="reference internal" href="fields.html#ForeignKeyField" title="ForeignKeyField"><tt class="xref py py-class docutils literal"><span class="pre">ForeignKeyField</span></tt></a>
by iterating.  To get all the related instances for an object, you can query the related name.
Looking at the example models, we have Blogs and Entries.  Entry has a foreign key to Blog,
meaning that any given blog may have 0..n entries.  A blog&#8217;s related entries are exposed
using a <a class="reference internal" href="querying.html#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a>, and can be iterated the same as any other SelectQuery:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">blog</span><span class="o">.</span><span class="n">entry_set</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">entry</span><span class="o">.</span><span class="n">title</span>
<span class="gp">...</span>
<span class="go">entry 1</span>
<span class="go">entry 2</span>
<span class="go">entry 3</span>
<span class="go">entry 4</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">entry_set</span></tt> attribute is just another select query and any methods available
to <a class="reference internal" href="querying.html#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a> are available:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">blog</span><span class="o">.</span><span class="n">entry_set</span><span class="o">.</span><span class="n">order_by</span><span class="p">((</span><span class="s">&#39;pub_date&#39;</span><span class="p">,</span> <span class="s">&#39;desc&#39;</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">entry</span><span class="o">.</span><span class="n">title</span>
<span class="gp">...</span>
<span class="go">entry 4</span>
<span class="go">entry 3</span>
<span class="go">entry 2</span>
<span class="go">entry 1</span>
</pre></div>
</div>
</div>
<div class="section" id="filtering-records">
<h3>Filtering records<a class="headerlink" href="#filtering-records" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">blog</span><span class="o">=</span><span class="n">blog</span><span class="p">,</span> <span class="n">published</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="s">&#39;</span><span class="si">%s</span><span class="s">: </span><span class="si">%s</span><span class="s"> (</span><span class="si">%s</span><span class="s">)&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">blog</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">published</span><span class="p">)</span>
<span class="gp">...</span>
<span class="go">My Blog: Some Entry (True)</span>
<span class="go">My Blog: Another Entry (True)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pub_date__lt</span><span class="o">=</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">entry</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">entry</span><span class="o">.</span><span class="n">pub_date</span>
<span class="gp">...</span>
<span class="go">Old entry 2010-01-01 00:00:00</span>
</pre></div>
</div>
<p>You can also filter across joins:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Blog</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;My Blog&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">entry</span><span class="o">.</span><span class="n">title</span>
<span class="go">Old entry</span>
<span class="go">Some Entry</span>
<span class="go">Another Entry</span>
</pre></div>
</div>
<p>If you are already familiar with Django&#8217;s ORM, you can use the &#8220;double underscore&#8221;
syntax:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">blog__name</span><span class="o">=</span><span class="s">&#39;My Blog&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">entry</span><span class="o">.</span><span class="n">title</span>
<span class="go">Old entry</span>
<span class="go">Some Entry</span>
<span class="go">Another Entry</span>
</pre></div>
</div>
<p>If you prefer, you can use python operators to query:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Blog</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Blog</span><span class="o">.</span><span class="n">name</span><span class="o">==</span><span class="s">&#39;My Blog&#39;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">entry</span><span class="o">.</span><span class="n">title</span>
</pre></div>
</div>
<p>To perform OR lookups, use the special <tt class="xref py py-class docutils literal"><span class="pre">Q</span></tt> object.  These work in
both calls to <tt class="docutils literal"><span class="pre">filter()</span></tt> and <tt class="docutils literal"><span class="pre">where()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">User</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">Q</span><span class="p">(</span><span class="n">staff</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="o">|</span> <span class="n">Q</span><span class="p">(</span><span class="n">superuser</span><span class="o">=</span><span class="bp">True</span><span class="p">))</span> <span class="c"># get staff or superusers</span>
</pre></div>
</div>
<p>To perform lookups against <em>another column</em> in a given row, use the <tt class="xref py py-class docutils literal"><span class="pre">F</span></tt> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Employee</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">salary__lt</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s">&#39;desired_salary&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Check <a class="reference internal" href="querying.html#query-compare"><em>the docs</em></a> for more examples of querying.</p>
</div>
<div class="section" id="sorting-records">
<h3>Sorting records<a class="headerlink" href="#sorting-records" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;pub_date&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">e</span><span class="o">.</span><span class="n">pub_date</span>
<span class="gp">...</span>
<span class="go">2010-01-01 00:00:00</span>
<span class="go">2011-06-07 14:08:48</span>
<span class="go">2011-06-07 14:12:57</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="n">peewee</span><span class="o">.</span><span class="n">desc</span><span class="p">(</span><span class="s">&#39;pub_date&#39;</span><span class="p">)):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">e</span><span class="o">.</span><span class="n">pub_date</span>
<span class="gp">...</span>
<span class="go">2011-06-07 14:12:57</span>
<span class="go">2011-06-07 14:08:48</span>
<span class="go">2010-01-01 00:00:00</span>
</pre></div>
</div>
<p>You can also order across joins.  Assuming you want
to order entries by the name of the blog, then by pubdate desc:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">qry</span> <span class="o">=</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Blog</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">(</span><span class="n">Blog</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">),</span>
<span class="gp">... </span>    <span class="p">(</span><span class="n">Entry</span><span class="p">,</span> <span class="s">&#39;pub_date&#39;</span><span class="p">,</span> <span class="s">&#39;DESC&#39;</span><span class="p">),</span>
<span class="gp">... </span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">qry</span><span class="o">.</span><span class="n">sql</span><span class="p">()</span>
<span class="go">(&#39;SELECT t1.* FROM entry AS t1 INNER JOIN blog AS t2 ON t1.blog_id = t2.id ORDER BY t2.name ASC, t1.pub_date DESC&#39;, [])</span>
</pre></div>
</div>
</div>
<div class="section" id="paginating-records">
<h3>Paginating records<a class="headerlink" href="#paginating-records" title="Permalink to this headline">¶</a></h3>
<p>The paginate method makes it easy to grab a &#8220;page&#8221; or records &#8211; it takes two
parameters, <cite>page_number</cite>, and <cite>items_per_page</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">paginate</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">print</span> <span class="n">entry</span><span class="o">.</span><span class="n">title</span>
<span class="gp">...</span>
<span class="go">entry 10</span>
<span class="go">entry 11</span>
<span class="go">entry 12</span>
<span class="go">entry 13</span>
<span class="go">entry 14</span>
<span class="go">entry 15</span>
<span class="go">entry 16</span>
<span class="go">entry 17</span>
<span class="go">entry 18</span>
<span class="go">entry 19</span>
</pre></div>
</div>
</div>
<div class="section" id="counting-records">
<h3>Counting records<a class="headerlink" href="#counting-records" title="Permalink to this headline">¶</a></h3>
<p>You can count the number of rows in any select query:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">100</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Entry</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">id__gt</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="go">50</span>
</pre></div>
</div>
</div>
<div class="section" id="iterating-over-lots-of-rows">
<h3>Iterating over lots of rows<a class="headerlink" href="#iterating-over-lots-of-rows" title="Permalink to this headline">¶</a></h3>
<p>To limit the amount of memory used by peewee when iterating over a lot of rows (i.e.
you may be dumping data to csv), use the <tt class="docutils literal"><span class="pre">iterator()</span></tt> method on the <tt class="xref py py-class docutils literal"><span class="pre">QueryResultWrapper</span></tt>.
This method allows you to iterate without caching each model returned, using much less
memory when iterating over large result sets:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># let&#39;s assume we&#39;ve got 1M stat objects to dump to csv</span>
<span class="n">stats_qr</span> <span class="o">=</span> <span class="n">Stat</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

<span class="c"># our imaginary serializer class</span>
<span class="n">serializer</span> <span class="o">=</span> <span class="n">CSVSerializer</span><span class="p">()</span>

<span class="c"># loop over all the stats and serialize</span>
<span class="k">for</span> <span class="n">stat</span> <span class="ow">in</span> <span class="n">stats_qr</span><span class="o">.</span><span class="n">iterator</span><span class="p">():</span>
    <span class="n">serializer</span><span class="o">.</span><span class="n">serialize_object</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
</pre></div>
</div>
<p>For simple queries you can see further speed improvements by using the <a class="reference internal" href="querying.html#SelectQuery.naive" title="SelectQuery.naive"><tt class="xref py py-meth docutils literal"><span class="pre">SelectQuery.naive()</span></tt></a>
query method.  See the documentation for details on this optimization.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">stats_query</span> <span class="o">=</span> <span class="n">Stat</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">naive</span><span class="p">()</span> <span class="c"># note we are calling &quot;naive()&quot;</span>
<span class="n">stats_qr</span> <span class="o">=</span> <span class="n">stats_query</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>

<span class="k">for</span> <span class="n">stat</span> <span class="ow">in</span> <span class="n">stats_qr</span><span class="o">.</span><span class="n">iterator</span><span class="p">():</span>
    <span class="n">serializer</span><span class="o">.</span><span class="n">serialize_object</span><span class="p">(</span><span class="n">stat</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="performing-atomic-updates">
<h3>Performing atomic updates<a class="headerlink" href="#performing-atomic-updates" title="Permalink to this headline">¶</a></h3>
<p>Use the special <tt class="xref py py-class docutils literal"><span class="pre">F</span></tt> object to perform an atomic update:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">MessageCount</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">count</span><span class="o">=</span><span class="n">F</span><span class="p">(</span><span class="s">&#39;count&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">user</span><span class="o">=</span><span class="n">some_user</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="aggregating-records">
<h3>Aggregating records<a class="headerlink" href="#aggregating-records" title="Permalink to this headline">¶</a></h3>
<p>Suppose you have some blogs and want to get a list of them along with the count
of entries in each.  First I will show you the shortcut:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">query</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">Entry</span><span class="p">)</span>
</pre></div>
</div>
<p>This is equivalent to the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">query</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">select</span><span class="p">({</span>
    <span class="n">Blog</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;*&#39;</span><span class="p">],</span>
    <span class="n">Entry</span><span class="p">:</span> <span class="p">[</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">)],</span>
<span class="p">})</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">Blog</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Entry</span><span class="p">)</span>
</pre></div>
</div>
<p>The resulting query will return Blog objects with all their normal attributes
plus an additional attribute &#8216;count&#8217; which will contain the number of entries.
By default it uses an inner join if the foreign key is not nullable, which means
blogs without entries won&#8217;t appear in the list.  To remedy this, manually specify
the type of join to include blogs with 0 entries:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">query</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Entry</span><span class="p">,</span> <span class="s">&#39;left outer&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">Entry</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also specify a custom aggregator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">query</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="n">Entry</span><span class="p">,</span> <span class="n">peewee</span><span class="o">.</span><span class="n">Max</span><span class="p">(</span><span class="s">&#39;pub_date&#39;</span><span class="p">,</span> <span class="s">&#39;max_pub_date&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Let&#8217;s assume you have a tagging application and want to find tags that have a
certain number of related objects.  For this example we&#8217;ll use some different
models in a Many-To-Many configuration:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Photo</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Tag</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PhotoTag</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">photo</span> <span class="o">=</span> <span class="n">ForeignKeyField</span><span class="p">(</span><span class="n">Photo</span><span class="p">)</span>
    <span class="n">tag</span> <span class="o">=</span> <span class="n">ForeignKeyField</span><span class="p">(</span><span class="n">Tag</span><span class="p">)</span>
</pre></div>
</div>
<p>Now say we want to find tags that have at least 5 photos associated with them:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Tag</span><span class="o">.</span><span class="n">select</span><span class="p">()</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PhotoTag</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Photo</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">Tag</span><span class="p">)</span><span class="o">.</span><span class="n">having</span><span class="p">(</span><span class="s">&#39;count(*) &gt; 5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sql</span><span class="p">()</span>

<span class="go">SELECT t1.&quot;id&quot;, t1.&quot;name&quot;</span>
<span class="go">FROM &quot;tag&quot; AS t1</span>
<span class="go">INNER JOIN &quot;phototag&quot; AS t2</span>
<span class="go">    ON t1.&quot;id&quot; = t2.&quot;tag_id&quot;</span>
<span class="go">INNER JOIN &quot;photo&quot; AS t3</span>
<span class="go">    ON t2.&quot;photo_id&quot; = t3.&quot;id&quot;</span>
<span class="go">GROUP BY</span>
<span class="go">    t1.&quot;id&quot;, t1.&quot;name&quot;</span>
<span class="go">HAVING count(*) &gt; 5</span>
</pre></div>
</div>
<p>Suppose we want to grab the associated count and store it on the tag:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Tag</span><span class="o">.</span><span class="n">select</span><span class="p">({</span>
<span class="gp">... </span>    <span class="n">Tag</span><span class="p">:</span> <span class="p">[</span><span class="s">&#39;*&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">Photo</span><span class="p">:</span> <span class="p">[</span><span class="n">Count</span><span class="p">(</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;count&#39;</span><span class="p">)]</span>
<span class="gp">... </span><span class="p">})</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">PhotoTag</span><span class="p">)</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">Photo</span><span class="p">)</span><span class="o">.</span><span class="n">group_by</span><span class="p">(</span><span class="n">Tag</span><span class="p">)</span><span class="o">.</span><span class="n">having</span><span class="p">(</span><span class="s">&#39;count(*) &gt; 5&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sql</span><span class="p">()</span>

<span class="go">SELECT t1.&quot;id&quot;, t1.&quot;name&quot;, COUNT(t3.&quot;id&quot;) AS count</span>
<span class="go">FROM &quot;tag&quot; AS t1</span>
<span class="go">INNER JOIN &quot;phototag&quot; AS t2</span>
<span class="go">    ON t1.&quot;id&quot; = t2.&quot;tag_id&quot;</span>
<span class="go">INNER JOIN &quot;photo&quot; AS t3</span>
<span class="go">    ON t2.&quot;photo_id&quot; = t3.&quot;id&quot;</span>
<span class="go">GROUP BY</span>
<span class="go">    t1.&quot;id&quot;, t1.&quot;name&quot;</span>
<span class="go">HAVING count(*) &gt; 5</span>
</pre></div>
</div>
</div>
<div class="section" id="sql-functions-subqueries-and-raw-expressions">
<h3>SQL Functions, Subqueries and &#8220;Raw expressions&#8221;<a class="headerlink" href="#sql-functions-subqueries-and-raw-expressions" title="Permalink to this headline">¶</a></h3>
<p>Suppose you need to want to get a list of all users whose username begins with &#8220;a&#8221;.
There are a couple ways to do this, but one method might be to use some SQL functions
like <tt class="docutils literal"><span class="pre">LOWER</span></tt> and <tt class="docutils literal"><span class="pre">SUBSTR</span></tt>.  To use arbitrary SQL functions, use the special <tt class="xref py py-class docutils literal"><span class="pre">R</span></tt>
object to construct queries:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># select the users&#39; id, username and the first letter of their username, lower-cased</span>
<span class="n">query</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;username&#39;</span><span class="p">,</span> <span class="n">R</span><span class="p">(</span><span class="s">&#39;LOWER(SUBSTR(username, 1, 1))&#39;</span><span class="p">,</span> <span class="s">&#39;first_letter&#39;</span><span class="p">)])</span>

<span class="c"># now filter this list to include only users whose username begins with &quot;a&quot;</span>
<span class="n">a_users</span> <span class="o">=</span> <span class="n">query</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="s">&#39;first_letter=</span><span class="si">%s</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">))</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">a_users</span><span class="p">:</span>
<span class="o">...</span>    <span class="k">print</span> <span class="n">user</span><span class="o">.</span><span class="n">first_letter</span><span class="p">,</span> <span class="n">user</span><span class="o">.</span><span class="n">username</span>
</pre></div>
</div>
<p>This same functionality could be easily exposed as part of the where clause, the
only difference being that the first letter is not selected and therefore not an
attribute of the model instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">a_users</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">R</span><span class="p">(</span><span class="s">&#39;LOWER(SUBSTR(username, 1, 1)) = </span><span class="si">%s</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;a&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We can write subqueries as part of a <a class="reference internal" href="querying.html#SelectQuery" title="SelectQuery"><tt class="xref py py-class docutils literal"><span class="pre">SelectQuery</span></tt></a>, for example counting
the number of entries on a blog:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">entry_query</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="s">&#39;(SELECT COUNT(*) FROM entry WHERE entry.blog_id=blog.id)&#39;</span><span class="p">,</span> <span class="s">&#39;entry_count&#39;</span><span class="p">)</span>
<span class="n">blogs</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">select</span><span class="p">([</span><span class="s">&#39;id&#39;</span><span class="p">,</span> <span class="s">&#39;name&#39;</span><span class="p">,</span> <span class="n">entry_query</span><span class="p">])</span><span class="o">.</span><span class="n">order_by</span><span class="p">((</span><span class="s">&#39;entry_count&#39;</span><span class="p">,</span> <span class="s">&#39;desc&#39;</span><span class="p">))</span>

<span class="k">for</span> <span class="n">blog</span> <span class="ow">in</span> <span class="n">blogs</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">blog</span><span class="o">.</span><span class="n">title</span><span class="p">,</span> <span class="n">blog</span><span class="o">.</span><span class="n">entry_count</span>
</pre></div>
</div>
<p>It is also possible to use subqueries as part of a where clause, for example finding
blogs that have no entries:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">no_entry_query</span> <span class="o">=</span> <span class="n">R</span><span class="p">(</span><span class="s">&#39;NOT EXISTS (SELECT * FROM entry WHERE entry.blog_id=blog.id)&#39;</span><span class="p">)</span>
<span class="n">blogs</span> <span class="o">=</span> <span class="n">Blog</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">no_entry_query</span><span class="p">)</span>

<span class="k">for</span> <span class="n">blog</span> <span class="ow">in</span> <span class="n">blogs</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">blog</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s">&#39; has no entries&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="working-with-transactions">
<span id="id2"></span><h2>Working with transactions<a class="headerlink" href="#working-with-transactions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="context-manager">
<h3>Context manager<a class="headerlink" href="#context-manager" title="Permalink to this headline">¶</a></h3>
<p>You can execute queries within a transaction using the <tt class="docutils literal"><span class="pre">transaction</span></tt> context manager,
which will issue a commit if all goes well, or a rollback if an exception is raised:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;:memory:&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">db</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
    <span class="n">blog</span><span class="o">.</span><span class="n">delete_instance</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># delete blog and associated entries</span>
</pre></div>
</div>
</div>
<div class="section" id="decorator">
<h3>Decorator<a class="headerlink" href="#decorator" title="Permalink to this headline">¶</a></h3>
<p>Similar to the context manager, you can decorate functions with the <tt class="docutils literal"><span class="pre">commit_on_success</span></tt>
decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;:memory:&#39;</span><span class="p">)</span>

<span class="nd">@db.commit_on_success</span>
<span class="k">def</span> <span class="nf">delete_blog</span><span class="p">(</span><span class="n">blog</span><span class="p">):</span>
    <span class="n">blog</span><span class="o">.</span><span class="n">delete_instance</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="changing-autocommit-behavior">
<h3>Changing autocommit behavior<a class="headerlink" href="#changing-autocommit-behavior" title="Permalink to this headline">¶</a></h3>
<p>By default, databases are initialized with <tt class="docutils literal"><span class="pre">autocommit=True</span></tt>, you can turn this
on and off at runtime if you like.  The behavior below is roughly the same as the
context manager and decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">db</span><span class="o">.</span><span class="n">set_autocommit</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">blog</span><span class="o">.</span><span class="n">delete_instance</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">db</span><span class="o">.</span><span class="n">rollback</span><span class="p">()</span>
    <span class="k">raise</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">db</span><span class="o">.</span><span class="n">set_autocommit</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>If you would like to manually control <em>every</em> transaction, simply turn autocommit
off when instantiating your database:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">db</span> <span class="o">=</span> <span class="n">SqliteDatabase</span><span class="p">(</span><span class="s">&#39;:memory:&#39;</span><span class="p">,</span> <span class="n">autocommit</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="n">Blog</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&#39;foo blog&#39;</span><span class="p">)</span>
<span class="n">db</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="non-integer-primary-keys-and-other-tricks">
<span id="non-integer-primary-keys"></span><h2>Non-integer Primary Keys and other Tricks<a class="headerlink" href="#non-integer-primary-keys-and-other-tricks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>Non-integer primary keys<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>If you would like use a non-integer primary key (which I generally don&#8217;t recommend),
you can override the default <tt class="docutils literal"><span class="pre">column_class</span></tt> of the <a class="reference internal" href="fields.html#PrimaryKeyField" title="PrimaryKeyField"><tt class="xref py py-class docutils literal"><span class="pre">PrimaryKeyField</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">peewee</span> <span class="kn">import</span> <span class="n">Model</span><span class="p">,</span> <span class="n">PrimaryKeyField</span><span class="p">,</span> <span class="n">VarCharColumn</span>

<span class="k">class</span> <span class="nc">UUIDModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
    <span class="c"># explicitly declare a primary key field, and specify the class to use</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">PrimaryKeyField</span><span class="p">(</span><span class="n">column_class</span><span class="o">=</span><span class="n">VarCharColumn</span><span class="p">)</span>


<span class="n">inst</span> <span class="o">=</span> <span class="n">UUIDModel</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()))</span>
<span class="n">inst</span><span class="o">.</span><span class="n">save</span><span class="p">()</span> <span class="c"># &lt;-- WRONG!!  this will try to do an update</span>

<span class="n">inst</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">force_insert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># &lt;-- CORRECT</span>

<span class="c"># to update the instance after it has been saved once</span>
<span class="n">inst</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Any foreign keys to a model with a non-integer primary key will have the
<tt class="docutils literal"><span class="pre">ForeignKeyField</span></tt> use the same underlying column type as the primary key
they are related to.</p>
</div>
<p>See full documentation on <a class="reference internal" href="fields.html#non-int-pks"><em>non-integer primary keys</em></a>.</p>
</div>
<div class="section" id="bulk-loading-data-or-manually-specifying-primary-keys">
<h3>Bulk loading data or manually specifying primary keys<a class="headerlink" href="#bulk-loading-data-or-manually-specifying-primary-keys" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you do not want the database to automatically generate a primary key,
for instance when bulk loading relational data.  To handle this on a &#8220;one-off&#8221;
basis, you can simply tell peewee to turn off <tt class="docutils literal"><span class="pre">auto_increment</span></tt> during the
import:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">load_user_csv</span><span class="p">()</span> <span class="c"># load up a bunch of data</span>

<span class="n">User</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">auto_increment</span> <span class="o">=</span> <span class="bp">False</span> <span class="c"># turn off auto incrementing IDs</span>
<span class="k">with</span> <span class="n">db</span><span class="o">.</span><span class="n">transaction</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">username</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">email</span><span class="o">=</span><span class="n">row</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">u</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">force_insert</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span> <span class="c"># &lt;-- force peewee to insert row</span>

<span class="n">User</span><span class="o">.</span><span class="n">_meta</span><span class="o">.</span><span class="n">auto_increment</span> <span class="o">=</span> <span class="bp">True</span>
</pre></div>
</div>
<p>If you <em>always</em> want to have control over the primary key, you can use a different
<tt class="docutils literal"><span class="pre">column_class</span></tt> with the <a class="reference internal" href="fields.html#PrimaryKeyField" title="PrimaryKeyField"><tt class="xref py py-class docutils literal"><span class="pre">PrimaryKeyField</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">User</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">PrimaryKeyField</span><span class="p">(</span><span class="n">column_class</span><span class="o">=</span><span class="n">IntegerColumn</span><span class="p">)</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">CharField</span><span class="p">()</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">username</span><span class="o">=</span><span class="s">&#39;somebody&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">u</span><span class="o">.</span><span class="n">id</span>
<span class="mi">999</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">User</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s">&#39;somebody&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">id</span>
<span class="mi">999</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="introspecting-databases">
<h2>Introspecting databases<a class="headerlink" href="#introspecting-databases" title="Permalink to this headline">¶</a></h2>
<p>If you&#8217;d like to generate some models for an existing database, you can try
out the database introspection tool &#8220;pwiz&#8221; that comes with peewee.</p>
<p>Usage:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">python pwiz.py my_postgresql_database</span>
</pre></div>
</div>
<p>It works with postgresql, mysql and sqlite:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">python pwiz.py test.db --engine=sqlite</span>
</pre></div>
</div>
<p>pwiz will generate code for:</p>
<ul class="simple">
<li>database connection object</li>
<li>a base model class to use this connection</li>
<li>models that were introspected from the database tables</li>
</ul>
<p>The generated code is written to stdout.</p>
</div>
<div class="section" id="schema-migrations">
<h2>Schema migrations<a class="headerlink" href="#schema-migrations" title="Permalink to this headline">¶</a></h2>
<p>Currently peewee does not have support for automatic schema migrations. Peewee
does, however, come with a few helper functions:</p>
<ul class="simple">
<li><a class="reference internal" href="database.html#Database.add_column_sql" title="Database.add_column_sql"><tt class="xref py py-meth docutils literal"><span class="pre">Database.add_column_sql()</span></tt></a></li>
<li><a class="reference internal" href="database.html#Database.rename_column_sql" title="Database.rename_column_sql"><tt class="xref py py-meth docutils literal"><span class="pre">Database.rename_column_sql()</span></tt></a></li>
<li><a class="reference internal" href="database.html#Database.drop_column_sql" title="Database.drop_column_sql"><tt class="xref py py-meth docutils literal"><span class="pre">Database.drop_column_sql()</span></tt></a></li>
</ul>
<p>Honestly, your best bet is to script any migrations and use plain ol&#8217; SQL.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Peewee Cookbook</a><ul>
<li><a class="reference internal" href="#database-and-connection-recipes">Database and Connection Recipes</a><ul>
<li><a class="reference internal" href="#creating-a-database-connection-and-tables">Creating a database connection and tables</a></li>
<li><a class="reference internal" href="#using-with-postgresql">Using with Postgresql</a></li>
<li><a class="reference internal" href="#using-with-mysql">Using with MySQL</a></li>
<li><a class="reference internal" href="#multi-threaded-applications">Multi-threaded applications</a></li>
<li><a class="reference internal" href="#deferring-initialization">Deferring initialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-reading-updating-and-deleting">Creating, Reading, Updating and Deleting</a><ul>
<li><a class="reference internal" href="#creating-a-new-record">Creating a new record</a></li>
<li><a class="reference internal" href="#updating-existing-records">Updating existing records</a></li>
<li><a class="reference internal" href="#deleting-a-record">Deleting a record</a></li>
<li><a class="reference internal" href="#selecting-a-single-record">Selecting a single record</a></li>
<li><a class="reference internal" href="#selecting-multiple-records">Selecting multiple records</a></li>
<li><a class="reference internal" href="#filtering-records">Filtering records</a></li>
<li><a class="reference internal" href="#sorting-records">Sorting records</a></li>
<li><a class="reference internal" href="#paginating-records">Paginating records</a></li>
<li><a class="reference internal" href="#counting-records">Counting records</a></li>
<li><a class="reference internal" href="#iterating-over-lots-of-rows">Iterating over lots of rows</a></li>
<li><a class="reference internal" href="#performing-atomic-updates">Performing atomic updates</a></li>
<li><a class="reference internal" href="#aggregating-records">Aggregating records</a></li>
<li><a class="reference internal" href="#sql-functions-subqueries-and-raw-expressions">SQL Functions, Subqueries and &#8220;Raw expressions&#8221;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-transactions">Working with transactions</a><ul>
<li><a class="reference internal" href="#context-manager">Context manager</a></li>
<li><a class="reference internal" href="#decorator">Decorator</a></li>
<li><a class="reference internal" href="#changing-autocommit-behavior">Changing autocommit behavior</a></li>
</ul>
</li>
<li><a class="reference internal" href="#non-integer-primary-keys-and-other-tricks">Non-integer Primary Keys and other Tricks</a><ul>
<li><a class="reference internal" href="#id3">Non-integer primary keys</a></li>
<li><a class="reference internal" href="#bulk-loading-data-or-manually-specifying-primary-keys">Bulk loading data or manually specifying primary keys</a></li>
</ul>
</li>
<li><a class="reference internal" href="#introspecting-databases">Introspecting databases</a></li>
<li><a class="reference internal" href="#schema-migrations">Schema migrations</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation.html"
                        title="previous chapter">Installing peewee</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="example.html"
                        title="next chapter">Example app</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/peewee/cookbook.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="example.html" title="Example app"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installing peewee"
             >previous</a> |</li>
        <li><a href="../index.html">peewee 1.0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright charles leifer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>