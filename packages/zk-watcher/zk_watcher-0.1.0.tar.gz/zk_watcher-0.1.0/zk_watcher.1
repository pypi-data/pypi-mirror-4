.\" Man page generated from reStructeredText.
.
.TH ZK_WATCHER 1 "2012-10-26" "0.1.0" ""
.SH NAME
zk_watcher \- zk_watcher is a Python script that handles registration with an Apache ZooKeeper service.
.
.nr rst2man-indent-level 0
.
.de1 rstReportMargin
\\$1 \\n[an-margin]
level \\n[rst2man-indent-level]
level margin: \\n[rst2man-indent\\n[rst2man-indent-level]]
-
\\n[rst2man-indent0]
\\n[rst2man-indent1]
\\n[rst2man-indent2]
..
.de1 INDENT
.\" .rstReportMargin pre:
. RS \\$1
. nr rst2man-indent\\n[rst2man-indent-level] \\n[an-margin]
. nr rst2man-indent-level +1
.\" .rstReportMargin post:
..
.de UNINDENT
. RE
.\" indent \\n[an-margin]
.\" old: \\n[rst2man-indent\\n[rst2man-indent-level]]
.nr rst2man-indent-level -1
.\" new: \\n[rst2man-indent\\n[rst2man-indent-level]]
.in \\n[rst2man-indent\\n[rst2man-indent-level]]u
..
.SH SYNOPSIS
.nf
\fIzk_watcher\fP start [<start options>]
\fIzk_watcher\fP stop
\fIzk_watcher\fP restart
\fIzk_watcher\fP \-\-help
.fi
.sp
.SH DESCRIPTION
.sp
The goal of \fIzk_watcher\fP is to monitor a particular service on a host machine
and register that machine as a \fIprovider\fP of that service at a given path
on the ZooKeeper service.
.sp
A simple example is having \fIzk_watcher\fP monitor Apache httpd by running \fIservice
apache2 status\fP at a regular interval and registers with ZooKeeper at a given
path (say \fI/services/production/webservers\fP). As long as the command returns
a safe exit code (\fI0\fP), \fIzk_watcher\fP will register with ZooKeeper that this
server is providing this particular service. If the hostname of the machine
is \fIweb1.mydomain.com\fP, the registration path would look like this
.sp
.nf
.ft C
/services/production/webservers/web1.mydomain.com:80

In the event that the service check fails, the host will be immediately de\-
registered from that path.
.ft P
.fi
.SH USAGE
.sp
zk_watcher start [\-v|\-\-verbose] [\-c|\-\-config=] [\-s|\-\-server=] [\-f|\-\-foreground]
.sp
zk_watcher stop
.INDENT 0.0
.INDENT 3.5
Stops the existing \fIzk_watcher\fP daemon based on its PID in /var/run/zk_watcher.pid.
.UNINDENT
.UNINDENT
.sp
zk_watcher restart
.INDENT 0.0
.INDENT 3.5
Stops, and then starts the \fIzk_watcher\fP daemon based on its PID in /var/run/zk_watcher.pid.
.UNINDENT
.UNINDENT
.SH OPTIONS
.INDENT 0.0
.TP
.B \-v,  \-\-verbose
Enables verbose logging
.TP
.B \-f,  \-\-foreground
Runs the daemon in foreground mode
.TP
.BI \-c,  \-\-config\fB= <config file>
Overrides the default config file location (/etc/zk/config.cfg)
.TP
.BI \-s,  \-\-server\fB= <server:port>
Overrides the default ZooKeeper address (localhost:2181)
.UNINDENT
.SH AUTHOR
Matt Wise <matt@nextdoor.com>
.\" Generated by docutils manpage writer.
.\" 
.
