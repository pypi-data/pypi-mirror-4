<tal:comment condition="nothing">
<!--
Full portal_relations macro

Usage:

  <metal:macro use-macro="here/eea_relateditems/macros/relatedItemsWithThumbs" />

-->
</tal:comment>
<div metal:define-macro="relatedItemsWithThumbs" id="relatedItems" tal:define="
  relations nocall:here/@@eea.relations.macro;
  auto_relations nocall:here/@@auto-relations.html;
  thumb_scale thumb_scale | string:image_thumb;">
  <tal:backward tal:define="tabs python:relations.backward();" tal:condition="tabs">
    <!-- Backward relations -->
    <div class="visualNoMarker">
      <tal:tab repeat="tab tabs">
        <tal:def define="label python:tab[0]; related python:tab[1]"
          tal:condition="related">
          <h3 tal:content="label">Relation label</h3>
          <div metal:use-macro="here/eea_relateditems/macros/relatedItems" />
        </tal:def>
      </tal:tab>
    </div>
  </tal:backward>

  <tal:forward define="tabs python:relations.forward()" tal:condition="tabs">
    <!-- Forward relations -->
    <div class="visualNoMarker">
      <tal:tab repeat="tab tabs">
        <tal:def define="label python:tab[0]; related python:tab[1]"
          tal:condition="related">
          <h3 tal:content="label">Relation label</h3>
          <div metal:use-macro="here/eea_relateditems/macros/relatedItems" />
        </tal:def>
      </tal:tab>
    </div>
  </tal:forward>

  <tal:auto define="tabs python:auto_relations.tabs">
    <!-- Auto relations -->
    <div class="visualNoMarker">
      <tal:tab repeat="tab tabs">
        <tal:def define="label python:tab[0]; related python:tab[1]">
          <h3 tal:content="label">Relation label</h3>
          <div metal:use-macro="here/eea_relateditems/macros/relatedItems" />
        </tal:def>
      </tal:tab>
    </div>
  </tal:auto>
</div>



<tal:comment condition="nothing">
<!--
Generic macro for relatedItmes (use relatedItemsWithThumbs for full relations)

Macro parameters

  @param related (required) - a set of objects

Usage:

  <metal:macro use-macro="here/eea_relateditems/macros/relatedItems" />

-->
</tal:comment>
<div metal:define-macro="relatedItems"
     tal:define="related related | python:[];
                 thumb_scale thumb_scale | string:image_thumb;"
  tal:condition="related">
  <tal:related tal:repeat="item related">
    <div class="tileItem visualIEFloatFix vevent" tal:define="
      item item/getObject|nocall:item;
      title item/Title;
      description item/Description;
      urlview item/@@url;
      img_url item/absolute_url;
      url urlview/listing_url;
      interfaces python:item.restrictedTraverse('@@get_interfaces')(); 
      is_video python:'eea.mediacentre.interfaces.IVideo' in interfaces;
      css_class python: 'video-fancybox' if is_video else '';
      ">
      <a class="tileImage"
        tal:attributes="href url; title title; alt title;
          class python:'video-fancybox tileImage' if is_video else 'tileImage'">
        <img tal:attributes="src python:'%s/%s' % (img_url,thumb_scale);
          title title; alt title;" />
      </a>

      <h3 class="tileHeadline">
        <a tal:attributes="href  url; title description; class css_class" tal:content="title">
          Related Item
        </a>
      </h3>
      <p class="tileFooter">
        <a class="moreLink" tal:attributes="href url; title title;"
          i18n:translate="">
          Read more
        </a>
      </p>

      <div class="visualClear"></div>
    </div>
  </tal:related>
</div>
