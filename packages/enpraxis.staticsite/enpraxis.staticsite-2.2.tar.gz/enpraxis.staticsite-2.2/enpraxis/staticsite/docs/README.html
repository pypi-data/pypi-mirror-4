<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.5: http://docutils.sourceforge.net/" />
<title></title>
<style type="text/css">

/*
:Author: David Goodger
:Contact: goodger@users.sourceforge.net
:Date: $Date: 2005-09-23 15:58:00 -0600 (Fri, 23 Sep 2005) $
:Revision: $Revision: 1964 $
:Copyright: This stylesheet has been placed in the public domain.
t
Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* "! important" is used here to override other ``margin-top`` and
   ``margin-bottom`` styles that are later in the stylesheet or 
   more specific.  See http://www.w3.org/TR/CSS1#the-cascade */

body {
 
  background: #173682;
  font-size: .9em;
  text-align:center;
  font-family: Arial, Helvetica, sans-serif;
  margin: 0;
  padding:0;
}

.document {
  width: 960px;
  margin:0 auto;
  padding: 0 5px 0 5px;
  color: #666;
  border: 1px solid black;
  text-align: left;
  background: #E8E8E8;  
}

.document h1 {
  padding: 0;
}

.document a:link, .document a:visited, .document a:hover, .document a:active {
  color: #CC6600;
}

.first {
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
   }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
   }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em }

div.header {
  clear: both;
  font-size: smaller;
  text-align: center;
  
}

div.footer {
  clear: both;
  font-size: smaller;
  text-align: center;
  padding-top: 5px;

}

hr.footer {
  display: none;
}





div.footer a {
  color: #fff;
  text-decoration: underline;
}

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin-left: 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
   ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1, h2, h3, h4, h5, h6 {
  font-size: 1em;
}

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1 {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left {
  clear: left }

img.align-right {
  clear: right }

img.borderless {
  border: 0 }

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
   ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
   ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font-family: serif ;
  font-size: 100% }

pre.line-block {
  font-family: serif ;
  font-size: 100% }

pre.literal-block, pre.doctest-block {
  margin-left: 2em ;
  margin-right: 2em ;
  padding: 5px;
  background-color: #D3D3D3;;
  color: black;
   }

span.classifier {
   ;
  font-style: oblique }

span.classifier-delimiter {
   ;
  font-weight: bold }

span.interpreted {
   }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid thin gray }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid thin black }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

tt.docutils {
  background-color: #eeeeee }

ul.auto-toc {
  list-style-type: none }
  
.reference {
  color: #FFF;
}


h1 {
    border-bottom: 1px solid #173682;;
}

h2 {
    border-bottom: 1px dashed #173682;
}

blockquote { 
    background: #D3D3D3;
    border: 1px solid black;
    padding: 0 5px;
}

img {
    border: 1px solid black;
    vertical-align:text-top;
}



</style>
</head>
<body>
<div class="document">


<div class="section" id="staticsite-utility">
<h1>StaticSite Utility</h1>
<p>StaticSite is a Plone Add-on designed to deploy a static version of your plone site to the filesystem.  There are many configuration options available for StaticSite, which should be reviewed before deploying a static site.</p>
<div class="section" id="control-panel">
<h2>Control Panel</h2>
<p>The StaticSite control panel is available for the Site Setup link, underneath the Add-on Product Configuration</p>
<img alt="StaticSite Add-on Product Configuration" src="images/site_setup.png" />
</div>
<div class="section" id="deployment-path-and-url">
<h2>Deployment Path and URL</h2>
<img alt="Deployment Path and URL" src="images/deployment.png" />
<p>The <em>Deployment Path</em> defines the root folder on the filesystem to which files will be written. The base folder will always be defined by where the Data.fs is stored within your instance.  The <em>Deployment Path</em> is appended to that path.</p>
<p>For instance:</p>
<blockquote>
<p>Data.fs path :: /path/to/your/instance/var/Data.fs</p>
<p>Static Site path :: /path/to/your/instance/var/static</p>
</blockquote>
<p>The <em>Deployment URL</em> defines the base url for the static site. You will need to configure Apache accordingly. This value is utilized in the document filters, which rewrite relative and absolute paths appropriately.</p>
</div>
<div class="section" id="base-files">
<h2>Base Files</h2>
<p><em>Base Files</em> are typically resources that are acquired by acquisition in Plone.  These resources are written to the root of your static site deployment, and referenced accordingly.  You may add and remove <em>Base Files</em> as needed.</p>
<img alt="Base Files" src="images/base1.png" />
<img alt="Base Files" src="images/base2.png" />
</div>
<div class="section" id="css-images">
<h2>CSS Images</h2>
<p><em>CSS Images</em> are images utilized in customized themes. These images are written to the deployment path of the CSS resources on the filesystem.  If you are utilizing anything but a custom logo, you must add the files to the <em>CSS Images</em> field.</p>
<img alt="CSS Images" src="images/css.png" />
</div>
<div class="section" id="add-states">
<h2>Add States</h2>
<p>By default, only content in the <em>published</em> state is deployed to the filesystem.  If your instance utilizes other states that are visible to the public, you may add that state to the <em>Add States</em> field.</p>
<img alt="Add States" src="images/states.png" />
</div>
<div class="section" id="ignored-actions-and-document-sections">
<h2>Ignored Actions and Document Sections</h2>
<p>Static site deploys a version to the filesystem that is purely .html driven.  Therefore, certain sections and actions that are driven by dynamic functionality must be removed from each deployed page.</p>
<img alt="Ignored Actions and Document Sections" src="images/ignored.png" />
</div>
<div class="section" id="ignored-portlets">
<h2>Ignored Portlets</h2>
<p>Many portlets rely on dynamic content/interactivity. Static site will extract portlets defined below.</p>
<img alt="Ignored Portlets" src="images/portlets.png" />
</div>
<div class="section" id="additional-views-and-non-html-views">
<h2>Additional Views and Non HTML views</h2>
<p><em>Additional Views</em> can be defined for:</p>
<ul class="simple">
<li>'single-object-like' views - accessibility-info, for example</li>
<li>views over content objects - presentation_view, for example</li>
</ul>
<p>For views that are not based on HTML, you may define them as <em>Non HTML Views</em>. This will allow XML and other non-html views to be deployed properly.</p>
<img alt="Views" src="images/views.png" />
</div>
</div>
<div class="section" id="extending-functionality">
<h1>Extending Functionality</h1>
<p>If you do choose to add additional views, you will likely need to extend the functionality of the utility to account for these views. You may do this by customizing the default code, or overwriting the utility in a separate product:</p>
<pre class="literal-block">
&lt;utility
    provides=&quot;enpraxis.staticsite.utilities.interfaces.IStaticSiteUtility&quot;
    factory=&quot;.utilities.staticsiteutility.eduStaticSiteUtility&quot;
/&gt;
</pre>
<p>The filtering mechanism utilizes <a class="reference external" href="http://www.crummy.com/software/BeautifulSoup/documentation.html">BeautifulSoup</a> to parse the HTML of each static object. Typically, additionally filters will be added to runDocumentFilters to account for additional/custom views. For example, the Add-on product PloneBookmarklets renders links that must be dealt with differently than other document actions:</p>
<pre class="literal-block">
class eduStaticSiteUtility(StaticSiteUtility):
          &quot;&quot;&quot; Deploy a static site &quot;&quot;&quot;

          implements(IStaticSiteUtility)

          def runDocumentFilters(self, portal, current, soup, ssprops):
              self.filterBaseTag(soup, current)
              ...
              ...
              self.filterBookmarkletsLinks(soup, current, portal, ssprops)
        ...

    ...
    ...

          def filterBookmarkletsLinks(self, soup, current, portal, ssprops):
              bookmarks = soup.find('span', id=&quot;toggledBookmarks&quot;)
              if bookmarks:
                  links = bookmarks.findAll('a')
                  for link in links:
                      href = link['href']
                      parts = href.split('=')
                      index = 0
                      for part in parts:
                          if portal.portal_url() in part:
                              url_parts = part.split('&amp;')
                              if len(url_parts) &gt; 0:
                                  if '.htm' not in current:
                                      current += '.html'
                                  url_parts[0] = current
                                  newurl = '&amp;'.join(url_parts)
                              else:
                                  newurl = current
                              parts[index] = newurl
                          index += 1
                      newurl = '='.join(parts)
                      newurl = newurl.replace(portal.portal_url(), ssprops.getProperty('deployment_url'))
                      link['href'] = newurl
</pre>
</div>
<div class="section" id="deploying-a-static-site">
<h1>Deploying a Static Site</h1>
<p>To deploy a static version of your plone instance, navigate to the <em>deploy</em> action in the upper right hand corner.</p>
<img alt="Deploy Static Site" src="images/deploy.png" />
<p>Press the <em>Deploy Site</em> button to being the process of generating a static site.  Be patient, as this may take quite some time for large instances.</p>
<img alt="Deploy Static Site" src="images/deploy2.png" />
</div>
</div>
</body>
</html>
