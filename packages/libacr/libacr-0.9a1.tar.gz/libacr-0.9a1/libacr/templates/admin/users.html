<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude">

  <xi:include href="admin_master.html" />

<head>
  <meta content="text/html; charset=UTF-8" http-equiv="content-type" py:replace="''"/>
  <title>ACR Administration Section</title>
  <style>
    #create_form {
        width: 300px;
    }
    
    #create_form form {
        margin: 10px;
    }
    
    #user_list {
        width: 95%;
        margin-left: auto;
        margin-right: auto;
        font-size: 13px;
    }
    
    #user_list th {
        background-color: #EEEEEE;
    }
    
    #user_list tr {
        background-color: #F5F5F5;
        text-align: center;
    }
    #submit_permission{
        width: 70px
    }
    #text_permission{
        width: 100px
    }
  </style>
</head>

<body>
    <div class="toolbar">
        <a href="#add_user" class="objects_list_entry">Add User</a>
        <a href="#manage_users" class="objects_list_entry">Manage Users</a>
    </div>

    <div class="section_box" id="add_user">  
        <h1 class="title">Add User</h1>
        <div id="create_form" class="section_icons">
            ${create_form(value={}, action=h.acr_url('/admin/add_user'))}
        </div>
    </div>
    
    <div class="section_box" id="manage_users">    
        <h1 class="title">Users</h1>
        <span py:if="len(users)!=0">
        <table id="user_list" class="section_icons">
            <tr>
                <th>Action</th>
                <th>User Name</th>
                <th>Email Address</th>
                <th>Display Name</th>
                <th>Created</th>
                <th>Can Edit</th>
                <th>Can Create Children</th>
                <th>Page</th>
                <th>Permission</th>
            </tr>
            <tr py:for="c, user in enumerate(users)" class="${c % 2 and 'even' or 'odd'}">
                <form action="${h.acr_url('/admin/update_user')}" method="GET" >
                <td style="width: 1em;">
                    <a href="${h.acr_url('/admin/deleteUserPermission',permission_id=user.permission_id)}" 
                       style="background-image:url(${h.icons['create_page'].link});">
                       <span>X</span>
                    </a>
                </td>
                <td style="width: 1em;">${user.user.user_name}</td>
                <td style="width: 1em;">${user.user.email_address}</td>
                <td style="width: 5em;">${user.user.display_name}</td>
                <td style="width: 5em;">${user.user.created}</td>
                <td style="width: 5em;">
                    <span py:if="user.can_edit==1"><input type="checkbox" name="can_edit" checked="checked" /></span>
                    <span py:if="user.can_edit==0"><input type="checkbox" name="can_edit" /></span>  
                </td>
                <td style="width: 5em;">
                    <span py:if="user.can_create_children==1"><input type="checkbox" name="can_create_children" checked="checked" /></span>
                    <span py:if="user.can_create_children==0"><input type="checkbox" name="can_create_children" /></span>
                </td>
                <td style="width: 5em;">
                    <input type="text" id="text_permission" name="uri" value='${user.page}'/>
                </td>
                <td style="width: 5em;">
                    <input type="hidden" name="permission_id" value="${user.permission_id}"/>
                    <input type="submit" id="submit_permission" value="Update" />
                </td>
                </form>
            </tr>
        </table>
        </span>
    </div>
</body>
</html>