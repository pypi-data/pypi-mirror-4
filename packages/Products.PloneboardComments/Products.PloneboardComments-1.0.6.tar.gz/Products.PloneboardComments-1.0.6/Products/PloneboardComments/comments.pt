<tal:block define="userHasReplyPermission view/can_reply;
                   isDiscussionAllowed view/is_discussion_allowed;
                   isAnon view/is_anonymous;
		   pbc_installed python:hasattr(context, 'ploneboard_comments_get_conversation');
		   pbc_configured python:hasattr(context, 'ploneboard_comments_');
		   conversation python:pbc_installed and pbc_configured and context.ploneboard_comments_get_conversation()"
           i18n:domain="PloneboardComments" xmlns:i18n="http://xml.zope.org/namespaces/i18n">
	   <!-- Comments active -->
    <div class="discussion">
	 <a tal:condition="python:(pbc_installed and pbc_configured) and conversation" href="#" tal:attributes="href conversation/absolute_url"><span i18n:translate="">There is a conversation about this piece here and it has</span> <span tal:replace="python:conversation.getNumberOfComments() - 1"></span> <span i18n:translate="">comment(s)</span>.</a>

	 <a tal:condition="python:((pbc_installed and pbc_configured) and not conversation) and (userHasReplyPermission and isDiscussionAllowed)" href="#" tal:attributes="href string:${context/ploneboard_comments_create_conversation_url}" i18n:translate="">Start a conversation about this piece.</a>

	 <span tal:condition="not:pbc_installed">PloneboardComments not installed (install in plone_control_panel as Administrator).</span>	 

	 <span tal:condition="not:pbc_configured">PloneboardComments instance not configured in context.</span>	 
</div>
</tal:block>
