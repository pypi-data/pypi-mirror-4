

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Quick Start &mdash; Vakhshour 0.94.45 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.94.45',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Vakhshour 0.94.45 documentation" href="index.html" />
    <link rel="next" title="Configuration" href="configuration.html" />
    <link rel="prev" title="Welcome to Vakhshour’s documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Vakhshour’s documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Vakhshour 0.94.45 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="quick-start">
<span id="quick-guide"></span><h1>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h1>
<p>In this guide you will learn how to use Vakhshour event passing platform as fast as possible.</p>
<div class="section" id="vakhshour-installation">
<h2>Vakhshour Installation<a class="headerlink" href="#vakhshour-installation" title="Permalink to this headline">¶</a></h2>
<p>Installing <strong>Vakhshour</strong> is easy, but before installing <strong>Vakhshour</strong> you have to install its dependencies.
<strong>Vakhshour</strong> have three dependencies that you can install them using <tt class="docutils literal"><span class="pre">pip</span></tt> or <tt class="docutils literal"><span class="pre">easy_install</span></tt> utilities.</p>
<p>Install dependencies just like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># easy_install twisted pyopenssl pycrypto</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># pip install twisted pyopenssl pycrypto</span>
</pre></div>
</div>
<p>Now its time to install <strong>Vakhshour</strong> itself:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># easy_install vakhshour</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># pip install vakhshour</span>
</pre></div>
</div>
<p>Of course you can install dependecies using your distribution package manager.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some of <strong>Vakhshour</strong> dependencies have their own dependencies that you should take care of.</p>
</div>
</div>
<div class="section" id="running-vakhshour-daemon">
<h2>Running Vakhshour daemon<a class="headerlink" href="#running-vakhshour-daemon" title="Permalink to this headline">¶</a></h2>
<p>For using <strong>Vakhshour</strong> you need to run its daemon first (daemon is not a good word for this). <strong>Vakhshour</strong> daemon
is responsible for dispatching events. <tt class="docutils literal"><span class="pre">vakhshourd</span></tt> is the <strong>Vakhshour</strong> daemon. run it like:</p>
<div class="highlight-python"><pre>$ /usr/local/bin/vakhshourd</pre>
</div>
<p><tt class="docutils literal"><span class="pre">vakhshourd</span></tt> use <tt class="docutils literal"><span class="pre">/etc/vakhshour/vakhshour.json</span></tt> as its default configuration file. you can force <tt class="docutils literal"><span class="pre">vakhshourd</span></tt>
to use another configuration file with <tt class="docutils literal"><span class="pre">-c</span></tt> parameter and specify new configuration file path.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For more information about <tt class="docutils literal"><span class="pre">vakhshourd</span></tt> parameters take a look at <tt class="docutils literal"><span class="pre">vakhshourd</span> <span class="pre">--help</span></tt></p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You should us <tt class="docutils literal"><span class="pre">vakhshourd</span></tt> with some utitlies like <tt class="docutils literal"><span class="pre">Systemd</span></tt> or <tt class="docutils literal"><span class="pre">upstart</span></tt> or etc. if you&#8217;re a Debian user, there is a init script.</p>
</div>
</div>
<div class="section" id="sending-events">
<h2>Sending events<a class="headerlink" href="#sending-events" title="Permalink to this headline">¶</a></h2>
<p>After running the daemon, events can be sent using <tt class="docutils literal"><span class="pre">Node</span></tt> class. it lives in <tt class="docutils literal"><span class="pre">vakhshour.base.Node</span></tt>. <tt class="docutils literal"><span class="pre">Node</span></tt> represent a network node that running the <strong>Vakhshour</strong> daemon.
For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">vakhshour.base</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&quot;10.1.1.1&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="s">&quot;8888&quot;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">send_event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="s">&quot;me&quot;</span><span class="p">,</span> <span class="n">first_param</span><span class="o">=</span><span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="n">another_param</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<p>also you can send events in secure mode (using SSL):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">vakhshour.base</span> <span class="kn">import</span> <span class="n">Node</span>

<span class="n">node</span> <span class="o">=</span> <span class="n">Node</span><span class="p">(</span><span class="n">ssl_key</span><span class="o">=</span><span class="s">&quot;/home/lxsameer/src/Vakhshour/keys/test.key&quot;</span><span class="p">,</span>
            <span class="n">ssl_cert</span><span class="o">=</span><span class="s">&quot;/home/lxsameer/src/Vakhshour/keys/test.crt&quot;</span><span class="p">,</span>
            <span class="n">secure</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">send_event</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="n">sender</span><span class="o">=</span><span class="s">&quot;me&quot;</span><span class="p">,</span> <span class="n">first_param</span><span class="o">=</span><span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="n">another_param</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
<p>First example will send a <tt class="docutils literal"><span class="pre">foo</span></tt> event with two parameter that called <tt class="docutils literal"><span class="pre">first_param</span></tt> and <tt class="docutils literal"><span class="pre">another_param</span></tt> to
a <strong>Vakhshour</strong> server on <tt class="docutils literal"><span class="pre">10.1.1.1:8888</span></tt>. Those parameters that send to server will pas to event handler.</p>
<p>Second example is the same as first one but send the event in secure mode using SSL transport. SSL transport use
SSLv3 client authentication to authenticate the client. More information on <a class="reference external" href="http://en.wikipedia.org/wiki/Transport_Layer_Security#Client-authenticated_TLS_handshake">SSLv3 Client Authentication</a>.</p>
</div>
<div class="section" id="receving-events">
<h2>Receving events<a class="headerlink" href="#receving-events" title="Permalink to this headline">¶</a></h2>
<p><strong>Vakhshour</strong> service publish events by sending them via a TCP socket. Each client can subscribe to publisher port and receive the events.
There is a very simple client class in <em>vakhshour/clients.py8</em>.</p>
<p>also <strong>Vakhshour</strong> can dispatch the received events via HTTP protocol as a request. You have to specifiy a list of event receiver web application in <strong>Vakhshour</strong> configuration file. for more information read the configuration section.</p>
</div>
<div class="section" id="vakhshour-and-django">
<h2>Vakhshour and Django<a class="headerlink" href="#vakhshour-and-django" title="Permalink to this headline">¶</a></h2>
<p><strong>Vakhshour</strong> provide a Django application for Django webapplications. This application will receive an event from main daemon and run its handler. It will discover all the registered event handlers inside a project and run each event handler that matched with received event.</p>
<p>At first you should add <em>vakhshour.events</em> in your <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt>. Add the following code snippet in your main <tt class="docutils literal"><span class="pre">urls.py</span></tt> so <strong>Vakhshour</strong> can discover event handlers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">vakhshour.events.discovery</span> <span class="kn">import</span> <span class="n">handler_discovery</span>

<span class="n">handler_discovery</span><span class="p">()</span>
</pre></div>
</div>
<p>now <strong>Vakhshour</strong> will find any <tt class="docutils literal"><span class="pre">events.py</span></tt> module inside your installed app and look for a event handler registeration inside them.</p>
<div class="section" id="event-handlers">
<h3>Event handlers<a class="headerlink" href="#event-handlers" title="Permalink to this headline">¶</a></h3>
<p>Event handler is a subclass of <tt class="docutils literal"><span class="pre">vakhshour.events.EventHandler</span></tt> class and can handle more than one event. An event handler can define some methods
to handle events. each method name should be like <em>on_method_name</em>. below example will show you every thing:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">vakhshour.events</span> <span class="kn">import</span> <span class="n">EventHandler</span><span class="p">,</span> <span class="n">handlers</span>


<span class="k">class</span> <span class="nc">AMHandler</span><span class="p">(</span><span class="n">EventHandler</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">on_foo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">first_param</span><span class="p">,</span> <span class="n">another_param</span><span class="p">):</span>
        <span class="k">print</span> <span class="s">&quot;I received a foo event 1: </span><span class="si">%s</span><span class="s"> 2: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">first_param</span><span class="p">,</span>
                                                      <span class="n">another_param</span><span class="p">)</span>


<span class="n">handlers</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">AMHandler</span><span class="p">())</span>
</pre></div>
</div>
<p>Do you remember the <tt class="docutils literal"><span class="pre">foo</span></tt> event ? The above code runs when the <tt class="docutils literal"><span class="pre">foo</span></tt> events receive. Bear in mind that you should register any event handler using the <strong>handler</strong> object. Also you should register an instance of an event handler not the event handler itself.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Quick Start</a><ul>
<li><a class="reference internal" href="#vakhshour-installation">Vakhshour Installation</a></li>
<li><a class="reference internal" href="#running-vakhshour-daemon">Running Vakhshour daemon</a></li>
<li><a class="reference internal" href="#sending-events">Sending events</a></li>
<li><a class="reference internal" href="#receving-events">Receving events</a></li>
<li><a class="reference internal" href="#vakhshour-and-django">Vakhshour and Django</a><ul>
<li><a class="reference internal" href="#event-handlers">Event handlers</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Vakhshour&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="configuration.html"
                        title="next chapter">Configuration</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/quickstart.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="configuration.html" title="Configuration"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Vakhshour’s documentation!"
             >previous</a> |</li>
        <li><a href="index.html">Vakhshour 0.94.45 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Sameer Rahmani.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>