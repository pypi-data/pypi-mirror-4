

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>featuremonkey Tutorial &mdash; featuremonkey 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="featuremonkey 0.1 documentation" href="index.html" />
    <link rel="next" title="featuremonkey Reference" href="reference.html" />
    <link rel="prev" title="Installation" href="install.html" />
<link href='http://fonts.googleapis.com/css?family=Oswald:400,700,300' rel='stylesheet' type='text/css'></link>
<link href='http://fonts.googleapis.com/css?family=PT+Sans+Narrow:400,700' rel='stylesheet' type='text/css'></link>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="reference.html" title="featuremonkey Reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="install.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">featuremonkey 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="featuremonkey-tutorial">
<h1>featuremonkey Tutorial<a class="headerlink" href="#featuremonkey-tutorial" title="Permalink to this headline">¶</a></h1>
<p>This tutorial is a quick introduction to building SPLs using featuremonkey.
See the reference for in depth discussion.</p>
<div class="section" id="example-product-line">
<h2>Example Product Line<a class="headerlink" href="#example-product-line" title="Permalink to this headline">¶</a></h2>
<p>To get started, we use the well-known Greeter example.
We will build a product line of greeters according to the following feature model:</p>
<p class="graphviz">
<img src="_images/graphviz-ed6e58b2e8c065f881d32c1f3efe7638b62ee243.png" alt="digraph foo {
    graph [bgcolor=&quot;#F8F8F8&quot;];
    node [fontsize=10, shape=box];
    edge [arrowhead=none];

    &quot;TodoMonkey&quot; -&gt; &quot;base&quot; [arrowhead=dot];
    &quot;TodoMonkey&quot; -&gt; &quot;description&quot; [arrowhead=odot];
    &quot;TodoMonkey&quot; -&gt; &quot;filter&quot; [arrowhead=odot];
    &quot;filter&quot; -&gt; &quot;search&quot; [arrowhead=odot];
}" />
</p>
<p class="graphviz">
<img src="_images/graphviz-687010ea308d780f5a9e64a3146f1fe2194643e4.png" alt="digraph foo {
    graph [bgcolor=&quot;#F8F8F8&quot;];
    node [fontsize=10, shape=box];
    edge [arrowhead=none];

    &quot;greeter&quot; -&gt; &quot;base&quot; [arrowhead=dot];
    &quot;greeter&quot; -&gt; &quot;monkey&quot; [arrowhead=odot];
    &quot;greeter&quot; -&gt; &quot;loud&quot; [arrowhead=odot];
    &quot;greeter&quot; -&gt; &quot;uncertain&quot; [arrowhead=odot];
}" />
</p>
<p>The feature model diagram translates roughly to:
A valid greeter product needs to contain the mandatory <tt class="docutils literal"><span class="pre">base</span></tt> feature.
Features <tt class="docutils literal"><span class="pre">monkey</span></tt>, <tt class="docutils literal"><span class="pre">loud</span></tt>, and <tt class="docutils literal"><span class="pre">uncertain</span></tt> are optional(and can also be combined).</p>
<p>Soon, we will be able to compose a basic greeter(<tt class="docutils literal"><span class="pre">base</span></tt>), a greeting monkey(<tt class="docutils literal"><span class="pre">base</span></tt> + <tt class="docutils literal"><span class="pre">monkey</span></tt>),
a loud greeter(<tt class="docutils literal"><span class="pre">base</span></tt> + <tt class="docutils literal"><span class="pre">loud</span></tt>), and even a loud and uncertain greeting monkey by selecting all the features.</p>
</div>
<div class="section" id="base-feature-and-fst">
<h2>Base feature and FST<a class="headerlink" href="#base-feature-and-fst" title="Permalink to this headline">¶</a></h2>
<p>Now, let&#8217;s look at the code. The <tt class="docutils literal"><span class="pre">base</span></tt> feature:</p>
<table class="fmod"><tr><td width="50%"><div class="highlight-python"><div class="highlight"><pre><span class="c">#base.py</span>
<span class="k">def</span> <span class="nf">get_greeting</span><span class="p">():</span>
    <span class="k">return</span> <span class="s">&#39;Hello&#39;</span>

<span class="k">def</span> <span class="nf">greet</span><span class="p">():</span>
    <span class="k">print</span> <span class="n">get_greeting</span><span class="p">()</span>
</pre></div>
</div>
</td><td width="50%"><p class="graphviz">
<img src="_images/graphviz-7595370e5dfea2f209daa470351ad73e3150ddec.png" alt="digraph foo {
     graph [bgcolor=&quot;#F8F8F8&quot;];
     node [fontsize=10];
     edge [arrowhead=none];
     &quot;base:module&quot; -&gt; &quot;get_greeting:function&quot;;
     &quot;base:module&quot; -&gt; &quot;greet:function&quot;;
}" />
</p>
</td></tr></table><p><tt class="docutils literal"><span class="pre">base</span></tt> defines two functions. On the right, the corresponding FST(feature structure tree) is shown.
As you can see, there is nothing special about the base module. Think of its FST as the namespace of the <tt class="docutils literal"><span class="pre">base</span></tt> module.</p>
</div>
<div class="section" id="superimposing-fsts">
<h2>Superimposing FSTs<a class="headerlink" href="#superimposing-fsts" title="Permalink to this headline">¶</a></h2>
<p>Now, we want to tweak the base program a little, because a monkey does not say &#8220;Hello&#8221;.
To change the message, we specify a different kind of FST that we can place on top of the base module.
Let&#8217;s have a look at feature <tt class="docutils literal"><span class="pre">monkey</span></tt>:</p>
<table class="fmod"><tr><td width="50%"><div class="highlight-python"><div class="highlight"><pre><span class="c">#monkey.py</span>
<span class="k">def</span> <span class="nf">refine_get_greeting</span><span class="p">(</span><span class="n">original</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get_greeting</span><span class="p">():</span>
        <span class="k">return</span> <span class="s">&#39;Uga Aga&#39;</span>

    <span class="k">return</span> <span class="n">get_greeting</span>
</pre></div>
</div>
</td><td width="50%"><p class="graphviz">
<img src="_images/graphviz-f6c6c317a89bb85e510a52d51300bfce4cdc31bf.png" alt="digraph foo {
     graph [bgcolor=&quot;#F8F8F8&quot;];
     node [fontsize=10];
     edge [arrowhead=none];
     n1[label=&quot;get_greeting:function2&quot;,style=filled,fillcolor=yellow];
     &quot;monkey:module&quot; -&gt; n1;
}" />
</p>
</td></tr></table><p>Obviously, the FST on the right does not represent the namespace of the <tt class="docutils literal"><span class="pre">monkey</span></tt> module.
FSTs need to be specified in another format to place them on top of other FSTs.
We will refer to these FSTs as <em>superimposing FSTs</em> from now on.</p>
<p>The <tt class="docutils literal"><span class="pre">monkey</span></tt> module will serve as the root node of the FST.
To compose FSTs, featuremonkey inspects the namespace of the superimposing FST and looks for names starting with <tt class="docutils literal"><span class="pre">refine_</span></tt> (and others that are described later on). We will refer to these names as refinements.
Refinement functions accept one parameter called <tt class="docutils literal"><span class="pre">original</span></tt> - a reference to the original implementation that is to be refined. They need to return the refined value for the name.</p>
<p>By defining a <tt class="docutils literal"><span class="pre">refine_get_greeting</span></tt> function, we tell featuremonkey that we want to refine the existing name
<tt class="docutils literal"><span class="pre">get_greeting</span></tt>. Then we define an inner function <tt class="docutils literal"><span class="pre">get_greeting</span></tt> and return it.
This tells featuremonkey that this is the refined implementation for <tt class="docutils literal"><span class="pre">get_greeting</span></tt>.
In the diagram of the FST, <tt class="docutils literal"><span class="pre">get_greeting</span></tt> is highlighted in orange to signify that the node represents a refinement.</p>
</div>
<div class="section" id="product-launchers">
<h2>Product Launchers<a class="headerlink" href="#product-launchers" title="Permalink to this headline">¶</a></h2>
<p>Now, before creating the other features, let us look at how we can create the base and the monkey greeter.
Therefore, we create the following two launchers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#launch_base.py</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">base</span>
    <span class="n">base</span><span class="o">.</span><span class="n">greet</span><span class="p">()</span>
</pre></div>
</div>
<p>When running <tt class="docutils literal"><span class="pre">python</span> <span class="pre">launch_base.py</span></tt> the product containing only the base feature is run.
To run the product also containing the monkey feature, we need to tweak the launcher a little:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#launch_monkey.py</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">base</span>
    <span class="kn">import</span> <span class="nn">monkey</span>
    <span class="n">featuremonkey</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">monkey</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
    <span class="n">base</span><span class="o">.</span><span class="n">greet</span><span class="p">()</span>
</pre></div>
</div>
<p>Here, we also import the monkey module. Then we call <tt class="docutils literal"><span class="pre">featuremonkey.compose</span></tt> to superimpose the the monkey FST on the base FST. Then, as before, we call <tt class="docutils literal"><span class="pre">base.greet()</span></tt>. This time however, we get the modified message, as featuremonkey has
patched the base module to use the implementation of <tt class="docutils literal"><span class="pre">get_greeting</span></tt> given in the monkey feature.</p>
</div>
<div class="section" id="using-original">
<h2>Using <tt class="docutils literal"><span class="pre">original</span></tt><a class="headerlink" href="#using-original" title="Permalink to this headline">¶</a></h2>
<p>Great, now that we know how the features are actually composed, let&#8217;s create the remaining two features starting with feature <tt class="docutils literal"><span class="pre">loud</span></tt>:</p>
<table class="fmod"><tr><td width="50%"><div class="highlight-python"><div class="highlight"><pre><span class="c">#loud.py</span>
<span class="k">def</span> <span class="nf">refine_get_greeting</span><span class="p">(</span><span class="n">original</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">get_greeting</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">original</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">get_greeting</span>
</pre></div>
</div>
</td><td width="50%"><p class="graphviz">
<img src="_images/graphviz-fcdeb7c622e74468d93c7bced9c1902dae8abe5a.png" alt="digraph foo {
     graph [bgcolor=&quot;#F8F8F8&quot;];
     node [fontsize=10];
     edge [arrowhead=none];
     n1[label=&quot;get_greeting:function2&quot;,style=filled,fillcolor=yellow];

     &quot;loud:module&quot; -&gt; n1;
}" />
</p>
</td></tr></table><p>Again, we create a superimposable FST, that specifies a refinement for <tt class="docutils literal"><span class="pre">get_greeting</span></tt>.
But here, we make use of the original implementation (and simply make it louder by uppercasing the greeting).
A launcher for a loud greeter would be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#launch_loud.py</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">base</span>
    <span class="kn">import</span> <span class="nn">loud</span>
    <span class="n">featuremonkey</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">loud</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
    <span class="n">base</span><span class="o">.</span><span class="n">greet</span><span class="p">()</span>
</pre></div>
</div>
<p>And a loud monkey greeter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c">#launch_loud_monkey.py</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">base</span>
    <span class="kn">import</span> <span class="nn">monkey</span>
    <span class="kn">import</span> <span class="nn">loud</span>
    <span class="n">featuremonkey</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">loud</span><span class="p">,</span> <span class="n">monkey</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>
    <span class="n">base</span><span class="o">.</span><span class="n">greet</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="composition-order">
<h2>Composition order<a class="headerlink" href="#composition-order" title="Permalink to this headline">¶</a></h2>
<p>Please note, that the order the features are passed to compose is relevant:
The base feature must always be the last argument. Superimposable FSTs are superimposed step by step <strong>from right to left</strong> (the superimposition operation is defined as such in literature).</p>
<p>Here, this means that <tt class="docutils literal"><span class="pre">monkey</span></tt> is first superimposed on <tt class="docutils literal"><span class="pre">base</span></tt>. Then, <tt class="docutils literal"><span class="pre">loud</span></tt> is superimposed on the result.
Therefore, when running the launcher, we get the monkey greeting in uppercase.</p>
<p>The composed FST looks rougly like the following. The feature that introduced a respective node is given in square brackets.</p>
<p class="graphviz">
<img src="_images/graphviz-c00fb10c5ad2b0b06f9dfec199634ab08d1b68ad.png" alt="digraph foo {
    graph [bgcolor=&quot;#F8F8F8&quot;];
    node [fontsize=10];
    edge [arrowhead=none];

    &quot;base:module&quot; -&gt; &quot;get_greeting:function\n[loud]&quot;;
    &quot;base:module&quot; -&gt; &quot;greet:function\n[base]&quot;;
    &quot;get_greeting:function\n[loud]&quot; -&gt; &quot;get_greeting:function\n[monkey]&quot; [style=dotted, arrowhead=empty, label=original, fontsize=8];
    &quot;get_greeting:function\n[monkey]&quot; -&gt; &quot;get_greeting:function\n[base]&quot; [style=dotted, arrowhead=empty, label=original, fontsize=8];

}" />
</p>
<p>If we would change the composition order to
<tt class="docutils literal"><span class="pre">(monkey,</span> <span class="pre">loud,</span> <span class="pre">base)</span></tt> running it would simply yield the monkey greeting (as the implementation of <tt class="docutils literal"><span class="pre">get_greeting</span></tt> in <tt class="docutils literal"><span class="pre">monkey</span></tt> hides the implementation in <tt class="docutils literal"><span class="pre">loud</span></tt> and <tt class="docutils literal"><span class="pre">base</span></tt> by not making a call to <tt class="docutils literal"><span class="pre">original</span></tt>).</p>
</div>
<div class="section" id="specifying-superimposing-fsts">
<h2>Specifying Superimposing FSTs<a class="headerlink" href="#specifying-superimposing-fsts" title="Permalink to this headline">¶</a></h2>
<p>As we have seen before, we can specify superimposing FSTs by creating a python module that is used as root node of the FST. Functions defined in this module starting with <tt class="docutils literal"><span class="pre">refine_</span></tt> are special and are used to create child nodes in the FST.
In fact, featuremonkey also supports a more compact method to declare FSTs:</p>
<table class="fmod"><tr><td width="50%"><div class="highlight-python"><div class="highlight"><pre><span class="c">#launch_uncertain.py</span>
<span class="k">class</span> <span class="nc">Uncertain</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">refine_get_greeting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">original</span><span class="p">):</span>

        <span class="k">def</span> <span class="nf">get_greeting</span><span class="p">():</span>
            <span class="k">return</span> <span class="n">original</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39;?&#39;</span>

        <span class="k">return</span> <span class="n">get_greeting</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">base</span>
    <span class="n">featuremonkey</span><span class="o">.</span><span class="n">compose</span><span class="p">(</span><span class="n">Uncertain</span><span class="p">(),</span> <span class="n">base</span><span class="p">)</span>
    <span class="n">base</span><span class="o">.</span><span class="n">greet</span><span class="p">()</span>
</pre></div>
</div>
</td><td width="50%"><p class="graphviz">
<img src="_images/graphviz-7d640e7529ab97f50a4764772022267dbd4f713c.png" alt="digraph foo {
     graph [bgcolor=&quot;#F8F8F8&quot;];
     node [fontsize=10];
     edge [arrowhead=none];
     n1[label=&quot;get_greeting:function&quot;,style=filled,fillcolor=yellow];
     &quot;uncertain:module&quot; -&gt; n1;
}" />
</p>
</td></tr></table><p>As you can see, we can also specify FSTs using classes instead of modules. Please note that you need to pass an instance to <tt class="docutils literal"><span class="pre">featuremonkey.compose</span></tt>, not the class itself.</p>
<p>Superimposing FSTs can be superimposed on packages, modules, classes and even on individual instances - in the current example we superimposed on a module.</p>
</div>
<div class="section" id="introductions-and-higher-trees">
<h2>Introductions and Higher Trees<a class="headerlink" href="#introductions-and-higher-trees" title="Permalink to this headline">¶</a></h2>
<p>Until now, we have used featuremonkey to refine an existing function in module <tt class="docutils literal"><span class="pre">base</span></tt>.
Other</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">featuremonkey Tutorial</a><ul>
<li><a class="reference internal" href="#example-product-line">Example Product Line</a></li>
<li><a class="reference internal" href="#base-feature-and-fst">Base feature and FST</a></li>
<li><a class="reference internal" href="#superimposing-fsts">Superimposing FSTs</a></li>
<li><a class="reference internal" href="#product-launchers">Product Launchers</a></li>
<li><a class="reference internal" href="#using-original">Using <tt class="docutils literal"><span class="pre">original</span></tt></a></li>
<li><a class="reference internal" href="#composition-order">Composition order</a></li>
<li><a class="reference internal" href="#specifying-superimposing-fsts">Specifying Superimposing FSTs</a></li>
<li><a class="reference internal" href="#introductions-and-higher-trees">Introductions and Higher Trees</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="install.html"
                        title="previous chapter">Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="reference.html"
                        title="next chapter">featuremonkey Reference</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="reference.html" title="featuremonkey Reference"
             >next</a> |</li>
        <li class="right" >
          <a href="install.html" title="Installation"
             >previous</a> |</li>
        <li><a href="index.html">featuremonkey 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
<div class="footer">
     featuremonkey is copyright © 2012, Hendrik Speidel - <a href="http://schnapptack.de/">schnapptack GbR</a>.<br/>
     The featuremonkey logo is copyright © 2012, Christian Hauser - <a href="http://iyomi.de/">IYOMI</a>.<br/>
     Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
</div>

  </body>
</html>