

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Data Model &mdash; HTSQL v2.3.3 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/htsqldoc.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '2.3.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="HTSQL v2.3.3 documentation" href="../index.html" />
    <link rel="up" title="HTSQL Reference" href="index.html" />
    <link rel="next" title="Data Flows" href="flows.html" />
    <link rel="prev" title="HTSQL Grammar" href="syntax.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="flows.html" title="Data Flows"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="syntax.html" title="HTSQL Grammar"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">HTSQL v2.3.3 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">HTSQL Reference</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="data-model">
<h1>Data Model<a class="headerlink" href="#data-model" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#model-and-instances" id="id1">Model and Instances</a></li>
<li><a class="reference internal" href="#model-graph" id="id2">Model Graph</a></li>
<li><a class="reference internal" href="#instances" id="id3">Instances</a></li>
<li><a class="reference internal" href="#arrow-constraints" id="id4">Arrow Constraints</a></li>
<li><a class="reference internal" href="#correspondence-to-the-relational-model" id="id5">Correspondence to the Relational Model</a></li>
</ul>
</div>
<p>HTSQL is not a full-fledged database system.  As opposed to regular data
stores, it does not include a storage layer, but relies on a SQL
database server to physically store and retrieve data.</p>
<p>HTSQL is designed to work on top of existing relational databases and
does not impose any restrictions on how information is modeled and
stored there.  At the same time, HTSQL works best when the data in the
database is highly normalized.</p>
<p>Even though HTSQL wraps a relational database, it does not expose the
relational model directly to the users.  Instead it derives <em>HTSQL data
model</em> from the underlying database and uses this model when presenting
data to the users and interpreting user queries.  HTSQL data model is
very close to traditional <a class="reference external" href="http://en.wikipedia.org/wiki/Network_model">network data model</a> utilized by CODASYL and
various OODBMS and ORM systems.</p>
<p>In the next sections, we describe HTSQL data model and how it is
inferred from the relational model of the underlying database.</p>
<div class="section" id="model-and-instances">
<h2><a class="toc-backref" href="#id1">Model and Instances</a><a class="headerlink" href="#model-and-instances" title="Permalink to this headline">¶</a></h2>
<p>When describing how information is represented by HTSQL, we
differentiate between <em>a database model</em> and <em>a database instance</em>.</p>
<p>A database model specifies the structure of the database: what types of
business entities are represented and how the entities may relate to
each other.  A database instance is the actual data in the database
and must satisfy the constraints imposed by the model.  The difference
between a model and an instance is the difference between the shape
of data and data itself.</p>
<p>Let&#8217;s consider the model of a student enrollment system in a fictional
university.  This model may contain schools, programs administered
by a school, departments associated with a school, and courses offered
by a department.  A concrete instance of this model may contain
a school of <em>Engineering</em> with an associated department of <em>Computer
Science</em>, which offers a <em>Database Theory</em> course, etc.:</p>
<img class="diagram align-center" height="294" src="../_images/model-and-instance.png" width="680" />
</div>
<div class="section" id="model-graph">
<h2><a class="toc-backref" href="#id2">Model Graph</a><a class="headerlink" href="#model-graph" title="Permalink to this headline">¶</a></h2>
<p>HTSQL represents a database model as a directed graph, or a collection
of nodes connected by arrows.</p>
<p>A model graph may contain several types of nodes:</p>
<ul class="simple">
<li>A <em>domain</em> node represents a scalar data type such as boolean,
integer, string, date.</li>
<li>A <em>class</em> node represents a collection of homogeneous business
entities.  For instance, a student enrollment database may contain
classes for school, program, department, and course entities.</li>
<li>Each model graph contains one instance of a <em>unit</em> node.  The unit
serves as an origin node when we construct paths in the model graph.</li>
</ul>
<p>Arrows in the model graph are categorized by the type of nodes they
connect:</p>
<ul class="simple">
<li>There is exactly one arrow connecting the unit node to each class
node.  We call it a <em>class</em> arrow.  It represents the set of all
entities of the target class.</li>
<li>An arrow connecting a class node to a domain node is called an
<em>attribute</em> arrow and represents an entity attribute.</li>
<li>An arrow between two class nodes denotes a relationship between
entities of the respective classes and is called a <em>link</em> arrow.</li>
</ul>
<p>Each arrow has a <em>name</em>.  The arrow name must be unique among all arrows
with the same origin node.</p>
<p>The following diagram shows a fragment of the model graph for the
student enrollment database (most of the domain nodes and attribute
arrows are omitted for clarity).</p>
<img class="diagram align-center" height="296" src="../_images/sample-model.png" width="546" />
<p>A <em>navigation</em> in the model graph is a path, or a sequence of arrows,
where the first arrow starts at the unit node and the target of each
arrow coincides with the origin of the next arrow.  We denote a
navigation using arrow names separated by a period (<tt class="docutils literal"><span class="pre">.</span></tt>).  For
example, in the diagram above, the selected navigation is denoted by
<tt class="docutils literal"><span class="pre">school.department.name</span></tt>.</p>
<p>A navigation expresses a respective HTSQL query:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school.department.name" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school.department.name" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">school</span><span class="p">.</span><span class="nb">department</span><span class="p">.</span><span class="nb">name</span>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
</thead>
<tbody valign="top">
<tr><td class="htsql-text-type">Studio Art</td>
</tr>
<tr><td class="htsql-text-type">Accounting</td>
</tr>
<tr><td class="htsql-text-type">Economics</td>
</tr>
<tr><td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We will routinely use the navigational notation to refer to various
components of the model graph.  Since there is a one-to-one
correspondence between class arrows and class nodes, we can use the
arrow name to refer to the target class; for example, we say &#8220;class
<tt class="docutils literal"><span class="pre">school</span></tt>&#8221; referring to the target of the class arrow called
<tt class="docutils literal"><span class="pre">school</span></tt>.  In the same manner, we will often say &#8220;link
<tt class="docutils literal"><span class="pre">school.department</span></tt>&#8221; or &#8220;attribute <tt class="docutils literal"><span class="pre">department.name</span></tt>&#8221; referring
to the last component of the navigation.</p>
</div>
</div>
<div class="section" id="instances">
<h2><a class="toc-backref" href="#id3">Instances</a><a class="headerlink" href="#instances" title="Permalink to this headline">¶</a></h2>
<p>As we focus from the database model to a specific instance, nodes
are populated with values and entities, and each arrow splits into
connections between individual node elements.</p>
<p>A domain node is populated with all values of the respective type.
Thus, boolean domain acquires two values: <tt class="docutils literal"><span class="pre">true</span></tt> and <tt class="docutils literal"><span class="pre">false</span></tt>,
integer domain is filled with all integer numbers, and so on.</p>
<p>A class node becomes a set of entities of the respective class; e.g.
<tt class="docutils literal"><span class="pre">school</span></tt> class becomes a set of university schools, <tt class="docutils literal"><span class="pre">department</span></tt> a
set of departments, etc.</p>
<p>The unit node contains a single value, which is called a <em>unit</em>
and denoted by <tt class="docutils literal"><span class="pre">&#64;</span></tt>.</p>
<img class="diagram align-center" height="151" src="../_images/sample-instance-1.png" width="522" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In HTSQL, we can only observe entity attributes, but not the entities
themselves.  When we need to refer to a specific entity in writing,
we enclose in brackets the value of an entity attribute which
uniquely identifies the entity.  For example, attribute
<tt class="docutils literal"><span class="pre">school.code</span></tt> uniquely identifies <tt class="docutils literal"><span class="pre">school</span></tt> entities, therefore we
may say that <tt class="docutils literal"><span class="pre">[eng]</span></tt>, <tt class="docutils literal"><span class="pre">[ns]</span></tt>, <tt class="docutils literal"><span class="pre">[sc]</span></tt> are respectively entities
representing schools of <em>Engineering</em>, of <em>Natural Sciences</em>, and
of <em>Continuing Studies</em>.</p>
</div>
<p>An arrow between two nodes splits into a binary relation between
elements of these nodes:</p>
<ul class="simple">
<li>An arrow from the unit node to a class node connects the unit
to every entity in the target class.</li>
<li>An arrow between two class nodes connects each entity of the
origin class to all related entities in the target class.</li>
<li>An arrow from a class node to a domain node connects each
entity with the respective attribute value.</li>
</ul>
<p>The following diagram visualizes the navigation
<tt class="docutils literal"><span class="pre">school.department.name</span></tt> on a specific database instance.</p>
<img class="diagram align-center" height="400" src="../_images/sample-instance-2.png" width="530" />
</div>
<div class="section" id="arrow-constraints">
<h2><a class="toc-backref" href="#id4">Arrow Constraints</a><a class="headerlink" href="#arrow-constraints" title="Permalink to this headline">¶</a></h2>
<p>Arrows may enforce constraints on connections between elements.  We
recognize the following constraints: singularity, totality and
uniqueness.</p>
<p>Note that arrow constraints are defined on the database model and
applied to all instances of the model.</p>
<div class="section" id="singular-and-plural-arrows">
<h3>Singular and Plural Arrows<a class="headerlink" href="#singular-and-plural-arrows" title="Permalink to this headline">¶</a></h3>
<p>An arrow is called <em>singular</em> if any element of the origin node is
connected to no more than one element of the target node.  Otherwise,
the arrow is called <em>plural</em>.</p>
<ul class="simple">
<li>All attribute arrows are singular.</li>
<li>All class arrows are plural.</li>
<li>A link arrow, which connects two class nodes, may be singular or
plural.  For example, link <tt class="docutils literal"><span class="pre">department.school</span></tt> is singular because
each department may be associated with just one school, but the
<em>reverse</em> link <tt class="docutils literal"><span class="pre">school.department</span></tt> is plural since a school may
include more than one department.</li>
</ul>
<p>The following diagram visualises a singular link <tt class="docutils literal"><span class="pre">program.school</span></tt>
and a plural link <tt class="docutils literal"><span class="pre">school.department</span></tt>.</p>
<img class="diagram align-center" height="181" src="../_images/singular-links.png" width="670" />
</div>
<div class="section" id="total-and-partial-arrows">
<h3>Total and Partial Arrows<a class="headerlink" href="#total-and-partial-arrows" title="Permalink to this headline">¶</a></h3>
<p>An arrow is called <em>total</em> if each element of the origin node is
connected to at least one element of the target node.  Otherwise, the
arrow is called <em>partial</em>.</p>
<ul class="simple">
<li>A class arrow is always partial.  It represents the fact that in some
database instances the class may contain no entities.</li>
<li>Links and attributes could be total or partial.  For example,
attribute <tt class="docutils literal"><span class="pre">school.name</span></tt> is total since each school must have a name,
but attribute <tt class="docutils literal"><span class="pre">school.campus</span></tt> is partial since some schools do not
belong to any campus.</li>
</ul>
<p>The following diagram shows a total link <tt class="docutils literal"><span class="pre">program.school</span></tt> and a
partial attribute <tt class="docutils literal"><span class="pre">school.campus</span></tt>.</p>
<img class="diagram align-center" height="179" src="../_images/total-links.png" width="670" />
</div>
<div class="section" id="unique-and-non-unique-arrows">
<h3>Unique and Non-unique Arrows<a class="headerlink" href="#unique-and-non-unique-arrows" title="Permalink to this headline">¶</a></h3>
<p>An arrow is called <em>unique</em> if any element of the target node is
connected to no more than one element of the origin node.  Otherwise,
the arrow is <em>non-unique</em>.</p>
<ul class="simple">
<li>A class arrow is non-unique since the class may contain more than one
entity.</li>
<li>Links and attributes could be unique and non-unique.  For example,
attribute <tt class="docutils literal"><span class="pre">school.name</span></tt> is unique since we require that each school
has a distinct name, but attribute <tt class="docutils literal"><span class="pre">school.campus</span></tt> is non-unique
since several schools may share the same campus.</li>
</ul>
<p>The following diagram shows a unique attribute <tt class="docutils literal"><span class="pre">department.name</span></tt> and a
non-unique link <tt class="docutils literal"><span class="pre">department.school</span></tt>.</p>
<img class="diagram align-center" height="180" src="../_images/unique-links.png" width="724" />
</div>
</div>
<div class="section" id="correspondence-to-the-relational-model">
<h2><a class="toc-backref" href="#id5">Correspondence to the Relational Model</a><a class="headerlink" href="#correspondence-to-the-relational-model" title="Permalink to this headline">¶</a></h2>
<p>In this section, we explain how underlying relation database model
is translated to HTSQL data model.</p>
<p>For the most part, translation of relational structure to HTSQL model is
straightforward.  SQL data types become domain nodes, SQL tables become
class nodes, table columns become attributes.  Links between classes are
inferred from FOREIGN KEY constraints.</p>
<p>HTSQL allows the administrator to restrict access to specific tables and
columns, configure additional database constraints, and rename links.
Here we describe how HTSQL creates a database model from the given SQL
database in the absence of any configuration.</p>
<p>A name in HTSQL is a sequence of letters, digits and <tt class="docutils literal"><span class="pre">_</span></tt> characters
which does not start with a digit.  When an HTSQL name is generated from
a SQL name which contains non-alphanumeric characters, those are
replaced with an underscore (<tt class="docutils literal"><span class="pre">_</span></tt>).</p>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<p>Each SQL table induces a class node, which, in general, borrows its
name from the table.</p>
<p>Some SQL database servers support a notion of <em>schemas</em>, or collections
of tables.  Tables in the same schema must have unique names, but two or
more tables in different schemas may share the same name, in which case
HTSQL cannot use the name directly.  This naming conflict is resolved as
follows:</p>
<ul class="simple">
<li>If one of the schemas is marked as &#8220;default&#8221; for the purposes of name
resolution, the name of the respective table is borrowed unadorned.</li>
<li>For the remaining tables, the assigned HTSQL name has the form
<tt class="docutils literal"><span class="pre">&lt;schema&gt;_&lt;name&gt;</span></tt>.</li>
</ul>
</div>
<div class="section" id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this headline">¶</a></h3>
<p>Each table column induces a class attribute with the same name.</p>
<p>When the column has a <tt class="docutils literal"><span class="pre">FOREIGN</span> <span class="pre">KEY</span></tt> constraint, the column name is
also used to refer to the respective link.  In this case, whether the
name refers to an attribute or a link is determined from context;
compare</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.school_code" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.school_code" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nb">school_code</span>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<thead valign="bottom">
</thead>
<tbody valign="top">
<tr><td class="htsql-text-type">bus</td>
</tr>
<tr><td class="htsql-text-type">la</td>
</tr>
<tr><td class="htsql-text-type">ns</td>
</tr>
<tr><td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>and</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.school_code.*" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.school_code.*" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nb">school_code</span><span class="p">.</span><span class="o">*</span>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="74%" />
<col width="15%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">code</th>
<th class="head">name</th>
<th class="head">campus</th>
</tr>
</thead>
<tbody valign="top">
<tr><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">south</td>
</tr>
<tr><td class="htsql-text-type">la</td>
<td class="htsql-text-type">School of Arts and Humanities</td>
<td class="htsql-text-type">old</td>
</tr>
<tr><td class="htsql-text-type">ns</td>
<td class="htsql-text-type">School of Natural Sciences</td>
<td class="htsql-text-type">old</td>
</tr>
<tr><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section" id="links">
<h3>Links<a class="headerlink" href="#links" title="Permalink to this headline">¶</a></h3>
<p>Each <tt class="docutils literal"><span class="pre">FOREIGN</span> <span class="pre">KEY</span></tt> constraint generates two links between respective
class nodes, one in the direction of the constraint, called <em>direct</em>,
and the other in the opposite direction, called <em>reverse</em>.</p>
<p>The names of the links are synthesized from the names of the tables and
names of the columns which form the constraint.  If the name of the
referring column ends with the name of the referred column (e.g.
<tt class="docutils literal"><span class="pre">department.school_code</span></tt> refers to <tt class="docutils literal"><span class="pre">school.code</span></tt>), we call the
beginning of the referring column a <em>prefix</em> (in this case, <tt class="docutils literal"><span class="pre">school</span></tt>).
The prefix is stripped from any underscore characters.</p>
<p>The link names are generated according to the following rules.  The
adopted name is the first one which doesn&#8217;t conflict with other arrows
with the same origin class.</p>
<ol class="arabic simple">
<li>When the link is direct and the prefix exists, use the prefix.</li>
<li>Use the name of the target table.  When there are more than one
link to the same target, prefer the one for which the referring
column is a primary key.</li>
<li>If the link is reverse and the prefix exists, use the name of the
form <tt class="docutils literal"><span class="pre">&lt;target&gt;_via_&lt;prefix&gt;</span></tt>.</li>
<li>If the link is reverse, use the name of the form
<tt class="docutils literal"><span class="pre">&lt;target&gt;_via_&lt;column&gt;</span></tt>.</li>
</ol>
</div>
<div class="section" id="constraints">
<h3>Constraints<a class="headerlink" href="#constraints" title="Permalink to this headline">¶</a></h3>
<p>Column constraints are trivially translated to properties of the
respective attribute arrows.</p>
<ul class="simple">
<li>A <tt class="docutils literal"><span class="pre">NOT</span> <span class="pre">NULL</span></tt> constraint on a column means, in HTSQL terms, that the
respective attribute is total.</li>
<li>A <tt class="docutils literal"><span class="pre">UNIQUE</span></tt> constraint indicates that the attribute is unique.</li>
<li>A <tt class="docutils literal"><span class="pre">PRIMARY</span> <span class="pre">KEY</span></tt> constraint indicates that the attribute is both
total and unique.  The columns that form a primary key are also used
for default ordering on the class.</li>
<li>A direct link induced by a <tt class="docutils literal"><span class="pre">FOREIGN</span> <span class="pre">KEY</span></tt> constraint is always
singular.  The reverse link is plural in general, but could be
singular when the key column is <tt class="docutils literal"><span class="pre">UNIQUE</span></tt>.</li>
</ul>
</div>
<div class="section" id="an-example">
<h3>An Example<a class="headerlink" href="#an-example" title="Permalink to this headline">¶</a></h3>
<p>Consider, for example, the following fragment of an SQL schema:</p>
<div class="highlight-sql"><div class="highlight"><pre><span class="k">CREATE</span> <span class="k">SCHEMA</span> <span class="n">ad</span><span class="p">;</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">ad</span><span class="p">.</span><span class="n">school</span> <span class="p">(</span>
    <span class="n">code</span>                <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">name</span>                <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">campus</span>              <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">5</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">school_pk</span>
      <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">code</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">school_name_uk</span>
      <span class="k">UNIQUE</span> <span class="p">(</span><span class="n">name</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">school_campus_ck</span>
      <span class="k">CHECK</span> <span class="p">(</span><span class="n">campus</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">&#39;old&#39;</span><span class="p">,</span> <span class="s1">&#39;north&#39;</span><span class="p">,</span> <span class="s1">&#39;south&#39;</span><span class="p">))</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">ad</span><span class="p">.</span><span class="n">department</span> <span class="p">(</span>
    <span class="n">code</span>                <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">name</span>                <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">school_code</span>         <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">department_pk</span>
      <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">code</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">department_name_uk</span>
      <span class="k">UNIQUE</span> <span class="p">(</span><span class="n">name</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">department_school_fk</span>
      <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">school_code</span><span class="p">)</span>
      <span class="k">REFERENCES</span> <span class="n">ad</span><span class="p">.</span><span class="n">school</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">ad</span><span class="p">.</span><span class="n">program</span> <span class="p">(</span>
    <span class="n">school_code</span>         <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">code</span>                <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">title</span>               <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">degree</span>              <span class="nb">CHAR</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span>
    <span class="n">part_of_code</span>        <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">program_pk</span>
      <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">school_code</span><span class="p">,</span> <span class="n">code</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">program_title_uk</span>
      <span class="k">UNIQUE</span> <span class="p">(</span><span class="n">title</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">program_degree_ck</span>
      <span class="k">CHECK</span> <span class="p">(</span><span class="n">degree</span> <span class="k">IN</span> <span class="p">(</span><span class="s1">&#39;bs&#39;</span><span class="p">,</span> <span class="s1">&#39;pb&#39;</span><span class="p">,</span> <span class="s1">&#39;ma&#39;</span><span class="p">,</span> <span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="s1">&#39;ct&#39;</span><span class="p">,</span> <span class="s1">&#39;ms&#39;</span><span class="p">,</span> <span class="s1">&#39;ph&#39;</span><span class="p">)),</span>
    <span class="k">CONSTRAINT</span> <span class="n">program_school_fk</span>
      <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">school_code</span><span class="p">)</span>
      <span class="k">REFERENCES</span> <span class="n">ad</span><span class="p">.</span><span class="n">school</span><span class="p">(</span><span class="n">code</span><span class="p">),</span>
   <span class="k">CONSTRAINT</span> <span class="n">program_part_of_fk</span>
      <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">school_code</span><span class="p">,</span> <span class="n">part_of_code</span><span class="p">)</span>
      <span class="k">REFERENCES</span> <span class="n">ad</span><span class="p">.</span><span class="n">program</span><span class="p">(</span><span class="n">school_code</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
<span class="p">);</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">ad</span><span class="p">.</span><span class="n">course</span> <span class="p">(</span>
    <span class="n">department_code</span>     <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="k">no</span>                  <span class="nb">INTEGER</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">title</span>               <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">64</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">credits</span>             <span class="nb">INTEGER</span><span class="p">,</span>
    <span class="n">description</span>         <span class="nb">TEXT</span><span class="p">,</span>
    <span class="k">CONSTRAINT</span> <span class="n">course_pk</span>
      <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">department_code</span><span class="p">,</span> <span class="k">no</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">course_title_uk</span>
      <span class="k">UNIQUE</span> <span class="p">(</span><span class="n">title</span><span class="p">),</span>
    <span class="k">CONSTRAINT</span> <span class="n">course_dept_fk</span>
      <span class="k">FOREIGN</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">department_code</span><span class="p">)</span>
      <span class="k">REFERENCES</span> <span class="n">ad</span><span class="p">.</span><span class="n">department</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>In this schema, four tables <tt class="docutils literal"><span class="pre">ad.school</span></tt>, <tt class="docutils literal"><span class="pre">ad.department</span></tt>,
<tt class="docutils literal"><span class="pre">ad.program</span></tt>, <tt class="docutils literal"><span class="pre">ad.course</span></tt> generate four classes:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">school</span>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="69%" />
<col width="19%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">code</th>
<th class="head">name</th>
<th class="head">campus</th>
</tr>
</thead>
<tbody valign="top">
<tr><td class="htsql-text-type">art</td>
<td class="htsql-text-type">School of Art &amp; Design</td>
<td class="htsql-text-type">old</td>
</tr>
<tr><td class="htsql-text-type">bus</td>
<td class="htsql-text-type">School of Business</td>
<td class="htsql-text-type">south</td>
</tr>
<tr><td class="htsql-text-type">edu</td>
<td class="htsql-text-type">College of Education</td>
<td class="htsql-text-type">old</td>
</tr>
<tr><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">department</span>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="39%" />
<col width="39%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">code</th>
<th class="head">name</th>
<th class="head">school_code</th>
</tr>
</thead>
<tbody valign="top">
<tr><td class="htsql-text-type">acc</td>
<td class="htsql-text-type">Accounting</td>
<td class="htsql-text-type">bus</td>
</tr>
<tr><td class="htsql-text-type">arthis</td>
<td class="htsql-text-type">Art History</td>
<td class="htsql-text-type">la</td>
</tr>
<tr><td class="htsql-text-type">astro</td>
<td class="htsql-text-type">Astronomy</td>
<td class="htsql-text-type">ns</td>
</tr>
<tr><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">program</span>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="10%" />
<col width="48%" />
<col width="9%" />
<col width="17%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">school_code</th>
<th class="head">code</th>
<th class="head">title</th>
<th class="head">degree</th>
<th class="head">part_of_code</th>
</tr>
</thead>
<tbody valign="top">
<tr><td class="htsql-text-type">art</td>
<td class="htsql-text-type">gart</td>
<td class="htsql-text-type">Post Baccalaureate in Art History</td>
<td class="htsql-text-type">pb</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr><td class="htsql-text-type">art</td>
<td class="htsql-text-type">uhist</td>
<td class="htsql-text-type">Bachelor of Arts in Art History</td>
<td class="htsql-text-type">ba</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr><td class="htsql-text-type">art</td>
<td class="htsql-text-type">ustudio</td>
<td class="htsql-text-type">Bachelor of Arts in Studio Art</td>
<td class="htsql-text-type">ba</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">course</span>
</a></pre></div></div>
</div>
<div class="htsql-output container">
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="1%" />
<col width="11%" />
<col width="3%" />
<col width="80%" />
</colgroup>
<thead valign="bottom">
<tr><th class="head">department_code</th>
<th class="head">no</th>
<th class="head">title</th>
<th class="head">credits</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">100</td>
<td class="htsql-text-type">Practical Bookkeeping</td>
<td class="htsql-integer-type">2</td>
<td class="htsql-text-type htsql-null-val"></td>
</tr>
<tr><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">200</td>
<td class="htsql-text-type">Introduction to Accounting</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-text-type">The initial course in the theory and practice of financial accounting. Topics emphasized include the preparation, reporting, and analysis of financial data.</td>
</tr>
<tr><td class="htsql-text-type">acc</td>
<td class="htsql-integer-type">234</td>
<td class="htsql-text-type">Accounting Information Systems</td>
<td class="htsql-integer-type">3</td>
<td class="htsql-text-type">This course bridges the gap between two disciplines critical to business operations. This course of study teaches students to design and deploy information technology to improve the accounting systems of an organization.</td>
</tr>
<tr><td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
<td class="htsql-integer-type htsql-cut"></td>
<td class="htsql-text-type htsql-cut"></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Foreign key constraints <tt class="docutils literal"><span class="pre">department_school_fk</span></tt>, <tt class="docutils literal"><span class="pre">program_school_fk</span></tt>,
<tt class="docutils literal"><span class="pre">course_dept_fk</span></tt> generate three direct and three reverse links:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.school" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.school" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nb">school</span>
</a></pre></div></div>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school.department" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school.department" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">school</span><span class="p">.</span><span class="nb">department</span>
</a></pre></div></div>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program.school" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program.school" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">program</span><span class="p">.</span><span class="nb">school</span>
</a></pre></div></div>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/school.program" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/school.program" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">school</span><span class="p">.</span><span class="nb">program</span>
</a></pre></div></div>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/course.department" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/course.department" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">course</span><span class="p">.</span><span class="nb">department</span>
</a></pre></div></div>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/department.course" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/department.course" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">department</span><span class="p">.</span><span class="nb">course</span>
</a></pre></div></div>
</div>
</div>
<p>A foreign key <tt class="docutils literal"><span class="pre">program_part_of_fk</span></tt> induces two self-referential links
on <tt class="docutils literal"><span class="pre">program</span></tt>:</p>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program.part_of" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program.part_of" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">program</span><span class="p">.</span><span class="nb">part_of</span>
</a></pre></div></div>
</div>
</div>
<div class="htsql-io container">
<div class="htsql-input container">
<div class="highlight-htsql"><div class="highlight"><pre><a href="http://demo.htsql.org/program.program_via_part_of" target="_new" class="htsql-arrow-link">&#x25E5;</a><a href="http://demo.htsql.org/program.program_via_part_of" target="_new" class="htsql-link"><span class="o">/</span><span class="nb">program</span><span class="p">.</span><span class="nb">program_via_part_of</span>
</a></pre></div></div>
</div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Data Model</a><ul>
<li><a class="reference internal" href="#model-and-instances">Model and Instances</a></li>
<li><a class="reference internal" href="#model-graph">Model Graph</a></li>
<li><a class="reference internal" href="#instances">Instances</a></li>
<li><a class="reference internal" href="#arrow-constraints">Arrow Constraints</a></li>
<li><a class="reference internal" href="#correspondence-to-the-relational-model">Correspondence to the Relational Model</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="syntax.html"
                        title="previous chapter">HTSQL Grammar</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="flows.html"
                        title="next chapter">Data Flows</a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="flows.html" title="Data Flows"
             >next</a> |</li>
        <li class="right" >
          <a href="syntax.html" title="HTSQL Grammar"
             >previous</a> |</li>
        <li><a href="../index.html">HTSQL v2.3.3 documentation</a> &raquo;</li>
          <li><a href="index.html" >HTSQL Reference</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2006-2013, Prometheus Reserch, LLC; written by Clark C. Evans and Kirill Simonov.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.8.
    </div>
  </body>
</html>