

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mapping Fields &mdash; python-docar 0.5 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="python-docar 0.5 documentation" href="index.html" />
    <link rel="next" title="Backends" href="backends.html" />
    <link rel="prev" title="Fields" href="fields.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="backends.html" title="Backends"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="fields.html" title="Fields"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">python-docar 0.5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="mapping-fields">
<h1>Mapping Fields<a class="headerlink" href="#mapping-fields" title="Permalink to this headline">¶</a></h1>
<div class="section" id="map-field-field">
<h2><tt class="docutils literal"><span class="pre">map_FIELD_field</span></tt><a class="headerlink" href="#map-field-field" title="Permalink to this headline">¶</a></h2>
<p>You can map a field name between the document and the underlying resource by
implementing a <tt class="xref py py-meth docutils literal"><span class="pre">map_FIELD_field()</span></tt> method where <tt class="docutils literal"><span class="pre">FIELD</span></tt> is the name of
the document field. The method returns a string with the actual name of the
resource field.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># We define a simple django model</span>
<span class="k">class</span> <span class="nc">ArticleModel</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">long_title</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

<span class="c"># We define a document where we want to use name as a field name instead of</span>
<span class="c"># long_title</span>
<span class="k">class</span> <span class="nc">Article</span><span class="p">(</span><span class="n">Document</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">NumberField</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringField</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">backend_type</span> <span class="o">=</span> <span class="s">&#39;django&#39;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">ArticleModel</span>

    <span class="n">map_name_field</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s">&quot;long_title&quot;</span>
</pre></div>
</div>
<p>In the above example the document defines a field <tt class="docutils literal"><span class="pre">name</span></tt>. For any operation
with the underlying resource, it will map <tt class="docutils literal"><span class="pre">name</span></tt> to <tt class="docutils literal"><span class="pre">long_title</span></tt>.</p>
</div>
<div class="section" id="fetch-field-field">
<h2><tt class="docutils literal"><span class="pre">fetch_FIELD_field</span></tt><a class="headerlink" href="#fetch-field-field" title="Permalink to this headline">¶</a></h2>
<p>You can map values that are fetched from a backend and set a different value on
the document. Specify a <tt class="docutils literal"><span class="pre">fetch_FIELD_field</span></tt> method on the document, and it
will be called whenever a representation gets fetched.</p>
<p>The method takes only one argument, which is the value originaly fetched from
the backend.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Article</span><span class="p">(</span><span class="n">Document</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">NumberField</span><span class="p">()</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">StringField</span><span class="p">()</span>

    <span class="k">class</span> <span class="nc">Meta</span><span class="p">:</span>
        <span class="n">backend_type</span> <span class="o">=</span> <span class="s">&#39;http&#39;</span>

    <span class="n">fetch_name_field</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s">&quot;some string&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s">&quot;UNKNOWN&quot;</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">art</span> <span class="o">=</span> <span class="n">Article</span><span class="p">({</span><span class="s">&#39;id&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c"># this fetches a resource that looks like that:</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c"># {&quot;id&quot;: 1, &quot;name&quot;: &quot;something&quot;}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">art</span><span class="o">.</span><span class="n">fetch</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">art</span><span class="o">.</span><span class="n">name</span>
<span class="n">UNKNOWN</span>
</pre></div>
</div>
</div>
<div class="section" id="save-field-field">
<h2><tt class="docutils literal"><span class="pre">save_FIELD_field</span></tt><a class="headerlink" href="#save-field-field" title="Permalink to this headline">¶</a></h2>
<p>You can as well map field values before sending the document to the backend
for saving the resource. It works the same as for fetching field described
above, you only specify a <tt class="docutils literal"><span class="pre">save_FIELD_field</span></tt> method on the document.</p>
</div>
<div class="section" id="render-field-field">
<h2><tt class="docutils literal"><span class="pre">render_FIELD_field</span></tt><a class="headerlink" href="#render-field-field" title="Permalink to this headline">¶</a></h2>
<p>To change the rendering of the field use a <tt class="docutils literal"><span class="pre">render_FIELD_field</span></tt> method. Use
it the same as fetch or save mapping method described above.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Mapping Fields</a><ul>
<li><a class="reference internal" href="#map-field-field"><tt class="docutils literal"><span class="pre">map_FIELD_field</span></tt></a></li>
<li><a class="reference internal" href="#fetch-field-field"><tt class="docutils literal"><span class="pre">fetch_FIELD_field</span></tt></a></li>
<li><a class="reference internal" href="#save-field-field"><tt class="docutils literal"><span class="pre">save_FIELD_field</span></tt></a></li>
<li><a class="reference internal" href="#render-field-field"><tt class="docutils literal"><span class="pre">render_FIELD_field</span></tt></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="fields.html"
                        title="previous chapter">Fields</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="backends.html"
                        title="next chapter">Backends</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/mapping_fields.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="backends.html" title="Backends"
             >next</a> |</li>
        <li class="right" >
          <a href="fields.html" title="Fields"
             >previous</a> |</li>
        <li><a href="index.html">python-docar 0.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Christo Buschek.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>